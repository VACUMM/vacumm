
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Stratification : comparaisons en eaux profondes &#8212; VACUMM v3.6.2 documentation</title>
    <link rel="stylesheet" href="_static/vacumm.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
<!--<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="static/logo_vacumm.png" border="0" alt="vacumm"/></a>
</div>-->

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">Home</a>|&nbsp;</li>
        <li><a href="contents.html">Docs</a>|&nbsp;</li>
        <li><a href="user.faq.html">FAQ</a>|&nbsp;</li>
<!--         <li><a href="search.html">chercher</a>|&nbsp;</li> -->
        <li><a href="gallery.html">Gallery</a>|&nbsp;</li>
        <li><a href="https://forge.ifremer.fr/projects/vacumm">Forge</a>&nbsp; &raquo;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo_vacumm.png" alt="Logo"/>
            </a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/user.desc.proc.stratifdeepwater.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="stratification-comparaisons-en-eaux-profondes">
<span id="user-desc-proc-stratifdeepwater"></span><h1>Stratification : comparaisons en eaux profondes<a class="headerlink" href="#stratification-comparaisons-en-eaux-profondes" title="Permalink to this headline">¶</a></h1>
<p>Le but est ici de comparer les couches mélangées modélisée et observée en eaux profondes.
L’approche est équivalente à celle du calcul de profondeur de la section “<a class="reference internal" href="user.desc.proc.stratifinsitu.html#user-desc-proc-stratifinsitu"><span class="std std-ref">Stratification : comparaisons en eaux peu profondes</span></a>” en eau peu profonde,
mais avec un algorithme différent pour le calcul de profondeur
(cf. “<a class="reference internal" href="user.desc.proc.stratifinsitu.html#user-desc-proc-stratifinsitu-mld"><span class="std std-ref">Calcul de la pronfondeur de couche mélangée</span></a>”).</p>
<p>L’approche la plus pertinente et simple est celle basée sur un différentiel en température ou en densité
entre les eaux de proche surface (par exemple 10m) et celles de la base de la couche mélangée.
On peut pour cela utiliser les critères de <a class="reference internal" href="appendix.biblio.html#deboyermontegutetal2003" id="id1">[deBoyerMontegutetal2003]</a>.</p>
<p>Pour l’implémentation, nous allons raisonner sur la densité.
Nous supposons avoir calculé cette dernière comme en eau peu profonde,
en supposant le dernier niveau le plus proche de la surface.</p>
<p>La première étape consiste à calculer la densité de référence en proche surface :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Profondeur de référence</span>
<span class="n">dep</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>

<span class="c1"># Axe pour interpolation</span>
<span class="kn">from</span> <span class="nn">vacumm.misc.axes</span> <span class="k">import</span> <span class="n">create_dep</span>
<span class="n">depaxis</span> <span class="o">=</span> <span class="n">create_dep</span><span class="p">([</span><span class="n">dep</span><span class="p">])</span>

<span class="c1"># Interpolations</span>
<span class="kn">from</span> <span class="nn">vacumm.misc.grid.regridding</span> <span class="k">import</span> <span class="n">interp1d</span>
<span class="n">dens_obs_ref</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">dens_obs</span><span class="p">,</span> <span class="n">depaxis</span><span class="p">,</span> <span class="n">xmap</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">deps_obs</span><span class="p">)</span>
</pre></div>
</div>
<p>La deuxième étape vise à calculer la profondeur ayant une densité plus importante
que celle de rérence d’une valeur prédéfinie.
Pour cela, on calcul se sert du masque des données situées dans
la couche mélangée (critère en densité), et du masque de celles en dehors (profondes).
Une interpolation linéaire de la prodondeur est alors faite entre
le niveau de fond de la couche mélangée (densité max et profondeur négative min)
et le niveau supérieur des eaux profondes (densité min et profondeur négative max) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Valeur du différentiel de densité (cf. de Boyer Montégut et all, 2003)</span>
<span class="n">delta_dens</span> <span class="o">=</span> <span class="mf">0.03</span>

<span class="c1"># Densité cible</span>
<span class="n">dens_obs_target</span> <span class="o">=</span> <span class="n">dens_obs_ref</span><span class="o">+</span><span class="mf">0.03</span>

<span class="c1"># Masques de la couche mélangée et des eaux profondes</span>
<span class="n">dens_obs_target3d</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">dens_obs_target</span><span class="p">,</span> <span class="n">dens_obs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">dens_obs_good</span> <span class="o">=</span> <span class="p">(</span><span class="n">dens_obs</span><span class="o">.</span><span class="n">asma</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">dens_obs_target3d</span><span class="o">.</span><span class="n">asma</span><span class="p">())</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dens_obs_bad</span> <span class="o">=</span> <span class="p">(</span><span class="n">dens_obs</span><span class="o">.</span><span class="n">asma</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">dens_obs_target3d</span><span class="o">.</span><span class="n">asma</span><span class="p">())</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Profondeurs juste au dessus et en dessous de la MLD</span>
<span class="n">deps_obs_above</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">dens_obs_bad</span><span class="p">,</span> <span class="n">deps_obs</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">deps_obs_below</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">dens_obs_good</span><span class="p">,</span> <span class="n">deps_obs</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Masques associés</span>
<span class="kn">from</span> <span class="nn">vacumm.misc</span> <span class="k">import</span> <span class="n">closeto</span>
<span class="n">mask_above</span> <span class="o">=</span> <span class="n">closeto</span><span class="p">(</span><span class="n">deps_obs</span><span class="p">,</span> <span class="n">MV2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">deps_obs_above</span><span class="p">,</span> <span class="n">deps_obs</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">mask_below</span> <span class="o">=</span> <span class="n">closeto</span><span class="p">(</span><span class="n">deps_obs</span><span class="p">,</span> <span class="n">MV2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">deps_obs_below</span><span class="p">,</span> <span class="n">deps_obs</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>


<span class="c1"># Densités juste au dessus et en dessous de la MLD</span>
<span class="n">dens_obs_above</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">dens_obs</span><span class="p">,</span> <span class="n">mask_above</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dens_obs_below</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">dens_obs</span><span class="p">,</span> <span class="n">mask_below</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Interpolation</span>
<span class="n">dens_obs_delta</span> <span class="o">=</span> <span class="n">dens_obs_above</span><span class="o">-</span><span class="n">dens_obs_below</span>
<span class="n">deps_obs_mld</span> <span class="o">=</span> <span class="p">(</span><span class="n">dens_obs_target</span><span class="o">-</span><span class="n">dens_obs_above</span><span class="p">)</span><span class="o">*</span><span class="n">deps_obs_above</span>
<span class="n">deps_obs_mld</span> <span class="o">+=</span> <span class="p">(</span><span class="n">dens_obs_below</span><span class="o">-</span><span class="n">dens_obs_target</span><span class="p">)</span><span class="o">*</span><span class="n">deps_obs_below</span>
<span class="n">deps_obs_mld</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dens_obs_delta</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">MV2</span><span class="o">.</span><span class="n">masked</span><span class="p">,</span> <span class="n">deps_obs_mld</span><span class="o">/</span><span class="n">dens_obs_delta</span><span class="p">)</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">Home</a>|&nbsp;</li>
        <li><a href="contents.html">Docs</a>|&nbsp;</li>
        <li><a href="user.faq.html">FAQ</a>|&nbsp;</li>
<!--         <li><a href="search.html">chercher</a>|&nbsp;</li> -->
        <li><a href="gallery.html">Gallery</a>|&nbsp;</li>
        <li><a href="https://forge.ifremer.fr/projects/vacumm">Forge</a>&nbsp; &raquo;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-2015, Actimar/IFREMER.
      Last updated on 21 Jan 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.
    </div>
  </body>
</html>