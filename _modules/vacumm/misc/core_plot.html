
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>vacumm.misc.core_plot &#8212; VACUMM v3.6.2 documentation</title>
    <link rel="stylesheet" href="../../../_static/vacumm.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
<!--<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../../index.html"><img src="../../../static/logo_vacumm.png" border="0" alt="vacumm"/></a>
</div>-->

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">Home</a>|&nbsp;</li>
        <li><a href="../../../contents.html">Docs</a>|&nbsp;</li>
        <li><a href="../../../user.faq.html">FAQ</a>|&nbsp;</li>
<!--         <li><a href="../../../search.html">chercher</a>|&nbsp;</li> -->
        <li><a href="../../../gallery.html">Gallery</a>|&nbsp;</li>
        <li><a href="https://forge.ifremer.fr/projects/vacumm">Forge</a>&nbsp; &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../vacumm.html" accesskey="U">vacumm</a> &#187;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/logo_vacumm.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for vacumm.misc.core_plot</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf8 -*-</span>
<span class="sd">&quot;&quot;&quot;Classes for all plots&quot;&quot;&quot;</span>
<span class="c1"># Copyright or Â© or Copr. Actimar/IFREMER (2012-2018)</span>
<span class="c1">#</span>
<span class="c1"># This software is a computer program whose purpose is to provide</span>
<span class="c1"># utilities for handling oceanographic and atmospheric data,</span>
<span class="c1"># with the ultimate goal of validating the MARS model from IFREMER.</span>
<span class="c1">#</span>
<span class="c1"># This software is a computer program whose purpose is to [describe</span>
<span class="c1"># functionalities and technical features of your software].</span>
<span class="c1">#</span>
<span class="c1"># This software is governed by the CeCILL license under French law and</span>
<span class="c1"># abiding by the rules of distribution of free software.  You can  use,</span>
<span class="c1"># modify and/ or redistribute the software under the terms of the CeCILL</span>
<span class="c1"># license as circulated by CEA, CNRS and INRIA at the following URL</span>
<span class="c1"># &quot;http://www.cecill.info&quot;.</span>
<span class="c1">#</span>
<span class="c1"># As a counterpart to the access to the source code and  rights to copy,</span>
<span class="c1"># modify and redistribute granted by the license, users are provided only</span>
<span class="c1"># with a limited warranty  and the software&#39;s author,  the holder of the</span>
<span class="c1"># economic rights,  and the successive licensors  have only  limited</span>
<span class="c1"># liability.</span>
<span class="c1">#</span>
<span class="c1"># In this respect, the user&#39;s attention is drawn to the risks associated</span>
<span class="c1"># with loading,  using,  modifying and/or developing or reproducing the</span>
<span class="c1"># software by the user in light of its specific status of free software,</span>
<span class="c1"># that may mean  that it is complicated to manipulate,  and  that  also</span>
<span class="c1"># therefore means  that it is reserved for developers  and  experienced</span>
<span class="c1"># professionals having in-depth computer knowledge. Users are therefore</span>
<span class="c1"># encouraged to load and test the software&#39;s suitability as regards their</span>
<span class="c1"># requirements in conditions enabling the security of their systems and/or</span>
<span class="c1"># data to be ensured and,  more generally, to use and operate it in the</span>
<span class="c1"># same conditions as regards security.</span>
<span class="c1">#</span>
<span class="c1"># The fact that you are presently reading this means that you have had</span>
<span class="c1"># knowledge of the CeCILL license and that you accept its terms.</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="k">import</span> <span class="n">isNumberType</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="k">import</span> <span class="n">warn</span>

<span class="kn">import</span> <span class="nn">matplotlib.dates</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">P</span>
<span class="kn">import</span> <span class="nn">matplotlib.transforms</span> <span class="k">as</span> <span class="nn">mtransforms</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">N</span><span class="o">,</span> <span class="nn">MV2</span><span class="o">,</span> <span class="nn">cdms2</span>
<span class="kn">from</span> <span class="nn">matplotlib.artist</span> <span class="k">import</span> <span class="n">Artist</span>
<span class="kn">from</span> <span class="nn">matplotlib.axes</span> <span class="k">import</span> <span class="n">Subplot</span><span class="p">,</span> <span class="n">Axes</span>
<span class="kn">from</span> <span class="nn">matplotlib.axis</span> <span class="k">import</span> <span class="n">YAxis</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="k">import</span> <span class="n">Colormap</span><span class="p">,</span> <span class="n">Normalize</span>
<span class="kn">from</span> <span class="nn">matplotlib.dates</span> <span class="k">import</span> <span class="p">(</span><span class="n">DateFormatter</span><span class="p">,</span> <span class="n">MonthLocator</span><span class="p">,</span> <span class="n">WeekdayLocator</span><span class="p">,</span>
    <span class="n">YearLocator</span><span class="p">,</span><span class="n">DayLocator</span><span class="p">,</span> <span class="n">HourLocator</span><span class="p">,</span> <span class="n">MinuteLocator</span><span class="p">,</span> <span class="n">SecondLocator</span><span class="p">,</span>
    <span class="n">MONDAY</span><span class="p">,</span> <span class="n">WEEKLY</span><span class="p">,</span> <span class="n">YEARLY</span><span class="p">,</span> <span class="n">MONTHLY</span><span class="p">,</span>
    <span class="n">AutoDateLocator</span><span class="p">,</span> <span class="n">AutoDateFormatter</span><span class="p">,</span> <span class="n">MO</span><span class="p">,</span> <span class="n">DAILY</span><span class="p">,</span> <span class="n">HOURLY</span><span class="p">,</span> <span class="n">num2date</span><span class="p">,</span>
    <span class="n">MINUTELY</span><span class="p">,</span> <span class="n">SECONDLY</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="k">import</span> <span class="n">Figure</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="k">import</span> <span class="n">Patch</span>
<span class="kn">from</span> <span class="nn">matplotlib.path</span> <span class="k">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">matplotlib.patheffects</span> <span class="k">import</span> <span class="n">Normal</span>
<span class="kn">from</span> <span class="nn">matplotlib.text</span> <span class="k">import</span> <span class="n">Text</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="k">import</span> <span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">,</span> <span class="n">Formatter</span><span class="p">,</span> <span class="n">Locator</span><span class="p">,</span>
    <span class="n">NullLocator</span><span class="p">,</span> <span class="n">AutoMinorLocator</span><span class="p">,</span> <span class="n">AutoLocator</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="k">import</span> <span class="n">offset_copy</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="k">import</span> <span class="n">Basemap</span><span class="p">,</span> <span class="n">_setlatlab</span><span class="p">,</span> <span class="n">_setlonlab</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="k">import</span> <span class="n">PolyCollection</span><span class="p">,</span> <span class="n">LineCollection</span>

<span class="kn">from</span> <span class="nn">._ext_plot</span> <span class="k">import</span> <span class="p">(</span><span class="n">DropShadowFilter</span><span class="p">,</span> <span class="n">FilteredArtistList</span><span class="p">,</span> <span class="n">GrowFilter</span><span class="p">,</span>
    <span class="n">LightFilter</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.misc</span> <span class="k">import</span> <span class="p">(</span><span class="n">kwfilter</span><span class="p">,</span> <span class="n">dict_aliases</span><span class="p">,</span> <span class="n">geo_scale</span><span class="p">,</span> <span class="n">lonlab</span><span class="p">,</span> <span class="n">latlab</span><span class="p">,</span> <span class="n">deplab</span><span class="p">,</span> <span class="n">cp_atts</span><span class="p">,</span>
    <span class="n">auto_scale</span><span class="p">,</span> <span class="n">dict_check_defaults</span><span class="p">,</span> <span class="n">basic_auto_scale</span><span class="p">,</span> <span class="n">dict_copy_items</span><span class="p">,</span>
    <span class="n">dict_merge</span><span class="p">,</span> <span class="n">phaselab</span><span class="p">,</span> <span class="n">set_atts</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.atime</span> <span class="k">import</span> <span class="n">mpl</span><span class="p">,</span> <span class="n">strftime</span><span class="p">,</span> <span class="n">is_numtime</span><span class="p">,</span> <span class="n">numtime</span>
<span class="kn">from</span> <span class="nn">.axes</span> <span class="k">import</span> <span class="p">(</span><span class="n">check_axes</span><span class="p">,</span> <span class="n">axis_type</span><span class="p">,</span> <span class="n">set_order</span><span class="p">,</span> <span class="n">merge_orders</span><span class="p">,</span>
    <span class="n">check_order</span><span class="p">,</span> <span class="n">order_match</span><span class="p">,</span> <span class="n">isaxis</span><span class="p">,</span> <span class="n">get_axis_type</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.color</span> <span class="k">import</span> <span class="p">(</span><span class="n">get_cmap</span><span class="p">,</span> <span class="n">RGB</span><span class="p">,</span> <span class="n">land</span><span class="p">,</span>
    <span class="n">RGBA</span><span class="p">,</span> <span class="n">change_luminosity</span><span class="p">,</span> <span class="n">change_saturation</span><span class="p">,</span> <span class="n">pastelise</span><span class="p">,</span>
    <span class="n">CMAP_POSITIVE</span><span class="p">,</span> <span class="n">CMAP_NEGATIVE</span><span class="p">,</span> <span class="n">CMAP_SYMETRIC</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.docstrings</span> <span class="k">import</span> <span class="n">docfiller</span>
<span class="kn">from</span> <span class="nn">.filters</span> <span class="k">import</span> <span class="n">generic2d</span>
<span class="kn">from</span> <span class="nn">.grid</span> <span class="k">import</span> <span class="n">get_axis</span><span class="p">,</span> <span class="n">meshbounds</span><span class="p">,</span> <span class="n">meshgrid</span>
<span class="kn">from</span> <span class="nn">.grid.masking</span> <span class="k">import</span> <span class="n">resol_mask</span>
<span class="kn">from</span> <span class="nn">.grid.regridding</span> <span class="k">import</span> <span class="n">shift1d</span>
<span class="kn">from</span> <span class="nn">.phys.units</span> <span class="k">import</span> <span class="n">deg2m</span><span class="p">,</span> <span class="n">tometric</span><span class="p">,</span> <span class="n">m2deg</span>
<span class="kn">from</span> <span class="nn">.remote</span> <span class="k">import</span> <span class="n">OutputWorkFile</span>
<span class="kn">from</span> <span class="nn">..config</span> <span class="k">import</span> <span class="n">get_config_value</span>
<span class="kn">import</span> <span class="nn">color</span>


<span class="n">MA</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span>



<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PlotError&#39;</span><span class="p">,</span><span class="s1">&#39;Plot&#39;</span><span class="p">,</span> <span class="s1">&#39;Plot1D&#39;</span><span class="p">,</span> <span class="s1">&#39;Curve&#39;</span><span class="p">,</span> <span class="s1">&#39;Bar&#39;</span><span class="p">,</span> <span class="s1">&#39;Stick&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Plot2D&#39;</span><span class="p">,</span> <span class="s1">&#39;Map&#39;</span><span class="p">,</span> <span class="s1">&#39;Hov&#39;</span><span class="p">,</span> <span class="s1">&#39;QuiverKey&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ScalarMappable&#39;</span><span class="p">,</span><span class="s1">&#39;AutoDateFormatter2&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoDateLocator2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AutoDateMinorLocator&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoDualDateFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;DualDateFormatter&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MinuteLabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Section&#39;</span><span class="p">,</span> <span class="s1">&#39;twinxy&#39;</span><span class="p">,</span> <span class="s1">&#39;DepthFormatter&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AutoDegreesMinutesFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoDegreesMinutesLocator&#39;</span><span class="p">]</span>


<span class="c1">#: Aliases for argisimage services hosted by the arcgis server</span>
<span class="n">ARCGISIMAGE_ALIASES</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">esriimagery</span><span class="o">=</span><span class="s2">&quot;ESRI_Imagery_World_2D&quot;</span><span class="p">,</span>
    <span class="n">esristreet</span><span class="o">=</span><span class="s2">&quot;ESRI_StreetMap_World_2D&quot;</span><span class="p">,</span>
    <span class="n">esristreetmap</span><span class="o">=</span><span class="s2">&quot;ESRI_StreetMap_World_2D&quot;</span><span class="p">,</span>
    <span class="n">natgeo</span><span class="o">=</span><span class="s2">&quot;NatGeo_World_Map&quot;</span><span class="p">,</span>
    <span class="n">ngstopo</span><span class="o">=</span><span class="s2">&quot;NGS_Topo_US_2D&quot;</span><span class="p">,</span>
    <span class="n">usatopo</span><span class="o">=</span><span class="s2">&quot;USA_Topo_Maps&quot;</span><span class="p">,</span>
    <span class="n">ocean</span><span class="o">=</span><span class="s2">&quot;Ocean_Basemap&quot;</span><span class="p">,</span>
    <span class="n">topo</span><span class="o">=</span><span class="s2">&quot;World_Topo_Map&quot;</span><span class="p">,</span>
    <span class="n">shaded</span><span class="o">=</span><span class="s2">&quot;World_Shaded_Relief&quot;</span><span class="p">,</span>
    <span class="n">physical</span><span class="o">=</span><span class="s2">&quot;World_Physical_Map&quot;</span><span class="p">,</span>
    <span class="n">imagery</span><span class="o">=</span><span class="s2">&quot;World_Imagery&quot;</span><span class="p">,</span>
    <span class="n">street</span><span class="o">=</span><span class="s2">&quot;World_Street_Map&quot;</span><span class="p">,</span>
    <span class="n">streetmap</span><span class="o">=</span><span class="s2">&quot;World_Street_Map&quot;</span><span class="p">,</span>
    <span class="n">terrain</span><span class="o">=</span><span class="s2">&quot;World_Terrain_Base&quot;</span><span class="p">,</span>
<span class="p">)</span>


<div class="viewcode-block" id="PlotError"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.PlotError">[docs]</a><span class="k">class</span> <span class="nc">PlotError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="Plot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot">[docs]</a><span class="k">class</span> <span class="nc">Plot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for all plots</span>

<span class="sd">    :Generic params:</span>

<span class="sd">        - **load_data**, optional: Load data.</span>
<span class="sd">        - **pre_plot**, optional: Initialize the plot (preprocessing).</span>
<span class="sd">        - **plot**, optional: Plot data.</span>
<span class="sd">        - **post_plot**, optional: Finalize plot.</span>
<span class="sd">        - **Data loading**: See :meth:`load_data`, :meth:`_set_axes_`, :meth:`_check_order_` .</span>
<span class="sd">        - **Plot initialisation**: see  :meth:`pre_plot`.</span>
<span class="sd">        - **Plot**: see :meth:`plot`</span>
<span class="sd">        - **Plot finalization**: see :meth:`post_plot`</span>


<span class="sd">    :Attribute params:</span>


<span class="sd">        - **long_name**, optional: Force the :attr:`~vacumm.misc.core_plot.Plot.long_name`</span>
<span class="sd">          attribute used in :attr:`~vacumm.misc.core_plot.Plot.title`.</span>
<span class="sd">          See also param ``x/ylong_name``.</span>
<span class="sd">        - **x/ylong_name**, optional: Same as :attr:`~vacumm.misc.core_plot.Plot.long_name`</span>
<span class="sd">          but for X and Y axes (:attr:`~vacumm.misc.core_plot.Plot.xlong_name`</span>
<span class="sd">          or :attr:`~vacumm.misc.core_plot.Plot.ylong_name`). It refers only to</span>
<span class="sd">          axes for 2D plots, and potentially to data for 1D plots.</span>
<span class="sd">        - **units**, optional: Force the :attr:`~vacumm.misc.core_plot.Plot.units`</span>
<span class="sd">          attribute used in labels (:attr:`~vacumm.misc.core_plot.Plot.label`,</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.Plot.xlabel` or</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.Plot.ylabel`).</span>
<span class="sd">        - **latex_units**, optional: Interpret units with latex after defining</span>
<span class="sd">          the  :attr:`~vacumm.misc.core_plot.Plot.latex_units` attribute.</span>
<span class="sd">          Alternatively, you can simply specify units enclosed with ``&quot;$&quot;``.</span>
<span class="sd">        - **x/yunits**, optional: Same as :attr:`~vacumm.misc.core_plot.Plot.units`</span>
<span class="sd">          but for X and Y axes (:attr:`~vacumm.misc.core_plot.Plot.xunits`</span>
<span class="sd">          or :attr:`~vacumm.misc.core_plot.Plot.yunits`). It refers only to</span>
<span class="sd">          axes for 2D plots, and potentially to data for 1D plots.</span>
<span class="sd">          See also param ``x/yunits``.</span>
<span class="sd">        - **x/ymin/max**, optional: Force min and max along X and Y by setting</span>
<span class="sd">          attributes :attr:`~vacumm.misc.core_plot.Plot.xmin`,</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.Plot.xmax`,</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.Plot.ymin` or</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.Plot.ymax`.</span>
<span class="sd">        - **vmin/max**, optional: Force min and max value for data by setting</span>
<span class="sd">          attributes :attr:`~vacumm.misc.core_plot.Plot.vmin`,</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.Plot.vmax`.</span>
<span class="sd">          This may be equivalent to</span>
<span class="sd">          to set X or Y extrema for 1D plots.</span>
<span class="sd">        - **x/ylabel**, optional: Force label used for X and Y axes</span>
<span class="sd">          by setting attributes :attr:`~vacumm.misc.core_plot.Plot.xlabel` or</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.Plot.ylabel`.</span>
<span class="sd">        - **title**, optional: Force the title of the plot by setting</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.Plot.title`</span>
<span class="sd">        - **x/ymasked**, optional: Force the plot to fit all data</span>
<span class="sd">          positions along X and/or Y,</span>
<span class="sd">          even if data is missing, by setting attributes</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.Plot.xmasked`,</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.Plot.ymasked`</span>
<span class="sd">          or :attr:`~vacumm.misc.core_plot.Plot.xymasked`.</span>
<span class="sd">        - **anim**, optional: Create an animation for the current figure.</span>

<span class="sd">        Example:</span>

<span class="sd">        &gt;&gt;&gt; myplot = Plot(data, xmin=3.5, title=&#39;My plot&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print myplot.xmin, myplot.title</span>
<span class="sd">        3.5 Myplot</span>



<span class="sd">        The followwing rules apply:</span>

<span class="sd">        - :attr:`title` defaults to :attr:`long_name`,</span>
<span class="sd">          which defaults to the ``long_name`` attribute of input data.</span>
<span class="sd">          You can use templates with all other attributes as replacement</span>
<span class="sd">          keys (example ``&quot;%(long_name)s (max=%(vmax)g)&quot;``) but</span>
<span class="sd">          :attr:`xlabel` and :attr`ylabel`.</span>
<span class="sd">        - :attr:`units` defaults to the ``units`` attribute of input data.</span>
<span class="sd">        - :attr:`xlong_name` defaults to :attr:`long_name` if X</span>
<span class="sd">          axis refers to data, otherwize to the ``long_name`` attribute</span>
<span class="sd">          of input second axis.</span>
<span class="sd">        - :attr:`ylong_name` defaults to :attr:`long_name` if Y</span>
<span class="sd">          axis refers to data, otherwize to the ``long_name`` attribute</span>
<span class="sd">          of input first axis.</span>
<span class="sd">        - :attr:`xunits` defaults to :attr:`units` if X</span>
<span class="sd">          axis refers to data, otherwize to the ``units`` attribute</span>
<span class="sd">          of input second axis.</span>
<span class="sd">        - :attr:`yunits` defaults to :attr:`units` if Y</span>
<span class="sd">          axis refers to data, otherwize to the ``units`` attribute</span>
<span class="sd">          of input first axis.</span>
<span class="sd">        - :attr:`xlabel` is empty if X axis refers to a spatial or</span>
<span class="sd">          temporal axis, else it defaults ``&quot;%(xlong_name)s [%(xunits)s]&quot;``.</span>
<span class="sd">          You can use templates with all other attributes as replacement</span>
<span class="sd">          keys (example ``&quot;%(long_name)s (max=%(vmax)g)&quot;``) but</span>
<span class="sd">          :attr:`title` and :attr`ylabel`.</span>
<span class="sd">        - :attr:`ylabel` is empty if Y axis refers to a spatial or</span>
<span class="sd">          temporal axis, else it defaults ``&quot;%(ylong_name)s [%(yunits)s]&quot;``.</span>
<span class="sd">          You can use templates with all other attributes as replacement</span>
<span class="sd">          keys (example ``&quot;%(long_name)s (max=%(vmax)g)&quot;``) but</span>
<span class="sd">          :attr:`title` and :attr`xlabel`.</span>
<span class="sd">        - :attr:`vmin`/:attr:`vmax` defaults to the min/max of all plotted data.</span>
<span class="sd">        - :attr:`xmin`/:attr:`xmax` defaults to :attr:`vmin`/:attr:`vmin`</span>
<span class="sd">          if X axis refers to data, else to the min/max of</span>
<span class="sd">          the second axis of input data.</span>
<span class="sd">        - :attr:`ymin`/:attr:`ymax` defaults to :attr:`vmin`/:attr:`vmin`</span>
<span class="sd">          if Y axis refers to data, else to the min/max of</span>
<span class="sd">          the first axis of input data.</span>
<span class="sd">        - :attr:`uvlat` and :attr:`uvscaler` are used to convert vectors</span>
<span class="sd">          (like speed) used by quiver plots.</span>

<span class="sd">        .. warning::</span>

<span class="sd">            These attributes may be used for the plotting process but may not be</span>
<span class="sd">            equal to their graphical counterpart. For instance, :attr:`xmin`</span>
<span class="sd">            may not be equal to ``matplotlib.pyplot.xlim()[0]``.</span>


<span class="sd">    :Generic tasks:</span>

<span class="sd">        #. Call to :meth:`load_attributes`.</span>
<span class="sd">        #. Call to :meth:`load_data` if ``load_data is True``.</span>
<span class="sd">        #. Call to :meth:`pre_plot` if ``pre_plot is True``.</span>
<span class="sd">        #. Call to :meth:`register`.</span>
<span class="sd">        #. Call to :meth:`load_attributes` for remaining attributes.</span>
<span class="sd">        #. Call to :meth:`plot` if ``plot is True``.</span>
<span class="sd">        #. Call to :meth:`post_plot` if ``plot is True and post_plot is True``.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rank</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_primary_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;xlong_name&#39;</span><span class="p">,</span> <span class="s1">&#39;ylong_name&#39;</span><span class="p">,</span>
        <span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="s1">&#39;xunits&#39;</span><span class="p">,</span> <span class="s1">&#39;yunits&#39;</span><span class="p">,</span> <span class="s1">&#39;vmin&#39;</span><span class="p">,</span> <span class="s1">&#39;xmin&#39;</span><span class="p">,</span> <span class="s1">&#39;ymin&#39;</span><span class="p">,</span> <span class="s1">&#39;vmax&#39;</span><span class="p">,</span>
        <span class="s1">&#39;xmax&#39;</span><span class="p">,</span> <span class="s1">&#39;ymax&#39;</span><span class="p">]</span>
    <span class="n">_secondary_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">,</span> <span class="s1">&#39;ylabel&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">]</span>
    <span class="n">_special_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;uvlat&#39;</span><span class="p">,</span> <span class="s1">&#39;uvscaler&#39;</span><span class="p">,</span> <span class="s1">&#39;anim&#39;</span><span class="p">,</span> <span class="s1">&#39;xymasked&#39;</span><span class="p">,</span>
        <span class="s1">&#39;xmasked&#39;</span><span class="p">,</span> <span class="s1">&#39;ymasked&#39;</span><span class="p">]</span>
    <span class="n">_plot_status_none</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_plot_status_plot</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_plot_status_post</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">masked</span> <span class="o">=</span> <span class="kc">True</span>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">load_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pre_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">post_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># First inits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gobjs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1">#        self._kwargs = kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_plotted</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finalize</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Load data</span>
        <span class="k">if</span> <span class="n">load_data</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Load attributes: for current instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_attributes</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Initialize plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pre_plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Register</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register</span><span class="p">()</span>

        <span class="c1"># Load attributes: stored in axes instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_attributes</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Plot</span>
        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># Post plot</span>
            <span class="k">if</span> <span class="n">post_plot</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">post_plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.plot_status"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.plot_status">[docs]</a>    <span class="k">def</span> <span class="nf">plot_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Guess if current instance has a plot&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;plots&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_status_none</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_plotted</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_status_post</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_status_plot</span></div>

<span class="c1">#    def update(self, status=None, glob=True):</span>
<span class="c1">#        &quot;&quot;&quot;Update what is needed of the plot&quot;&quot;&quot;</span>
<span class="c1">#        # Guess the status</span>
<span class="c1">#        if status is None: status = self.plot_status()</span>
<span class="c1">#        if not status: return</span>
<span class="c1">#</span>
<span class="c1">#        # Update</span>
<span class="c1">#        if glob: # Global update (all plotters)</span>
<span class="c1">#</span>
<span class="c1">#            for plotter in self.get_brothers():</span>
<span class="c1">#                plotter.update(status=status, glob=False)</span>
<span class="c1">#</span>
<span class="c1">#        else: # Update this plotter only</span>
<span class="c1">#</span>
<span class="c1">#            if status&gt;=self._plot_status_plot: # Re-plot</span>
<span class="c1">#                self.plot(*self._pargs, **self._kwargs)</span>
<span class="c1">#</span>
<span class="c1">#                if status==self._plot_status_post: # Re-post_plot</span>
<span class="c1">#                    self.post_plot(**self._kwargs)</span>

<div class="viewcode-block" id="Plot.is_plotted"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.is_plotted">[docs]</a>    <span class="k">def</span> <span class="nf">is_plotted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_status</span><span class="p">()</span><span class="o">&gt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_status_plot</span></div>
<div class="viewcode-block" id="Plot.is_post_plotted"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.is_post_plotted">[docs]</a>    <span class="k">def</span> <span class="nf">is_post_plotted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_status</span><span class="p">()</span><span class="o">&gt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_status_post</span></div>

<div class="viewcode-block" id="Plot.load_attributes"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.load_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">load_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load (selected) attributes from ``items``</span>

<span class="sd">        Attributes not found are set to ``None``.</span>

<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; items = dict(xmin=4., title=&#39;%(long_name)s&#39;)</span>
<span class="sd">            &gt;&gt;&gt; myplot.load_attributes(&#39;xmin&#39;, &#39;units&#39;, units=&#39;degC&#39;, **items)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># User attributes</span>
        <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_primary_attributes</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_secondary_attributes</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_special_attributes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">select</span> <span class="ow">and</span> <span class="n">att</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">select</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">att</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">att</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isset</span><span class="p">(</span><span class="n">att</span><span class="p">):</span> <span class="k">del</span> <span class="n">items</span><span class="p">[</span><span class="n">att</span><span class="p">]</span> <span class="c1"># clean out</span></div>

<div class="viewcode-block" id="Plot.register"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.register">[docs]</a>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Register current instance into self.fig and self.axes&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Cannot register plot instance since no MPL axes available&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;plotters&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;plotters&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_axobj</span><span class="p">(</span><span class="s1">&#39;plotters&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">_vacumm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">()</span></div>


<div class="viewcode-block" id="Plot.load_data"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load data and format data, and check rank.</span>
<span class="sd">        It finally calls :meth:`_check_order_`.</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **data**: A single :mod:`cdms2` variable or a tuple of them,</span>
<span class="sd">              in the forms ``(m,)``, or ``(u,v)``, ``(m,u,v)``, where:</span>

<span class="sd">                - ``u``: X component of a vector.</span>
<span class="sd">                - ``v``: Y component of a vector.</span>
<span class="sd">                - ``m``: A scalar variable. If ``u`` and ``v`` are set,</span>
<span class="sd">                  it defaults to their modulus.</span>

<span class="sd">            - **order**, optional: See :meth:`_check_order_`</span>
<span class="sd">            - **transpose**, optional: See :meth:`_check_order_`</span>
<span class="sd">            - Keywords are passed to :meth:`_set_axes_` for</span>
<span class="sd">              axis subtitutions.</span>

<span class="sd">        :Attributes:</span>

<span class="sd">            The following attributes are defined:</span>

<span class="sd">            .. attribute:: data</span>

<span class="sd">                A 1- to 3-element tuple of :class:`MV2.array`</span>
<span class="sd">                in a form of similar to **data** above.</span>

<span class="sd">            .. attribute:: x</span>

<span class="sd">                The last axis of the first element of data,</span>
<span class="sd">                or ``None`` if X axis refer to data.</span>

<span class="sd">            .. attribute:: y</span>

<span class="sd">                The first axis of the first element of data,</span>
<span class="sd">                or ``None`` if Y axis refer to data.</span>

<span class="sd">            .. attribute:: mask</span>

<span class="sd">                The data mask.</span>

<span class="sd">        :See also:</span>

<span class="sd">            :meth:`_check_order_` :meth`_set_axes_`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span>  <span class="kc">None</span>
<span class="c1">#        if data is None:</span>
<span class="c1">#            self._check_order_()</span>
<span class="c1">#            return</span>

        <span class="c1"># Arrows</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">N</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">over</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">MV2</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">1</span><span class="p">),]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span> <span class="c1"># (mod,) or (mod,u,v)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">MV2</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="c1"># Get vectors and modulus (u,v) -&gt; (mod,u,v)</span>
                <span class="n">vx</span><span class="p">,</span><span class="n">vy</span> <span class="o">=</span> <span class="p">[</span><span class="n">MV2</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">MV2</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="n">vx</span><span class="p">,</span><span class="n">vy</span><span class="p">]</span>
                <span class="n">ln</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">vx</span><span class="p">,</span><span class="n">vy</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span><span class="s1">&#39;units&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">vv</span><span class="o">.</span><span class="n">units</span>
                        <span class="k">break</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span><span class="s1">&#39;long_name&#39;</span><span class="p">):</span>
                        <span class="n">ln</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vv</span><span class="o">.</span><span class="n">long_name</span><span class="p">)</span>
                <span class="n">ln</span>  <span class="o">=</span> <span class="s1">&#39; and &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ln</span> <span class="o">=</span> <span class="s1">&#39;Modulus&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ln</span> <span class="o">=</span> <span class="s1">&#39;Modulus of &#39;</span><span class="o">+</span><span class="n">ln</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="n">ln</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setAxisList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">getAxisList</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setGrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">getGrid</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="s1">&#39;modulus&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;You must provide no more than 3 arrays as input for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

            <span class="c1"># Check all variables and axes</span>
            <span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rank</span>
            <span class="k">for</span> <span class="n">ivar</span><span class="p">,</span><span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>

                <span class="c1"># Check rank</span>
                <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Your variable must have a rank = </span><span class="si">%i</span><span class="s1"> (current rank is </span><span class="si">%i</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">rank</span><span class="p">()))</span>

                <span class="c1"># Guess axis types</span>
                <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">getOrder</span><span class="p">():</span>
                    <span class="n">check_axes</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

                <span class="c1"># Make time axes comptatible with matplotlib</span>
                <span class="n">mpl</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Store axes in x and y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_axes_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Homogeneous axis units and long_names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_axis_atts_</span><span class="p">()</span>

        <span class="c1"># Check order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_order_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Store  mask</span>
        <span class="c1">#self.x = get_axis(self.data[0], -1) if self.order[1]!=&#39;d&#39; else None</span>
        <span class="c1">#self.y = get_axis(self.data[0], 0) if self.order[0]!=&#39;d&#39; else None</span>
        <span class="c1">#self.x = self.data[0].getAxis(-1) if self.order[1]!=&#39;d&#39; else None</span>
        <span class="c1">#self.y = self.data[0].getAxis(0) if self.order[0]!=&#39;d&#39; else None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmaskarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">()</span> <span class="k">else</span>
                     <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">nomask</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">masked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
            <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;All your data are masked&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span></div>

    <span class="k">def</span> <span class="nf">_set_axes_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_check_axis_atts_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check that X/Y units and long_name can be used if possible</span>

<span class="sd">        If current axes (self.x and self.y) have no units or long_name,</span>
<span class="sd">        it tries to get them from variables (self.data).</span>

<span class="sd">        :attr`x` and :attr`y` must have been set _set_axes_ method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">xy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">]):</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">att</span><span class="p">):</span> <span class="k">continue</span>
                <span class="k">for</span> <span class="n">dat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">ax</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ax</span> <span class="o">=</span> <span class="n">get_axis</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="c1">#, geo=False)</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">att</span><span class="p">):</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">att</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">att</span><span class="p">))</span>
                        <span class="k">break</span>


    <span class="k">def</span> <span class="nf">_check_order_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transpose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check the order of axes</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **order**, optional: A string of length 2 that specify the physical type</span>
<span class="sd">              of plot axes. The first char refers to the Y axis, and the second</span>
<span class="sd">              to the X axis. It must contain one of the following characters:</span>

<span class="sd">                - ``x``: longitude</span>
<span class="sd">                - ``y``: latitude</span>
<span class="sd">                - ``z``: level</span>
<span class="sd">                - ``t``: time</span>
<span class="sd">                - ``-``: any of the latters</span>
<span class="sd">                - ``d``: data</span>

<span class="sd">              If char is upper-cased, its type is mandatory and must be found</span>
<span class="sd">              in input :mod:`cdms2` variables.</span>
<span class="sd">              It defines the :attr:`~vacumm.misc.core_plot.Plot.order` attribute.</span>

<span class="sd">            - **vertical**: Force data to be plotted along the vertical axis.</span>
<span class="sd">            - **transpose**: Transpose the plot axes</span>
<span class="sd">              (:attr:`~vacumm.misc.core_plot.Plot.order`).</span>

<span class="sd">        :Attributes:</span>

<span class="sd">            This methods defines the following attributes:</span>

<span class="sd">            .. attribute:: order</span>

<span class="sd">                Two-character string define the order of axis types.</span>
<span class="sd">                It is the sum of the :attr:`xtype` and :attr:`ytype`.</span>
<span class="sd">                Examples: ``&quot;xt&quot;``, ``z-``.</span>

<span class="sd">            .. attribute:: xtype</span>

<span class="sd">                Type of the X axis (see above).</span>

<span class="sd">            .. attribute:: ytype</span>

<span class="sd">                Type of the Y axis (see above).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;d&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span>
                              <span class="n">get_axis_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">checkaxis</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;d&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span>
                              <span class="n">get_axis_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">checkaxis</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># Allowed orders</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">]</span>
            <span class="n">withd</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span> <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="n">order</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">oo</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">oo</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="p">(</span><span class="n">withd</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s1">&#39;d&#39;</span> <span class="ow">in</span> <span class="n">oo</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;You order must be a 2-element string with &quot;d&quot; inside&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">order</span>

            <span class="c1"># Loop on variables</span>
            <span class="n">data_order</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">this_order</span><span class="p">,</span> <span class="n">_reordered</span> <span class="o">=</span> <span class="n">check_order</span><span class="p">(</span><span class="n">var</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">,</span> <span class="n">reorder</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">vertical</span><span class="o">=</span><span class="n">vertical</span><span class="p">,</span> <span class="n">extended</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">getorder</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">data_order</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">order_match</span><span class="p">(</span><span class="n">data_order</span><span class="p">,</span> <span class="n">this_order</span><span class="p">),</span> \
                        <span class="s2">&quot;Axis order incompatible: </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">last_order</span><span class="p">,</span> <span class="n">this_order</span><span class="p">)</span>
                    <span class="n">data_order</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">merge_orders</span><span class="p">(</span><span class="n">data_order</span><span class="p">,</span> <span class="n">this_order</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">data_order</span> <span class="o">=</span> <span class="n">this_order</span>

                <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">reordered</span> <span class="o">=</span> <span class="n">_reordered</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">data_order</span>

            <span class="c1"># Transpose axes when reordered</span>
            <span class="k">if</span> <span class="n">reordered</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">data_order</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_transpose_axes_</span><span class="p">()</span>

        <span class="c1"># Transpose?</span>
        <span class="k">if</span> <span class="n">transpose</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transpose_</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ytype</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>

    <span class="k">def</span> <span class="nf">_transpose_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Transpose data and axes&quot;&quot;&quot;</span>

        <span class="c1"># Variables</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ivar</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ivar</span><span class="p">]</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">var</span>

        <span class="c1"># Axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transpose_axes_</span><span class="p">()</span>

        <span class="c1"># Order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_transpose_axes_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>

<div class="viewcode-block" id="Plot.get"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;get_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.get_xmask"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_xmask">[docs]</a>    <span class="k">def</span> <span class="nf">get_xmask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the data mask projected along X&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xtype</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
        <span class="n">xdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xdata</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.get_ymask"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_ymask">[docs]</a>    <span class="k">def</span> <span class="nf">get_ymask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the data mask projected along Y&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ytype</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
        <span class="n">ydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ydata</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="Plot.get_data"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get data as a tuple of :class:`~numpy.ma.core.MaskedArray`</span>

<span class="sd">        :See also: :meth:`get_xdata` :meth:`get_ydata` :attr:`uvscaler`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">asma</span><span class="p">()</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">uvscaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uvscaler</span>
            <span class="k">if</span> <span class="n">uvscaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="n">uvscaler</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">scalar</span><span class="o">==</span><span class="s1">&#39;uv&#39;</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">scalar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">scalar</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">scalar</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scalar</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="n">scalar</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.get_xdata"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_xdata">[docs]</a>    <span class="k">def</span> <span class="nf">get_xdata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the numerical data associated with the X axis</span>

<span class="sd">        .. note::</span>

<span class="sd">            It can come from a physical axis or data</span>
<span class="sd">            depending on the axis type :attr:`xtype`.</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **scalar**, optional: Set it to ``True`` to get data</span>
<span class="sd">              as a scalar array in case X axis refers to a tuple of data.</span>
<span class="sd">              If set to an int, it takes the element #scalar of this tuple.</span>
<span class="sd">            - **masked**, optional: If it is an axis (not data), values are</span>
<span class="sd">              masked with data mask.</span>
<span class="sd">            - **bounds**, optional: The data bounds (valid only of X</span>
<span class="sd">              is an axis).</span>

<span class="sd">        :See also: :meth:`get_ydata` :meth:`get_data`</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">#        # Nothing</span>
<span class="c1">#        if not self.has_data(): return</span>
        <span class="c1"># Axis</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[:]</span> <span class="c1">#.getValue()</span>
            <span class="k">if</span> <span class="n">cdms2</span><span class="o">.</span><span class="n">isVariable</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">asma</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">isMA</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">masked</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">masked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmasked</span>
            <span class="k">if</span> <span class="n">masked</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xmask</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="o">!=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bounds</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_xb&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_xb</span> <span class="o">=</span> <span class="n">meshcells</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xb</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="c1"># Data to plot</span>
        <span class="k">if</span> <span class="n">scalar</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">scalar</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.get_ydata"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_ydata">[docs]</a>    <span class="k">def</span> <span class="nf">get_ydata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the numerical data associated with the Y axis</span>

<span class="sd">        .. note::</span>

<span class="sd">            It can come from a physical axis or data</span>
<span class="sd">            depending on the axis type :attr:`ytype`.</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **scalar**, optional: Set it to ``True`` to get data</span>
<span class="sd">              as a scalar array in case Y axis refers to a tuple of data.</span>
<span class="sd">              If set to an int, it takes the element #scalar of this tuple.</span>
<span class="sd">            - **masked**, optional: If it is an axis (not data), values are</span>
<span class="sd">              masked with data mask.</span>
<span class="sd">            - **bounds**, optional: The data bounds (valid only of Y</span>
<span class="sd">              is an axis).</span>

<span class="sd">        :See also: :meth:`get_xdata` :meth:`get_data`</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">#        # Nothing</span>
<span class="c1">#        if not self.has_data(): return</span>
        <span class="c1"># Axis</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[:]</span> <span class="c1">#.getValue()</span>
            <span class="k">if</span> <span class="n">cdms2</span><span class="o">.</span><span class="n">isVariable</span><span class="p">(</span><span class="n">y</span><span class="p">):</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">asma</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">isMA</span><span class="p">(</span><span class="n">y</span><span class="p">):</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">masked</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">masked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymasked</span>
            <span class="k">if</span> <span class="n">masked</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ymask</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="o">!=</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bounds</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_yb&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_yb</span> <span class="o">=</span> <span class="n">meshcells</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yb</span>
            <span class="k">return</span> <span class="n">y</span>
        <span class="c1"># Data to plot</span>
        <span class="k">if</span> <span class="n">scalar</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">scalar</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span></div>




<div class="viewcode-block" id="Plot.pre_plot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.pre_plot">[docs]</a>    <span class="k">def</span> <span class="nf">pre_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">subplots_adjust</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">noframe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fullscreen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axes_host</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axes_xoffset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">elev</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the plot</span>

<span class="sd">        :Tasks:</span>

<span class="sd">            #. Filter keyword parameters.</span>
<span class="sd">            #. Create the :class:`~matplotlib.fig.Figure` instance and</span>
<span class="sd">               store it into :attr:`fig`.</span>
<span class="sd">            #. Create the :class:`~matplotlib.axes.Axes` instance and</span>
<span class="sd">               store it into :attr:`axes`</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **fig**, optional: Figure number.</span>
<span class="sd">            - **figsize**, optional: Initialize the figure with this size.</span>
<span class="sd">            - **axes**, optional: Use this axes object.</span>
<span class="sd">            - **subplot**, optional: Call to :func:`~matplotlib.pyplot.subplot` to create axes.</span>
<span class="sd">            - **subplots_adjust**, optional: Dictionary sent to :func:`~matplotlib.pyplot.subplots_adjust`.</span>
<span class="sd">              You can also use keyparams &#39;left&#39;, &#39;right&#39;, &#39;top&#39;, &#39;bottom&#39;, &#39;wspace&#39;, &#39;hspace&#39;!</span>
<span class="sd">            - **top/bottom/left/right/wspace/hspace**, optional: Override ``subplots_adjust``.</span>
<span class="sd">            - **sa**, optional: Alias for subplots_adjust.</span>
<span class="sd">            - **twin**, optional: Use ``&quot;x&quot;`` or ``&quot;y&quot;`` or ``&quot;xy&quot;``  to make a copy of current</span>
<span class="sd">              X or Y axes (see :func:`matplotlib.pyplot.twinx`).</span>
<span class="sd">              You can also provide a dictionary : ``twin=dict(x=axes1, y=axes2)``.</span>
<span class="sd">            - **bgcolor**, optional: Background axis color.</span>
<span class="sd">            - **axes_rect**, optional: [left, bottom, width, height]</span>
<span class="sd">              in normalized (0,1) units to create axes using :func:`~matplotlib.pyplot.axes`.</span>
<span class="sd">            - **axes_&lt;param&gt;**, optional: &lt;param&gt; is passed to :func:`~matplotlib.pyplot.axes`.</span>
<span class="sd">            - **noframe**, optional: Suppress plot frames.</span>
<span class="sd">            - **fullscreen**, optional: Plot in full screen mode (thus, ``noframe==True``).</span>
<span class="sd">            - **verbose**, optional: Informs about errors with axes.</span>


<span class="sd">        :Attributes:</span>

<span class="sd">            .. attribute:: fig</span>

<span class="sd">                :class:`~matplotlib.fig.Figure` on which plots are drawn.</span>

<span class="sd">            .. attribute:: axes</span>

<span class="sd">                :class:`~matplotlib.axes.Axes` instance of the current plot.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Keywords management</span>
        <span class="n">figure</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig&#39;</span><span class="p">,</span> <span class="n">figure</span><span class="p">)</span>
        <span class="n">kwfig</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;figure&#39;</span><span class="p">)</span>
        <span class="n">kwaxes</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;axes&#39;</span><span class="p">)</span>
        <span class="n">subplots_adjust</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="n">subplots_adjust</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">adj</span> <span class="ow">in</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="s1">&#39;wspace&#39;</span><span class="p">,</span> <span class="s1">&#39;hspace&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">adj</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">subplots_adjust</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">subplots_adjust</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">subplots_adjust</span><span class="p">[</span><span class="n">adj</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fullscreen</span><span class="p">:</span>
            <span class="n">noframe</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">subplot</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">subplots_adjust</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">default_axes_rect</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">default_axes_rect</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">axes_rect</span> <span class="o">=</span> <span class="n">kwaxes</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">,</span> <span class="n">default_axes_rect</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axes_rect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axes_rect</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes_rect</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes_rect</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">noframe</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figure_frameon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;axes_frameon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Figure</span>
        <span class="k">if</span> <span class="n">figure</span> <span class="o">==</span> <span class="s1">&#39;old&#39;</span><span class="p">:</span>
            <span class="n">figure</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">Figure</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span>
        <span class="k">elif</span> <span class="n">figure</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">figure</span> <span class="o">==</span> <span class="s1">&#39;new&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="o">**</span><span class="n">kwfig</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">figure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="o">**</span><span class="n">kwfig</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figsize</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">figsize</span><span class="p">,</span> <span class="n">figsize</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">figsize</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">figsize</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">figsize</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">noframe</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_frameon</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subplots_adjust</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">subplots_adjust</span><span class="p">)</span>

        <span class="c1"># Axes</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">axes_host</span> <span class="ow">and</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">subplot</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">axes_rect</span>
                <span class="ow">and</span> <span class="n">twin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">subplot</span> <span class="o">=</span> <span class="mi">111</span>
        <span class="k">if</span> <span class="n">axes</span><span class="o">==</span><span class="s2">&quot;3d&quot;</span><span class="p">:</span>
            <span class="n">kwaxes</span><span class="p">[</span><span class="s1">&#39;projection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;3d&quot;</span>
            <span class="k">if</span> <span class="n">subplot</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">axes_rect</span><span class="p">:</span>
                <span class="n">subplot</span> <span class="o">=</span> <span class="mi">111</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;Axes does not match figure&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">subplot</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axes_host</span><span class="p">:</span>
<span class="c1">#                from mpl_toolkits.axes_grid1 import host_subplot</span>
                <span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.parasite_axes</span> <span class="k">import</span> <span class="n">host_subplot_class_factory</span>
                <span class="kn">from</span> <span class="nn">mpl_toolkits.axisartist</span> <span class="k">import</span> <span class="n">Axes</span> <span class="k">as</span> <span class="n">AAxes</span>
                <span class="n">host_subplot_class</span> <span class="o">=</span> <span class="n">host_subplot_class_factory</span><span class="p">(</span><span class="n">AAxes</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subplot</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">host_subplot_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="o">*</span><span class="n">subplot</span><span class="p">,</span> <span class="o">**</span><span class="n">kwaxes</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">host_subplot_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">subplot</span><span class="p">,</span> <span class="o">**</span><span class="n">kwaxes</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subplot</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="o">*</span><span class="n">subplot</span><span class="p">,</span><span class="o">**</span><span class="n">kwaxes</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">subplot</span><span class="p">,</span><span class="o">**</span><span class="n">kwaxes</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">axes_rect</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="o">*</span><span class="n">axes_rect</span><span class="p">,</span><span class="o">**</span><span class="n">kwaxes</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">twin</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">twinxy</span><span class="p">(</span><span class="n">twin</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span> <span class="c1"># Fails with host</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">axes_xoffset</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="s1">&#39;get_grid_helper&#39;</span><span class="p">):</span>
            <span class="n">new_fixed_axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_grid_helper</span><span class="p">()</span><span class="o">.</span><span class="n">new_fixed_axis</span>
            <span class="k">if</span> <span class="n">axes_xoffset</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">axes_xoffset</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_fixed_axis</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span><span class="o">.</span><span class="n">toggle</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">Axes3D</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="n">elev</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="n">azim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">noframe</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">bgcolor</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_axis_bgcolor</span><span class="p">(</span><span class="n">bgcolor</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The main plot&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_status</span><span class="p">()</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span></div>

<div class="viewcode-block" id="Plot.clear"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clear axes from plotted objects&quot;&quot;&quot;</span>
        <span class="n">objs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;plotted&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">objs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="s1">&#39;_vacumm&#39;</span><span class="p">):</span>
                    <span class="k">del</span> <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_gobjs&#39;</span><span class="p">):</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gobjs</span></div>

<div class="viewcode-block" id="Plot.remove"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.remove">[docs]</a>    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove an graphical object from axes&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">objs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">objs</span> <span class="o">=</span> <span class="p">[</span><span class="n">objs</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">axobjs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">lines</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">axobjs</span><span class="p">:</span>
                    <span class="n">axobjs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="s1">&#39;_vacumm&#39;</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="n">obj</span><span class="p">:</span>
                                <span class="k">del</span> <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;plotted&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">pp</span><span class="p">:</span>
                <span class="n">pp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.cla"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.cla">[docs]</a>    <span class="k">def</span> <span class="nf">cla</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clear axes of everything</span>

<span class="sd">        See :func:`clear` and :func:`matplotlib.pyplot.cla`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span></div>

<div class="viewcode-block" id="Plot.clf"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.clf">[docs]</a>    <span class="k">def</span> <span class="nf">clf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clear figure of everything</span>

<span class="sd">        See :func:`clear`, :func:`cla` and</span>
<span class="sd">        :func:`matplotlib.pyplot.clf`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>

<div class="viewcode-block" id="Plot.close"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close the current</span>
<span class="sd">        See :func:`clear`, :func:`cla` and :func:`clf`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>


<div class="viewcode-block" id="Plot.get_brothers"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_brothers">[docs]</a>    <span class="k">def</span> <span class="nf">get_brothers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mefirst</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return all :class:`Plot` instances that belongs to current axes</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **notme**, optional: Do not include current object in the list.</span>
<span class="sd">            - **mefirst**, optional: Place me at the beginning of the list.</span>
<span class="sd">            - **filter**, optional: If callable, use it to filter out brothers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">brothers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;plotters&#39;</span><span class="p">)</span>
        <span class="n">brothers</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">brothers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">brothers</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span> <span class="ow">in</span> <span class="n">brothers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">notme</span><span class="p">:</span>
                <span class="n">brothers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mefirst</span><span class="p">:</span>
                <span class="n">brothers</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span><span class="o">+</span><span class="n">brothers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="nb">filter</span><span class="p">):</span>
            <span class="n">brothers</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">brothers</span> <span class="k">if</span> <span class="nb">filter</span><span class="p">(</span><span class="n">b</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">brothers</span></div>

<div class="viewcode-block" id="Plot.get_current"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_current">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_current</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retreive an instance of this class if found to be plotted in currents axes</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **axes**, optional: Check this axes instance instead of the current one.</span>

<span class="sd">        :Return: Last plotted instance, else ``None``</span>

<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; m = Map.get_current()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">P</span><span class="o">.</span><span class="n">get_fignums</span><span class="p">()</span> <span class="ow">and</span> <span class="n">P</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="s1">&#39;_vacumm&#39;</span><span class="p">):</span> <span class="k">return</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">_vacumm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plotters&#39;</span><span class="p">,</span> <span class="p">[])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span> <span class="k">return</span> <span class="n">p</span></div>



<div class="viewcode-block" id="Plot.add_obj"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_obj">[docs]</a>    <span class="k">def</span> <span class="nf">add_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gtype</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a graphic object to the bank of current instance</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **gtype**: A list (or a single element) of string keys</span>
<span class="sd">              to name the object.</span>
<span class="sd">            - **obj**: The object it self (may be a list).</span>
<span class="sd">            - **single**, optional: If ``True``, ``obj`` if store as is</span>
<span class="sd">              (i.e is not appended to existing store objects having the same name).</span>

<span class="sd">        :Return:</span>

<span class="sd">            The object added.</span>

<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; text_object = myplot.add_obj([&#39;plotted&#39;, &#39;text&#39;, myplot.axes.text(10, 20, &#39;text&#39;))</span>
<span class="sd">            &gt;&gt;&gt; text_object = myplot.add_obj(&#39;colorbar&#39;, myplot.colorbar(), single=True)</span>

<span class="sd">        :See also:</span>

<span class="sd">            :meth:`set_obj` :meth:`get_obj`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Store the object</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_gobjs&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gobjs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gtype</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span> <span class="n">gtype</span> <span class="o">=</span> <span class="p">[</span><span class="n">gtype</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">gt</span> <span class="ow">in</span> <span class="n">gtype</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">single</span><span class="p">:</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">_gobjs</span><span class="p">[</span><span class="n">gt</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gobjs</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">gt</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_gobjs</span><span class="p">[</span><span class="n">gt</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_gobjs</span><span class="p">[</span><span class="n">gt</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_gobjs</span><span class="p">[</span><span class="n">gt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="Plot.set_obj"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_obj">[docs]</a>    <span class="k">def</span> <span class="nf">set_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gtype</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shortcut to :meth:`add_obj` called with ``single=True``&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_obj</span><span class="p">(</span><span class="n">gtype</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.get_obj"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_obj">[docs]</a>    <span class="k">def</span> <span class="nf">get_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gtype</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a graphic object stored in the bank</span>

<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; myplot.get_obj(&#39;pcolor&#39;)[0].set_zorder(15)</span>
<span class="sd">            &gt;&gt;&gt; myplot.get_obj(&#39;key&#39;).set_color(&#39;red&#39;)</span>

<span class="sd">        :Return:</span>

<span class="sd">            The object or ``None`` if not found.</span>

<span class="sd">        :See also:</span>

<span class="sd">            :meth:`add_obj`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_gobjs&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gobjs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Dict key</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gtype</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gobjs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">gtype</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># Check type</span>
        <span class="k">for</span> <span class="n">oo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gobjs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">oo</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">oo</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">oo</span><span class="p">,</span> <span class="n">gtype</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">o</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">oo</span><span class="p">,</span> <span class="n">gtype</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">oo</span></div>
<div class="viewcode-block" id="Plot.del_obj"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_obj">[docs]</a>    <span class="k">def</span> <span class="nf">del_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gtype</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gobjs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">gtype</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gtype</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="n">gtype</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.add_axobj"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_axobj">[docs]</a>    <span class="k">def</span> <span class="nf">add_axobj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gtype</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a object to the bank of current :class:`matplotlib.axes.Axes` instance</span>

<span class="sd">        :Return:</span>

<span class="sd">            The object added.</span>

<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; text_object = myplot.add_axobj(&#39;vmin&#39;, 24.5)</span>

<span class="sd">        :See also:</span>

<span class="sd">            :meth:`get_axobj`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">container</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">axis</span><span class="o">+</span><span class="s1">&#39;axis&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="s1">&#39;_vacumm&#39;</span><span class="p">):</span>
            <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">single</span><span class="p">:</span>
             <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span><span class="p">[</span><span class="n">gtype</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">gtype</span><span class="p">):</span>
                <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span><span class="p">[</span><span class="n">gtype</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span><span class="p">[</span><span class="n">gtype</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="Plot.set_axobj"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_axobj">[docs]</a>    <span class="k">def</span> <span class="nf">set_axobj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gtype</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shortcut to :meth:`add_axobj` called with ``single=True``&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_axobj</span><span class="p">(</span><span class="n">gtype</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.get_axobj"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_axobj">[docs]</a>    <span class="k">def</span> <span class="nf">get_axobj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get an object stored in the bank of current</span>
<span class="sd">        :class:`matplotlib.axes.Axes` instance</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **gtype**, optional: Object type (name).</span>
<span class="sd">              If not set, all objects are returned.</span>
<span class="sd">            - **axis**, optional: If one of ``&quot;x&quot;`` or ``&quot;y&quot;``,</span>
<span class="sd">              get objects stored in current</span>
<span class="sd">              xaxis or yaxis instead if current axes instance.</span>
<span class="sd">            - **axes**, optional: Target axes, which defaults to</span>

<span class="sd">                #. attribute :attr:`axes`,</span>
<span class="sd">                #. result from :func:`matplotlib.pyplot.gca`.</span>

<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; myplot.get_axobj()</span>
<span class="sd">            &gt;&gt;&gt; myplot.get_axobj(&#39;vmin&#39;)</span>
<span class="sd">            &gt;&gt;&gt; myplot.get_axobj(&#39;hlitvs&#39;, axis=&#39;x&#39;)</span>

<span class="sd">            &gt;&gt;&gt; Plot.get_axobj()</span>

<span class="sd">        :Return:</span>

<span class="sd">            The object or ``None`` if not found.</span>

<span class="sd">        :See also:</span>

<span class="sd">            :meth:`add_axobj`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">):</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
            <span class="c1">#if not P.get_fignums() or not P.gcf().axes: return</span>
            <span class="c1">#axes = P.gca()</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">axes</span> <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">axis</span><span class="o">+</span><span class="s1">&#39;axis&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="s1">&#39;_vacumm&#39;</span><span class="p">):</span>
            <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">gtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span>
        <span class="k">return</span> <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">gtype</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.del_axobj"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_axobj">[docs]</a>    <span class="k">def</span> <span class="nf">del_axobj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gtype</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">container</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">axis</span><span class="o">+</span><span class="s1">&#39;axis&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">gtype</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">container</span><span class="o">.</span><span class="n">_vacumm</span><span class="p">[</span><span class="n">gtype</span><span class="p">]</span></div>

<div class="viewcode-block" id="Plot.isset"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.isset">[docs]</a>    <span class="k">def</span> <span class="nf">isset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if an attribute has been manually set different from ``None``</span>


<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; return myplot.iset(&#39;xmin&#39;)</span>

<span class="sd">        :See also: :meth:`get_obj` :meth:`get_axobj`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Plot.post_plot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.post_plot">[docs]</a>    <span class="k">def</span> <span class="nf">post_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figtext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">close</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">savefigs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fullscreen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">autoresize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hlitvs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">param_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finish plotting stuff (plot size, grid, texts, saves, etc)</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **title**: Title of the figure [defaults to var.long_name or &#39;&#39;]</span>
<span class="sd">            - **grid**: Plot the grid [default: True]</span>
<span class="sd">            - **grid_&lt;param&gt;**: &lt;param&gt; is passed to :func:`~matplotlib.pyplot.grid`</span>
<span class="sd">            - **hlitvs**: Add highlithing if time axis [default: False]</span>
<span class="sd">            - **figtext**: figtext Add text at a specified position on the</span>
<span class="sd">              figure. Example: figtext=[0,0,&#39;text&#39;] add a &#39;text&#39; at the</span>
<span class="sd">              lower left corner, or simply figtext=&#39;text&#39;.</span>
<span class="sd">            - **figtext_&lt;param&gt;**: &lt;param&gt; is passed to</span>
<span class="sd">              :func:`~matplotlib.pyplot.figtext`</span>
<span class="sd">            - **anchor**: Anchor of the axes (useful when resizing) in</span>
<span class="sd">              [&#39;C&#39;, &#39;SW&#39;, &#39;S&#39;, &#39;SE&#39;, &#39;E&#39;, &#39;NE&#39;, &#39;N&#39;, &#39;NW&#39;, &#39;W&#39;].</span>
<span class="sd">            - **legend**, optional: Draw the legend using :func:`~matplotlib.pyplot.legend`.</span>
<span class="sd">            - **legend_&lt;param&gt;**: &lt;param&gt; is passed to :func:`~matplotlib.pyplot.legend`</span>
<span class="sd">            - **show**: Display the figure [default: True]</span>
<span class="sd">            - **savefig**: Save the figure to this file.</span>
<span class="sd">            - **savefig_&lt;param&gt;**: &lt;param&gt; is passed to method :meth:`savefig`</span>
<span class="sd">              and finally to the matplotlib function :func:`~matplotlib.pyplot.savefig`.</span>
<span class="sd">            - **savefigs**: Save the figure into multiple formats using</span>
<span class="sd">              :func:`savefigs` and &#39;savefigs&#39; as the prefix to the files.</span>
<span class="sd">            - **savefigs_&lt;param&gt;**: &lt;param&gt; is passed to :func:`savefigs`</span>
<span class="sd">            - **autoresize**: Auto resize the figure according axes (1 or True),</span>
<span class="sd">              axes+margins (2). If 0 or False, not resized [default: False=2].</span>
<span class="sd">            - **key**: Add a key (like &#39;a)&#39;) to the axes using add_key</span>
<span class="sd">              if different from None [default: None]</span>
<span class="sd">            - **key_&lt;param&gt;**: &lt;param&gt; is passed to :func:`add_key`</span>
<span class="sd">            - **param_label**: Add a param label to the figure using</span>
<span class="sd">              :meth:`add_param_label` if different from None [default: None]</span>
<span class="sd">            - **param_label_&lt;param&gt;**: &lt;param&gt; is passed to :meth:`add_param_label`</span>
<span class="sd">            - **close**: Close the figure at the end [default: False]</span>
<span class="sd">            - **title_&lt;param&gt;**: &lt;param&gt; is passed to :func:`~matplotlib.pyplot.title`</span>
<span class="sd">            - **logo_&lt;param&gt;**: &lt;param&gt; is passed to :func:`add_logo`</span>
<span class="sd">            - **tight_layout**: To make a tight layout one everything is plotted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_plotted</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Format X and Y axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format_axes</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Filter kewords</span>
        <span class="n">kw</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">kwtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;hlitvs&#39;</span><span class="p">,</span> <span class="s1">&#39;hldays&#39;</span><span class="p">,</span> <span class="s1">&#39;dayhl&#39;</span><span class="p">,</span> <span class="s1">&#39;finalize&#39;</span><span class="p">,</span>
            <span class="s1">&#39;figtext&#39;</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;savefig&#39;</span><span class="p">,</span> <span class="s1">&#39;savefigs&#39;</span><span class="p">,</span> <span class="s1">&#39;show&#39;</span><span class="p">,</span> <span class="s1">&#39;legend&#39;</span><span class="p">,</span>
            <span class="s1">&#39;tight_layout&#39;</span><span class="p">,</span> <span class="s1">&#39;param_label&#39;</span><span class="p">,</span> <span class="s1">&#39;autoresize&#39;</span><span class="p">]:</span>
            <span class="n">kw</span><span class="p">[</span><span class="n">kwtype</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">kwtype</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">kwtype</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_primary_attributes</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_secondary_attributes</span><span class="o">+</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_special_attributes</span> <span class="ow">and</span> <span class="n">kw</span><span class="p">[</span><span class="n">kwtype</span><span class="p">]</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">kwtype</span><span class="p">)):</span>
                <span class="k">del</span> <span class="n">kw</span><span class="p">[</span><span class="n">kwtype</span><span class="p">][</span><span class="n">kwtype</span><span class="p">]</span>
        <span class="n">kwanim</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;anim_&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;show&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwanim</span><span class="p">)</span>
        <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;hlitvs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;dayhl&#39;</span><span class="p">])</span> <span class="c1"># compat</span>
        <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;hlitvs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;hldays&#39;</span><span class="p">])</span> <span class="c1"># compat</span>

        <span class="c1"># Resize plot</span>
        <span class="n">autoresized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoresize</span><span class="p">(</span><span class="n">autoresize</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;autoresize&#39;</span><span class="p">])</span>

        <span class="c1"># Anchor</span>
        <span class="k">if</span> <span class="n">anchor</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">autoresized</span><span class="p">:</span>
            <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;C&#39;</span>
        <span class="k">if</span> <span class="n">anchor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_anchor</span><span class="p">(</span><span class="n">anchor</span><span class="p">)</span>

        <span class="c1"># Grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">])</span>

        <span class="c1"># Highlight intervals</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;hldays&#39;</span><span class="p">,</span> <span class="n">hlitvs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;hldays&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;hlitvs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;day&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hlitvs</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;hlitvs&#39;</span><span class="p">])</span>

        <span class="c1"># Title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>

        <span class="c1"># Fig text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="n">figtext</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;figtext&#39;</span><span class="p">])</span>

        <span class="c1"># Key of axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">])</span>

        <span class="c1"># Params</span>
        <span class="k">if</span> <span class="n">param_label</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_param_label</span><span class="p">(</span><span class="n">param_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;param_label&#39;</span><span class="p">])</span>

        <span class="c1"># Legend</span>
        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;legend&#39;</span><span class="p">])</span>

        <span class="c1"># Tight layout</span>
        <span class="k">if</span> <span class="n">tight_layout</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;tight_layout&#39;</span><span class="p">])</span>

        <span class="c1"># User finalization</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">finalize</span><span class="p">):</span>
            <span class="n">dict_check_defaults</span><span class="p">(</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;finalize&#39;</span><span class="p">],</span> <span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
            <span class="n">finalize</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;finalize&#39;</span><span class="p">])</span>

        <span class="c1"># Save it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;savefig&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">savefigs</span><span class="p">(</span><span class="n">savefigs</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;savefigs&#39;</span><span class="p">])</span>

        <span class="c1"># Show or close</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;show&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">close</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>



<div class="viewcode-block" id="Plot.format_axes"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.format_axes">[docs]</a>    <span class="k">def</span> <span class="nf">format_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">date_rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">date_locator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_minor_locator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_nominor</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Scale and format X and Y axes</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **x/y/vskip**, optional: Skip axis formating.</span>
<span class="sd">            - **nodate**, optional: do not format as date.</span>
<span class="sd">            - **date_rotation**, optional: Rotate date labels.</span>
<span class="sd">            - **date_fmt**, optional: Date format (like ``&quot;%s/%m/%Y&quot;``).</span>
<span class="sd">            - **date_locator**, optional: Major locator (see :func:`setup_time_axis`).</span>
<span class="sd">            - **date_minor_locator**, optional: Minor locator (see :func:`setup_time_axis`).</span>
<span class="sd">            - **date_nominor**, optional: Do not plot minor localor.</span>
<span class="sd">            - **x/y/vmin/max**, optional: Force min/max of X or Y axis (defaults to :attr:`xmin`, etc).</span>
<span class="sd">            - **x/y/vlim**, optional: Force min/max of X or Y axis with `(min,max)`` like argument.</span>
<span class="sd">            - **x/y/vminmax**, optional: Minimal max value</span>
<span class="sd">              -&gt; use this value if max is too low.</span>
<span class="sd">            - **x/y/vmaxmin**, optional: Maximal min value.</span>
<span class="sd">            - **x/yticks**, optional: Position of ticks.</span>
<span class="sd">            - **x/yfmt** (or **...format**, **...tickfmt**, **...tickformat**, optional: Format of ticks.</span>
<span class="sd">            - **x/yticklabels**, optional: Label of ticks.</span>
<span class="sd">            - **x/yhide**, optional: Hide labels.</span>
<span class="sd">            - **x/ynmax** (or **...nmax_ticks***), optional: Max number of ticks for some locators.</span>
<span class="sd">            - **x/y/vtitle** (or **..label**), optional: Title of the axis (defaults to :attr:`xlabel`, etc).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vkwargs</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">short</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iaxis</span><span class="p">,</span> <span class="n">xy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)):</span>

            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;skip&#39;</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="c1"># Base</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">xy</span><span class="o">+</span><span class="s1">&#39;axis&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
            <span class="n">iorder</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">iaxis</span>

            <span class="c1"># Keywords</span>
            <span class="n">defaults</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">props</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">iaxis</span><span class="p">]</span>
            <span class="n">vatts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;minmax&#39;</span><span class="p">,</span> <span class="s1">&#39;maxmin&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">),</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="p">]</span>
            <span class="n">aatts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;strict&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;fmt&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">,</span> <span class="s1">&#39;tickfmt&#39;</span><span class="p">,</span> <span class="s1">&#39;tickformat&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;rotation&#39;</span><span class="p">,</span> <span class="s1">&#39;rotate&#39;</span><span class="p">),</span>
                <span class="s1">&#39;lim&#39;</span><span class="p">,</span> <span class="s1">&#39;hide&#39;</span><span class="p">,</span> <span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="s1">&#39;ticklabels&#39;</span><span class="p">,</span><span class="s1">&#39;locator&#39;</span><span class="p">,</span> <span class="s1">&#39;minor_locator&#39;</span><span class="p">,</span> <span class="s1">&#39;formatter&#39;</span><span class="p">,</span> <span class="s1">&#39;minor_formatter&#39;</span><span class="p">,</span>
                <span class="p">(</span><span class="s1">&#39;nmax&#39;</span><span class="p">,</span> <span class="s1">&#39;nmax_ticks&#39;</span><span class="p">),</span> <span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="s1">&#39;minutes&#39;</span><span class="p">]</span>
            <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1">#strict=True)</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
                <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;strict&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">xykwargs</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">short</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">raw_att</span> <span class="ow">in</span> <span class="n">aatts</span><span class="o">+</span><span class="n">vatts</span><span class="p">:</span>

                <span class="c1"># Merge aliases</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_att</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">dict_aliases</span><span class="p">(</span><span class="n">xykwargs</span><span class="p">,</span> <span class="n">raw_att</span><span class="p">)</span>
                    <span class="n">att</span> <span class="o">=</span> <span class="n">raw_att</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">att</span> <span class="o">=</span> <span class="n">raw_att</span>

                <span class="c1"># Default values</span>
                <span class="c1"># - base</span>
                <span class="n">default</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="c1"># - get it from cdms variable</span>
                <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span> <span class="ow">and</span> <span class="n">raw_att</span> <span class="ow">in</span> <span class="n">vatts</span><span class="p">:</span>
                    <span class="n">kwvar</span> <span class="o">=</span> <span class="n">dict_aliases</span><span class="p">(</span><span class="n">vkwargs</span><span class="p">,</span> <span class="n">raw_att</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">xykwargs</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">att</span><span class="p">)</span> <span class="ow">and</span> <span class="n">kwvar</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">att</span><span class="p">):</span>
                        <span class="n">default</span> <span class="o">=</span> <span class="n">kwvar</span><span class="p">[</span><span class="n">att</span><span class="p">]</span>
                <span class="c1"># - special</span>
                <span class="k">if</span> <span class="n">defaults</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">att</span><span class="p">):</span>
                    <span class="n">default</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="n">att</span><span class="p">]</span>

                <span class="c1"># Get attribute</span>
                <span class="n">props</span><span class="p">[</span><span class="n">att</span><span class="p">]</span> <span class="o">=</span> <span class="n">xykwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">att</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>

            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;label_kwargs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">xykwargs</span><span class="p">,</span> <span class="s1">&#39;label_&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;label_kwargs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">xykwargs</span><span class="p">,</span> <span class="s1">&#39;title_&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;fmt_kwargs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">xykwargs</span><span class="p">,</span> <span class="s1">&#39;fmt_&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;locator_kwargs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">xykwargs</span><span class="p">,</span> <span class="s1">&#39;locator_&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticklabels_kwargs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">xykwargs</span><span class="p">,</span> <span class="s1">&#39;ticklabels_&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span> <span class="ow">and</span> <span class="n">log</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">props</span><span class="p">[</span><span class="s1">&#39;locator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">props</span><span class="p">[</span><span class="s1">&#39;minor_locator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># Axis scale</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="s1">&#39;set_</span><span class="si">%s</span><span class="s1">scale&#39;</span><span class="o">%</span><span class="n">xy</span><span class="p">)(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">])</span>

            <span class="c1"># Limits</span>
            <span class="n">axmin</span><span class="p">,</span> <span class="n">axmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
            <span class="c1"># - wee clearly need strict limits</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;strict&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">props</span><span class="p">[</span><span class="s1">&#39;strict&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;t&#39;</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;strict&#39;</span><span class="p">]:</span>
                <span class="n">axmin</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;get_</span><span class="si">%s</span><span class="s1">min&#39;</span><span class="o">%</span><span class="n">xy</span><span class="p">)(</span><span class="n">glob</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">axmax</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;get_</span><span class="si">%s</span><span class="s1">max&#39;</span><span class="o">%</span><span class="n">xy</span><span class="p">)(</span><span class="n">glob</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># - use of the form xlim/ylim</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;lim&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;lim&#39;</span><span class="p">],</span><span class="nb">dict</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;lim&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;min&#39;</span><span class="p">):</span>
                        <span class="n">axmin</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;lim&#39;</span><span class="p">][</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;lim&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s1">&#39;min&#39;</span><span class="p">):</span>
                        <span class="n">axmin</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;lim&#39;</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;lim&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;max&#39;</span><span class="p">):</span>
                        <span class="n">axmax</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;lim&#39;</span><span class="p">][</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;lim&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s1">&#39;max&#39;</span><span class="p">):</span>
                        <span class="n">axmax</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;lim&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">axmin</span><span class="p">,</span> <span class="n">axmax</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;lim&#39;</span><span class="p">]</span>
            <span class="c1"># - we directly specify xmin/xmax...</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">axmin</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">isset</span><span class="p">(</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;min&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="n">iorder</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">isset</span><span class="p">(</span><span class="s1">&#39;vmin&#39;</span><span class="p">)):</span>
                <span class="n">axmin</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;get_</span><span class="si">%s</span><span class="s1">min&#39;</span><span class="o">%</span><span class="n">xy</span><span class="p">)()</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">axmax</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">isset</span><span class="p">(</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;max&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="n">iorder</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">isset</span><span class="p">(</span><span class="s1">&#39;vmax&#39;</span><span class="p">)):</span>
                <span class="n">axmax</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;get_</span><span class="si">%s</span><span class="s1">max&#39;</span><span class="o">%</span><span class="n">xy</span><span class="p">)()</span>
            <span class="c1"># - we put min and max in boundary</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;minmax&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">axmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axmin</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;get_</span><span class="si">%s</span><span class="s1">min&#39;</span><span class="o">%</span><span class="n">xy</span><span class="p">)(</span><span class="n">glob</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">axmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">axmin</span><span class="p">,</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;minmax&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;maxmin&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">axmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axmax</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;get_</span><span class="si">%s</span><span class="s1">max&#39;</span><span class="o">%</span><span class="n">xy</span><span class="p">)(</span><span class="n">glob</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">axmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">axmax</span><span class="p">,</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;maxmin&#39;</span><span class="p">])</span>
            <span class="c1"># - ok, lets set it</span>
            <span class="n">xylim_func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="s1">&#39;set_</span><span class="si">%s</span><span class="s1">lim&#39;</span><span class="o">%</span><span class="n">xy</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">axmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;t&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">axmin</span><span class="p">,</span> <span class="n">basestring</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">N</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">axmin</span><span class="p">)):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">axmin</span> <span class="o">=</span> <span class="n">mpl</span><span class="p">(</span><span class="n">axmin</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t convert axmin to date: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">axmin</span><span class="p">)</span>
                <span class="n">xylim_func</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">_asnum_</span><span class="p">(</span><span class="n">axmin</span><span class="p">)})</span>
            <span class="k">if</span> <span class="n">axmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;t&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">axmax</span><span class="p">,</span> <span class="n">basestring</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">N</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">axmax</span><span class="p">)):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">axmax</span> <span class="o">=</span> <span class="n">mpl</span><span class="p">(</span><span class="n">axmax</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t convert axmax to date: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">axmin</span><span class="p">)</span>
                <span class="n">xylim_func</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">_asnum_</span><span class="p">(</span><span class="n">axmax</span><span class="p">)})</span>

            <span class="c1"># Ticks values and formats</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]:</span> <span class="c1"># Lon, lat or dep axis</span>
                <span class="n">kwscale</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">axmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">axmax</span><span class="p">,</span> <span class="n">geo</span><span class="o">=</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;minutes&#39;</span><span class="p">])</span>
                <span class="n">kwlf</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;fmt_kwargs&#39;</span><span class="p">]</span>
                <span class="n">lab_val</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">lab_val</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab_val</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">lab_val</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">lab_val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">lab_val</span> <span class="o">=</span> <span class="n">geo_scale</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">nmax</span><span class="o">=</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;nmax&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwscale</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
                        <span class="n">lab_func</span> <span class="o">=</span> <span class="n">lonlab</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lab_func</span> <span class="o">=</span> <span class="n">latlab</span>
                    <span class="n">kwlf</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;decimal&#39;</span><span class="p">,</span> <span class="ow">not</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;minutes&#39;</span><span class="p">])</span>
                    <span class="n">kwlf</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;auto_minutes&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lab_val</span><span class="p">))</span><span class="o">!=</span><span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">lab_val</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">lab_val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">lab_val</span> <span class="o">=</span> <span class="n">auto_scale</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwscale</span><span class="p">)</span>
                    <span class="n">lab_func</span> <span class="o">=</span> <span class="n">deplab</span>
                <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]):</span>
                    <span class="n">lab_func</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]</span>
                    <span class="n">props</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1">#FIXME: bad choice (due to labels?)</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">lab_val</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span> <span class="c1"># set min/max from ticks when no data available</span>
                    <span class="k">if</span> <span class="n">axmin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                        <span class="n">axmin</span> <span class="o">=</span> <span class="n">lab_val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">axmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">axmax</span> <span class="o">=</span> <span class="n">lab_val</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1">#                kwtf = {}</span>
                <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]</span><span class="o">%</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lab_val</span><span class="p">],</span> <span class="o">**</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticklabels_kwargs&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
<span class="c1">#                    kwtf[&#39;fmt&#39;] = props[&#39;fmt&#39;]</span>
                    <span class="n">axis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">lab_func</span><span class="p">(</span><span class="n">lab_val</span><span class="p">,</span> <span class="o">**</span><span class="n">kwlf</span><span class="p">),</span> <span class="o">**</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticklabels_kwargs&#39;</span><span class="p">])</span>
                <span class="n">props</span><span class="p">[</span><span class="s1">&#39;locator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">elif</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;t&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">nodate</span><span class="p">:</span> <span class="c1"># Time axis</span>

                <span class="c1"># Rotate dates</span>
<span class="c1">#                if date_rotation is None:</span>
<span class="c1">#                    if xy==&#39;y&#39;:</span>
<span class="c1">#                        date_rotation = 0.</span>
<span class="c1">#                    else:</span>
<span class="c1">#                        date_rotation = 30.</span>

                <span class="c1"># Ok let&#39;s format</span>
                <span class="n">trange</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ptp</span><span class="p">()</span>
                <span class="n">kwdate</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">kwdate</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;nmax_ticks&#39;</span><span class="p">,</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;nmax&#39;</span><span class="p">])</span>
                <span class="n">kwdate</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">axmin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">axmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">setup_time_axis</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">date_rotation</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">date_fmt</span><span class="p">,</span><span class="n">locator</span><span class="o">=</span><span class="n">date_locator</span><span class="p">,</span>
                    <span class="n">minor_locator</span><span class="o">=</span><span class="n">date_minor_locator</span><span class="p">,</span><span class="n">nominor</span><span class="o">=</span><span class="n">date_nominor</span><span class="p">,</span><span class="n">trange</span><span class="o">=</span><span class="n">trange</span><span class="p">,</span>
                    <span class="n">nodual</span><span class="o">=</span><span class="n">date_rotation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwdate</span><span class="p">)</span>
                <span class="n">props</span><span class="p">[</span><span class="s1">&#39;locator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">else</span><span class="p">:</span> <span class="c1"># Other axes</span>
                <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Numeric format</span>
                    <span class="n">axis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;locator&#39;</span><span class="p">]:</span>
                <span class="n">locator</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;locator&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;locator_kwargs&#39;</span><span class="p">]:</span>
                   <span class="n">locator</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;locator_kwargs&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;minor_locator&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">&#39;xyzt&#39;</span><span class="p">:</span>
                <span class="n">props</span><span class="p">[</span><span class="s1">&#39;minor_locator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AutoMinorLocator</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;minor_locator&#39;</span><span class="p">]:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;minor_locator&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;formatter&#39;</span><span class="p">]:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;formatter&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;minor_formatter&#39;</span><span class="p">]:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;minor_formatter&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;t&#39;</span> <span class="ow">or</span> <span class="n">nodate</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;rotation&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="s1">&#39;rotation&#39;</span><span class="p">,</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;rotation&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">nodate</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span> <span class="c1"># set min/max from ticks when no data available</span>
                    <span class="k">if</span> <span class="n">axmin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                        <span class="n">axmin</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">axmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">axmax</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticklabels&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticklabels&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticklabels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticklabels&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticklabels_kwargs&#39;</span><span class="p">])</span>

            <span class="c1"># Hiding</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyhide_</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;hide&#39;</span><span class="p">]):</span>
                <span class="n">P</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="s1">&#39;visible&#39;</span><span class="p">,</span> <span class="ow">not</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;hide&#39;</span><span class="p">])</span>

            <span class="c1"># Label</span>
            <span class="k">elif</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="o">+</span><span class="s1">&#39;label&#39;</span><span class="p">)</span> <span class="ow">and</span>  <span class="n">axis</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">props</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="o">+</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="s1">&#39;set_</span><span class="si">%s</span><span class="s1">label&#39;</span><span class="o">%</span><span class="n">xy</span><span class="p">)</span>
                    <span class="n">func</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label_kwargs&#39;</span><span class="p">])</span>

            <span class="c1"># Now set again min/max</span>
            <span class="k">if</span> <span class="n">axmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">xylim_func</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">_asnum_</span><span class="p">(</span><span class="n">axmin</span><span class="p">)})</span>
            <span class="k">if</span> <span class="n">axmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">xylim_func</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">_asnum_</span><span class="p">(</span><span class="n">axmax</span><span class="p">)})</span>

            <span class="c1"># Properties</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticklabels_kwargs&#39;</span><span class="p">]:</span>
                <span class="n">P</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="o">**</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;ticklabels_kwargs&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;label_kwargs&#39;</span><span class="p">]:</span>
                <span class="n">P</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">get_label</span><span class="p">(),</span> <span class="o">**</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label_kwargs&#39;</span><span class="p">])</span></div>

    <span class="k">def</span> <span class="nf">_xyhide_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">hide</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hide</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">hide</span>
        <span class="n">hide</span> <span class="o">=</span> <span class="n">hide</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">hide</span><span class="o">==</span><span class="s1">&#39;auto&#39;</span> <span class="ow">or</span> <span class="n">hide</span><span class="o">==</span><span class="s1">&#39;subplot&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">Subplot</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">xy</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">is_last_row</span><span class="p">()</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">is_first_col</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="Plot.autoresize"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.autoresize">[docs]</a>    <span class="k">def</span> <span class="nf">autoresize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">autoresize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">minaspect</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resize figure or axes to fit to data axes&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">autoresize</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_aspect</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;auto&#39;</span> <span class="ow">and</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">Subplot</span><span class="p">)</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">is_first_col</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">is_first_row</span><span class="p">()</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">is_last_col</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">is_last_row</span><span class="p">()):</span>

            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_aspect</span><span class="p">()</span> <span class="c1"># dy/dx</span>
            <span class="k">if</span> <span class="n">r</span><span class="o">==</span><span class="s1">&#39;equal&#39;</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="n">r</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_data_ratio</span><span class="p">()</span>
    <span class="c1">#       rect = self.axes.get_position(True)</span>
    <span class="c1">#       if autoresize == 2: r *= rect.width/rect.height</span>

            <span class="n">sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplotpars</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">left</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">right</span>
            <span class="n">y0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">bottom</span>
            <span class="n">y1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">top</span>
            <span class="n">Dx</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
            <span class="n">Dy</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">Dx</span> <span class="o">/</span> <span class="n">Dy</span>

            <span class="k">if</span> <span class="n">minaspect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">R</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">minaspect</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">minaspect</span><span class="p">)</span>


            <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">autoresize</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="c1"># Resize x only, change the surface</span>
                <span class="n">H</span> <span class="o">=</span> <span class="n">h</span>
                <span class="n">W</span> <span class="o">=</span> <span class="n">H</span> <span class="o">/</span> <span class="n">R</span>
            <span class="k">elif</span> <span class="n">autoresize</span><span class="o">==</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="c1"># Resize y only, change the surface</span>
                <span class="n">W</span> <span class="o">=</span> <span class="n">w</span>
                <span class="n">H</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">W</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># Resize both x and y without changing the surface</span>
                <span class="n">a</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">h</span>
                <span class="n">W</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">R</span><span class="p">)</span>
                <span class="n">H</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">W</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="p">,</span><span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">_transform_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_transform_</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_xy"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_xy">[docs]</a>    <span class="k">def</span> <span class="nf">get_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xyscaler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">default_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atleast_1d</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert (x,y) in data coordinates</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **x/y**: Coordinates referenced to data, axes or figure.</span>
<span class="sd">            - **transform**, optional: Transform applied to coordinates.</span>
<span class="sd">              This either a :class:`matplotlib.transforms.Transform` or a string:</span>
<span class="sd">              ``&quot;data&quot;``, ``&quot;axes&quot;``, ``&quot;figure&quot;``.</span>
<span class="sd">            - **xyscaler**, optional: Converter of coordinates used when input</span>
<span class="sd">              coordinates are in data coordinates. It must be a callable,</span>
<span class="sd">              and it defaults to attribute :attr:`xyscaler` if existing.</span>
<span class="sd">              It converts for instance from degrees to meters for :class:`Map`</span>
<span class="sd">              instances. If equal to False, no conversion is performed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">default_transform</span><span class="p">)</span>

        <span class="c1"># From figure or axes coordinates</span>
        <span class="k">if</span> <span class="n">transform</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span> <span class="ow">or</span> <span class="n">transform</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">((</span><span class="n">transform</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span><span class="p">)</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>

        <span class="c1"># From data coordinates (check xyscaler only)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">transform</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span> <span class="ow">or</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">_parents</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> \
            <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">transform</span><span class="p">))</span> <span class="ow">and</span> <span class="n">xyscaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span> <span class="c1"># Add transform from ie degrees to m</span>
            <span class="k">if</span> <span class="n">xyscaler</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;xyscaler&#39;</span><span class="p">):</span> <span class="n">xyscaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyscaler</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xyscaler</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xyscaler</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span></div>


<div class="viewcode-block" id="Plot.get_transoffset"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_transoffset">[docs]</a>    <span class="k">def</span> <span class="nf">get_transoffset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;points&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a translation :class:`~maplotlib.transforms.Transform`</span>

<span class="sd">        It can be used for instance to plot an object with an</span>
<span class="sd">        offset with respect to its specified position.</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **x/y**: Relative position.</span>
<span class="sd">            - **units**, optional: Units (&quot;points&quot;, &quot;inches&quot;, &quot;pixels&quot;, ...)</span>
<span class="sd">            - **transform**, optional: Base transform for reference position.</span>
<span class="sd">              Choose for instance &quot;data&quot; or &quot;axes&quot;.</span>


<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; o = Plot2D(data)</span>
<span class="sd">            &gt;&gt;&gt; o.add_point(-4, 43)</span>
<span class="sd">            &gt;&gt;&gt; t = o.get_transoffset(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; o.text(-4, 43, transform=t)</span>

<span class="sd">        :See also: :func:`~maplotlib.transforms.offset_copy`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">offset_copy</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.grid"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.grid">[docs]</a>    <span class="k">def</span> <span class="nf">grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a grid to axes using :func:`~matplotlib.pyplot.grid`</span>


<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; myplot.grid(color=&#39;r&#39;)</span>
<span class="sd">            &gt;&gt;&gt; myplot.grid(False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">#        grid = self.get_axobj(&#39;grid&#39;)</span>
<span class="c1">#        print &#39;grid&#39;,grid</span>
<span class="c1">#        if grid is None:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
<span class="c1">#           print grid</span>
<span class="c1">#           self.set_axobj(&#39;grid&#39;, grid)</span>
<span class="c1">#           print self.get_axobj(&#39;grid&#39;)</span>
<span class="c1">#        print &#39;done&#39;</span>
<span class="c1">#        return grid</span>

<div class="viewcode-block" id="Plot.add_figtext"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_figtext">[docs]</a>    <span class="k">def</span> <span class="nf">add_figtext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add text to the current figure using :func:`~matplotlib.pyplot.figtext`</span>

<span class="sd">        :Defaults:</span>

<span class="sd">            - Position: defaults to the top center.</span>
<span class="sd">            - Alignement: ``ha=&quot;center&quot;, va=&quot;top&quot;``</span>

<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; myplot.figtext(&#39;Group of plots&#39;)</span>
<span class="sd">            &gt;&gt;&gt; myplot.figtext(0.2, 0.92, &#39;My plots&#39;, color=&#39;b&#39;, ha=&#39;left&#39;, va=&#39;center&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Arguments</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
                <span class="n">y</span> <span class="o">=</span> <span class="o">.</span><span class="mi">98</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">args</span>

        <span class="c1"># Keywords</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">=</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">text</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
            <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.4&#39;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;monospace&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">defaults</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

        <span class="c1"># Plot</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_obj</span><span class="p">(</span><span class="s1">&#39;figtext&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span></div>
    <span class="n">figtext</span> <span class="o">=</span> <span class="n">add_figtext</span> <span class="c1"># backward compat</span>

<div class="viewcode-block" id="Plot.add_text"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_text">[docs]</a>    <span class="k">def</span> <span class="nf">add_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">xyscaler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add text to the plot axes</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **x,y**: Coordinates of the text.</span>
<span class="sd">            - **text**: Text to plot.</span>
<span class="sd">            - **transform**, optional: Type of coordinates</span>
<span class="sd">              (like ``&quot;axes&quot;`` or ``&quot;data&quot;``).</span>
<span class="sd">            - **shadow**, optional: Add a droped shadow below the text</span>
<span class="sd">              (see :func:`add_shadow`).</span>
<span class="sd">            - **shadow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :func:`add_shadow`.</span>
<span class="sd">            - **glow**, optional: Add a glow effect the text</span>
<span class="sd">              (see :func:`add_glow`).</span>
<span class="sd">            - **glow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :func:`add_glow`.</span>
<span class="sd">            - Other keywords are passed to :func:`matplotlib.pyplot.text`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Keywords</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>

        <span class="c1"># Coordinates transform</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">transform</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">]:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">transform</span><span class="p">,</span> <span class="n">xyscaler</span><span class="o">=</span><span class="n">xyscaler</span><span class="p">)</span>

        <span class="c1"># Plot</span>
        <span class="k">if</span> <span class="n">strip</span><span class="p">:</span> <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_axobj</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Path effects</span>
        <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">obj</span></div>
    <span class="n">text</span> <span class="o">=</span> <span class="n">add_text</span> <span class="c1"># backward compat</span>

<div class="viewcode-block" id="Plot.add_water_mark"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_water_mark">[docs]</a>    <span class="k">def</span> <span class="nf">add_water_mark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">x</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">y</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a background text to the plot</span>

<span class="sd">        All arguments are passed to :meth:`add_text`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="n">ha</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="n">va</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.add_time_label"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_time_label">[docs]</a>    <span class="k">def</span> <span class="nf">add_time_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">mytime</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;%Y/%m/</span><span class="si">%d</span><span class="s2"> %H:%M&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a time label</span>

<span class="sd">        See :meth:`add_text` for other keywords</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">strftime</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">mytime</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;family&#39;</span><span class="p">,</span> <span class="s1">&#39;monospace&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.add_lon_label"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_lon_label">[docs]</a>    <span class="k">def</span> <span class="nf">add_lon_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">mylon</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%5g</span><span class="s1">&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a longitude label</span>

<span class="sd">        See :meth:`add_text` for other keywords</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">lonlab</span><span class="p">(</span><span class="n">mylon</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.add_lat_label"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_lat_label">[docs]</a>    <span class="k">def</span> <span class="nf">add_lat_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">mylat</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%5g</span><span class="s1">&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a longitude label</span>

<span class="sd">        See :meth:`add_text` for other keywords</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">latlab</span><span class="p">(</span><span class="n">mylat</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.add_left_label"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_left_label">[docs]</a>    <span class="k">def</span> <span class="nf">add_left_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a text label to the left of the plot</span>

<span class="sd">        :See also: :func:`~vacumm.misc.plot.add_left_label`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">return</span> <span class="n">add_left_label</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.add_right_label"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_right_label">[docs]</a>    <span class="k">def</span> <span class="nf">add_right_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a text label to the right of the plot</span>

<span class="sd">        :See also: :func:`~vacumm.misc.plot.add_right_label`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">return</span> <span class="n">add_right_label</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.add_top_label"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_top_label">[docs]</a>    <span class="k">def</span> <span class="nf">add_top_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a text label to the top of the plot</span>

<span class="sd">        :See also: :func:`~vacumm.misc.plot.add_top_label`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">return</span> <span class="n">add_top_label</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.add_bottom_label"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_bottom_label">[docs]</a>    <span class="k">def</span> <span class="nf">add_bottom_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a text label to the bottom of the plot</span>

<span class="sd">        :See also: :func:`~vacumm.misc.plot.add_bottom_label`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">return</span> <span class="n">add_bottom_label</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.add_key"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_key">[docs]</a>    <span class="k">def</span> <span class="nf">add_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a key to specify the plot number</span>

<span class="sd">        See :func:`~vacumm.misc.plot.add_key` for more information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span> <span class="k">return</span>
        <span class="kn">from</span> <span class="nn">vacumm.misc.plot</span> <span class="k">import</span> <span class="n">add_key</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">add_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span></div>

<div class="viewcode-block" id="Plot.add_param_label"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_param_label">[docs]</a>    <span class="k">def</span> <span class="nf">add_param_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add parameters description to the bottom/left of the figure using</span>
<span class="sd">        :func:`~vacumm.misc.plot.add_param_label`</span>

<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; c = curve2(sst, show=False)</span>
<span class="sd">            &gt;&gt;&gt; c.add_param_label(dict(max=.23, kz=0.25), color=&#39;r&#39;)</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **text**: Either a string or a dictionary.</span>
<span class="sd">            - See :func:`~vacumm.misc.plot.add_param_label` for other parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;fig&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span>
        <span class="k">return</span> <span class="n">add_param_label</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.add_annotation"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_annotation">[docs]</a>    <span class="k">def</span> <span class="nf">add_annotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xtext</span><span class="p">,</span> <span class="n">ytext</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
            <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span> <span class="n">arrowprops</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span>
            <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">xyscaler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an annotation to the plot axes using :func:`matplotlib.pyplot.annotate`</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **x,y**: Coordinates of the text.</span>
<span class="sd">            - **text**: Text to plot.</span>
<span class="sd">            - **xycoords/transform**, optional: Type of coordinates of point</span>
<span class="sd">              (like ``&quot;axes&quot;`` or ``&quot;data&quot;``).</span>
<span class="sd">            - **textcoords**, optional: Type of coordinates of text</span>
<span class="sd">              (like ``&quot;axes&quot;`` or ``&quot;data&quot;``).</span>
<span class="sd">            - **arrowprops**, optional: Dictionary of arrow properties or</span>
<span class="sd">              string thet defines the arrow style.</span>
<span class="sd">            - **shadow**, optional: Add a droped shadow below the text</span>
<span class="sd">              (see :func:`add_shadow`).</span>
<span class="sd">            - **shadow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :func:`add_shadow`.</span>
<span class="sd">            - **glow**, optional: Add a glow effect the text</span>
<span class="sd">              (see :func:`add_glow`).</span>
<span class="sd">            - **glow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :func:`add_glow`.</span>
<span class="sd">            - Other keywords are passed to :func:`matplotlib.pyplot.annotate`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Keywords</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>

        <span class="c1"># Coordinates transform</span>
        <span class="n">xycoords</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="n">xycoords</span><span class="p">)</span>
        <span class="n">xycoords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_</span><span class="p">(</span><span class="n">xycoords</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xycoords</span><span class="p">,</span> <span class="n">basestring</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="n">xycoords</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">]:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xycoords</span><span class="p">,</span> <span class="n">xyscaler</span><span class="o">=</span><span class="n">xyscaler</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">textcoords</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">textcoords</span> <span class="o">=</span> <span class="n">xycoords</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">textcoords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_</span><span class="p">(</span><span class="n">textcoords</span><span class="p">,</span> <span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">textcoords</span><span class="p">,</span> <span class="n">basestring</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="n">textcoords</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">]:</span>
            <span class="n">xtext</span><span class="p">,</span> <span class="n">ytext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xy</span><span class="p">(</span><span class="n">xtext</span><span class="p">,</span> <span class="n">ytext</span><span class="p">,</span> <span class="n">textcoords</span><span class="p">,</span> <span class="n">xyscaler</span><span class="o">=</span><span class="n">xyscaler</span><span class="p">)</span>

        <span class="c1"># Arrow properties</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arrowprops</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="n">arrowprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arrowprops</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">arrowprops</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">arrowprops</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">,</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span>

        <span class="c1"># Plot</span>
        <span class="k">if</span> <span class="n">strip</span><span class="p">:</span> <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">xtext</span><span class="p">,</span> <span class="n">ytext</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="n">text</span><span class="p">,</span>
            <span class="n">xycoords</span><span class="o">=</span><span class="n">xycoords</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="n">textcoords</span><span class="p">,</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_axobj</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Path effects</span>
        <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">obj</span></div>


<div class="viewcode-block" id="Plot.hlitvs"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.hlitvs">[docs]</a>    <span class="k">def</span> <span class="nf">hlitvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Highlight intervals with grey/white background alternance</span>

<span class="sd">        See :func:`~vacumm.misc.plot.hlitvs` for more information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">xy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="s1">&#39;yx&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span>
                <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;hlitvs&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">xy</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">cached</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">cached</span><span class="p">)</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">xy</span><span class="o">+</span><span class="s1">&#39;axis&#39;</span><span class="p">)</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;hlitvs&#39;</span><span class="p">,</span> <span class="n">hlitvs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">xy</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="Plot.hldays"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.hldays">[docs]</a>    <span class="k">def</span> <span class="nf">hldays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alias for :</span>

<span class="sd">            &gt;&gt;&gt; myplot.hlitv(units=&#39;day&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hlitvs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.ptitle"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.ptitle">[docs]</a>    <span class="k">def</span> <span class="nf">ptitle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a title to the plot</span>

<span class="sd">        .. note::</span>

<span class="sd">            No title is added to the plot if a title already exists</span>
<span class="sd">            and the specified title is guessed (not hard set).</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **title**: Title to add to plot.</span>

<span class="sd">                - A string: directly used.</span>
<span class="sd">                - ``True`` or ``None``: the :attr:`title` attribute is used.</span>
<span class="sd">                - ``False``: not title is plotted.</span>

<span class="sd">            - **force**, optional: If the title is already plotted,</span>
<span class="sd">              it is not overwritten, except if ``force is True``.</span>
<span class="sd">            - Other keywords are passed to :func:`matplotlib.pyplot.title`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
            <span class="n">isset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isset</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">isset</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">force</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">force</span> <span class="o">=</span> <span class="n">isset</span>
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">force</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span></div>

<div class="viewcode-block" id="Plot.legend"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.legend">[docs]</a>    <span class="k">def</span> <span class="nf">legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A simple call to the :meth:`matplotlib.axes.Axes.legend` method</span>

<span class="sd">        Arguments and keywords are passed to :meth:`~matplotlib.axes.Axes.legend`.</span>

<span class="sd">        Defaults values :</span>

<span class="sd">            - **loc**: ``&quot;best&quot;``</span>
<span class="sd">            - **shadow**: ``False``</span>
<span class="sd">            - **fancybox**: ``True``</span>
<span class="sd">            - **alpha** (applied to legend patch): ``0.5``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;loc&#39;</span><span class="p">,</span> <span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="c1">#        kwargs.setdefault(&#39;shadow&#39;, False)</span>
<span class="c1">#        kwargs.setdefault(&#39;fancybox&#39;, True)</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">zorder</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="c1">#        zorder = kwargs.pop(&#39;framealpha&#39;, alpha)</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">leg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">leg</span><span class="o">.</span><span class="n">legendPatch</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">leg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">zorder</span><span class="p">:</span>
                <span class="n">leg</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="n">zorder</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">leg</span></div>

    <span class="k">def</span> <span class="nf">_get_xykeys_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get possible keys for interval selections along X or Y&quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">xy</span><span class="p">]</span>
        <span class="n">ixy</span> <span class="o">=</span> <span class="s1">&#39;yx&#39;</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="n">ixy</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="n">ixy</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="n">ixy</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;z&#39;</span><span class="p">:</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="s1">&#39;dep&#39;</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="n">ixy</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;t&#39;</span><span class="p">:</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="n">ixy</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">keys</span>

    <span class="k">def</span> <span class="nf">_get_boxminmax_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">box</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get ``xmin,ymin,xmax,ymax`` from box specs</span>

<span class="sd">        Two cases:</span>

<span class="sd">        - ``box=xmin,ymin,xmax,ymax``</span>
<span class="sd">        - ``box=dict(x=(xmin,xmax),y=(xmin,xmax))`` or with for instance</span>
<span class="sd">          ``lon``, ``lat``, ``time`` depending on axis type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># Along X</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xykeys_</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">box</span><span class="p">:</span>
                    <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">box</span><span class="p">[</span><span class="n">key</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span>
            <span class="c1"># Along Y</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xykeys_</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">box</span><span class="p">:</span>
                    <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">box</span><span class="p">[</span><span class="n">key</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymax</span>
            <span class="n">box</span> <span class="o">=</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span>
        <span class="k">return</span> <span class="n">box</span>


<div class="viewcode-block" id="Plot.add_box"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_box">[docs]</a>    <span class="k">def</span> <span class="nf">add_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">box</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
            <span class="n">npts</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">xyscaler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a box to the plot using :meth:`matplotlib.pyplots.plot`</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **box**: Box limits in the forms ``[xmin,ymin,xmax,ymax]``</span>
<span class="sd">              ``dict(x=(xmin,xmax),y=(xmin,xmax)``.</span>
<span class="sd">            - **color**, optional: Line color of the box.</span>
<span class="sd">            - **npts**, optional: Number of points per side</span>
<span class="sd">              (useful with special map projections).</span>
<span class="sd">            - **shadow**, optional: Add a droped shadow below the box</span>
<span class="sd">              (see :func:`add_shadow`).</span>
<span class="sd">            - **shadow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :func:`add_shadow`.</span>
<span class="sd">            - **glow**, optional: Add a glow effect the box</span>
<span class="sd">              (see :func:`add_glow`).</span>
<span class="sd">            - **glow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :func:`add_glow`.</span>
<span class="sd">            - Other keywords are passed to :func:`matplotlib.pyplot.plot`.</span>

<span class="sd">        :See also: :func:`matplotlib.pyplot.plot`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Limits</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_boxminmax_</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Box limits should be a list in the form [xmin,ymin,xmax,ymax]&#39;</span>
                <span class="s1">&#39; or a dictionary in the form dict(x=(xmin,xmax),y=xmin,xmax): </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">box</span><span class="p">)</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">xmin</span><span class="p">)</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">ymin</span><span class="p">)</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">ymax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xyscaler</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;xyscaler&#39;</span><span class="p">):</span> <span class="n">xyscaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyscaler</span>
        <span class="k">if</span> <span class="n">xyscaler</span><span class="p">:</span>
            <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="n">xyscaler</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">)</span>
            <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">xyscaler</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>

        <span class="c1"># Params</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ec</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fill</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>
        <span class="n">kwsh</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="p">)</span>
        <span class="n">kwgl</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="p">)</span>
        <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwsh</span><span class="p">,</span> <span class="n">kwgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>

        <span class="c1"># Sides</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">npts</span><span class="p">),</span>
        <span class="n">X</span> <span class="o">+=</span> <span class="n">N</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">npts</span><span class="p">)[</span><span class="mi">1</span><span class="p">:],</span>
        <span class="n">X</span> <span class="o">+=</span> <span class="n">N</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">npts</span><span class="p">)[</span><span class="mi">1</span><span class="p">:],</span>
        <span class="n">X</span> <span class="o">+=</span> <span class="n">N</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">npts</span><span class="p">),</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">npts</span><span class="p">),</span>
        <span class="n">Y</span> <span class="o">+=</span> <span class="n">N</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">npts</span><span class="p">)[</span><span class="mi">1</span><span class="p">:],</span>
        <span class="n">Y</span> <span class="o">+=</span> <span class="n">N</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">npts</span><span class="p">)[</span><span class="mi">1</span><span class="p">:],</span>
        <span class="n">Y</span> <span class="o">+=</span> <span class="n">N</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">npts</span><span class="p">),</span>

        <span class="c1"># Plot</span>
        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">N</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">Y</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Effects</span>
        <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">o</span><span class="p">,</span><span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span>


        <span class="k">return</span> <span class="n">o</span></div>

<div class="viewcode-block" id="Plot.add_arrow"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_arrow">[docs]</a>    <span class="k">def</span> <span class="nf">add_arrow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">udata</span><span class="p">,</span> <span class="n">vdata</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiverkey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xyscaler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an arrow to the map using :func:`matplotlib.pyplot.quiver`</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **x,y**: Coordinates of the position of the tail</span>
<span class="sd">            - **udata**: X or radial component of arrows.</span>
<span class="sd">            - **vdata**: Y or directional component of arrows.</span>
<span class="sd">            - **polar**, optional: Consider polar coordinates: ``(u, v) -&gt; (rho, theta)``</span>
<span class="sd">            - **degrees**, optional: If True (default), trat ``theta`` as degrees, else radians.</span>
<span class="sd">            - **quiver_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :func:`matplotlib.pyplot.quiver`.</span>
<span class="sd">            - Other keywords are passed to :func:`matplotlib.pyplot.plot`.</span>

<span class="sd">        :See also: :func:`matplotlib.pyplot.scatter`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Data for arrows</span>
        <span class="n">udata</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">udata</span><span class="p">)</span>
        <span class="n">vdata</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vdata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">polar</span><span class="p">:</span>
            <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">udata</span><span class="p">,</span><span class="n">vdata</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">u</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span> <span class="k">if</span> <span class="n">degrees</span> <span class="k">else</span> <span class="n">v</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">MV2</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">MV2</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">angle</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">):</span>
                <span class="n">u</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">units</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">):</span>
                <span class="n">u</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;X component of &#39;</span><span class="o">+</span><span class="n">m</span><span class="o">.</span><span class="n">long_name</span>
                <span class="n">v</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;Y component of &#39;</span><span class="o">+</span><span class="n">m</span><span class="o">.</span><span class="n">long_name</span>
            <span class="c1"># Data</span>
            <span class="n">udata</span><span class="p">,</span> <span class="n">vdata</span> <span class="o">=</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span>

        <span class="c1"># Coordinates</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">atleast_1d</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">atleast_1d</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xyscaler</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;xyscaler&#39;</span><span class="p">):</span> <span class="n">xyscaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyscaler</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">xyscaler</span><span class="p">):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xyscaler</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="c1"># Params</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">)</span>
        <span class="n">kwqv</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;quiver&#39;</span><span class="p">)</span>
        <span class="n">kwqvk</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;quiverkey&#39;</span><span class="p">)</span>
        <span class="c1">#dict_copy_items(kwargs, [kwqv],&#39;anim&#39;)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">dict_merge</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">kwqv</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Color</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>

        <span class="c1"># Plot</span>
        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">udata</span><span class="p">,</span> <span class="n">vdata</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">quiverkey</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">quiverkey</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwqvk</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">o</span></div>


<div class="viewcode-block" id="Plot.quiverkey"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.quiverkey">[docs]</a>    <span class="k">def</span> <span class="nf">quiverkey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qv</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.02</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(value)g</span><span class="s1"> </span><span class="si">%(units)s</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latex_units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_mode</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a quiver key to the plot</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **qv**: Results of :func:`~matplotlib.pyplot.quiver`.</span>
<span class="sd">            - **value**: Numeric value for key (used by text).</span>
<span class="sd">            - **pos**, optional: Position of key for arrow .</span>
<span class="sd">            - **text**, optional: Text or format with variables &#39;value&#39; and &#39;units&#39;.</span>
<span class="sd">            - **units**, optional: Units for key (used by text).</span>
<span class="sd">            - **latex_units**, optional: Interpret units using latex.</span>
<span class="sd">            - Extra keywords are passed to :func:`~matplotlib.pyplot.quiverkey`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Value</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">get_quiverkey_value</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">value_mode</span><span class="p">)</span>

        <span class="c1"># Text</span>
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiverkey_units</span>
        <span class="k">elif</span> <span class="n">cdms2</span><span class="o">.</span><span class="n">isVariable</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="ow">and</span>  <span class="nb">hasattr</span><span class="p">(</span><span class="n">units</span><span class="p">,</span><span class="s1">&#39;units&#39;</span><span class="p">):</span>
            <span class="n">units</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">units</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">latex_units</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;tex&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">latex_units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">latex_units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_units</span>
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">latex_units</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_latex</span><span class="p">(</span><span class="n">units</span><span class="p">):</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;$</span><span class="si">%s</span><span class="s1">$&#39;</span><span class="o">%</span><span class="n">units</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span> <span class="o">%</span> <span class="nb">vars</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%(value)g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">value</span>

        <span class="c1"># Plot</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;loc&#39;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="n">qvk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">quiverkey</span><span class="p">(</span><span class="n">qv</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">value</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">qvk</span><span class="p">,</span> <span class="s1">&#39;quiverkey&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.get_quiverkey_units"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_quiverkey_units">[docs]</a>    <span class="k">def</span> <span class="nf">get_quiverkey_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`quiverkey_units`&quot;&quot;&quot;</span>
        <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;quiverkey_units&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Plot1D</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">isset</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">):</span>
            <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span>
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_units</span><span class="p">(</span><span class="n">idata</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">units</span></div>
<div class="viewcode-block" id="Plot.set_quiverkey_units"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_quiverkey_units">[docs]</a>    <span class="k">def</span> <span class="nf">set_quiverkey_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`quiverkey_units`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;quiverkey_units&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_quiverkey_units"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_quiverkey_units">[docs]</a>    <span class="k">def</span> <span class="nf">del_quiverkey_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`quiverkey_units`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_axobj</span><span class="p">(</span><span class="s1">&#39;quiverkey_units&#39;</span><span class="p">)</span></div>
    <span class="n">quiverkey_units</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_quiverkey_units</span><span class="p">,</span> <span class="n">set_quiverkey_units</span><span class="p">,</span>
        <span class="n">del_quiverkey_units</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Units used for quiverkey&quot;</span><span class="p">)</span>



<div class="viewcode-block" id="Plot.add_line"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_line">[docs]</a>    <span class="k">def</span> <span class="nf">add_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extents</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
        <span class="n">npts</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">xyscaler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a line to the plot using :meth:`matplotlib.pyplots.plot`</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **extents**: Extents in the forms ``[xmin,ymin,xmax,ymax]``</span>
<span class="sd">              ``dict(x=(xmin,xmax),y=xmin,xmax)``.</span>
<span class="sd">            - **color**, optional: Line color of the line.</span>
<span class="sd">            - **npts**, optional: Number of points per side</span>
<span class="sd">              (useful with special map projections).</span>
<span class="sd">            - **shadow**, optional: Add a droped shadow below the box</span>
<span class="sd">              (see :func:`add_shadow`).</span>
<span class="sd">            - **shadow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :func:`add_shadow`.</span>
<span class="sd">            - **glow**, optional: Add a glow effect the box</span>
<span class="sd">              (see :func:`add_glow`).</span>
<span class="sd">            - **glow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :func:`add_glow`.</span>
<span class="sd">            - Other keywords are passed to :func:`matplotlib.pyplot.plot`.</span>

<span class="sd">        :See also: :func:`matplotlib.pyplot.plot`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Positions</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_boxminmax_</span><span class="p">(</span><span class="n">extents</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Extents should be a list in the form [xmin,ymin,xmax,ymax]&#39;</span>
                <span class="s1">&#39; or a dictionary in the form dict(x=(xmin,xmax),y=xmin,xmax): </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">extents</span><span class="p">)</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">xmin</span><span class="p">)</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">ymin</span><span class="p">)</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">ymax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xyscaler</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;xyscaler&#39;</span><span class="p">):</span> <span class="n">xyscaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyscaler</span>
        <span class="k">if</span> <span class="n">xyscaler</span><span class="p">:</span>
            <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="n">xyscaler</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">)</span>
            <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">xyscaler</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>

        <span class="c1"># Params</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">)</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>
        <span class="n">kwsh</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="p">)</span>
        <span class="n">kwgl</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="p">)</span>
        <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwsh</span><span class="p">,</span> <span class="n">kwgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>

        <span class="c1"># Sides</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>

        <span class="c1"># Plot</span>
        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Effects</span>
        <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">o</span></div>

<div class="viewcode-block" id="Plot.add_point"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_point">[docs]</a>    <span class="k">def</span> <span class="nf">add_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xyscaler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a point to the map using :meth:`matplotlib.pyplots.plot`</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **x,y**: Coordinates.</span>
<span class="sd">            - **color**, optional: Line color of the point.</span>
<span class="sd">            - **shadow**, optional: Add a droped shadow below the box</span>
<span class="sd">              (see :func:`add_shadow`).</span>
<span class="sd">            - **shadow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed</span>
<span class="sd">              to :func:`add_shadow`.</span>
<span class="sd">            - **glow**, optional: Add a glow effect the box</span>
<span class="sd">              (see :func:`add_glow`).</span>
<span class="sd">            - **glow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :func:`add_glow`.</span>
<span class="sd">            - Other keywords are passed to :func:`matplotlib.pyplot.plot`.</span>

<span class="sd">        :See also: :func:`matplotlib.pyplot.scatter`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Coordinates</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">atleast_1d</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">_asnum_</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">atleast_1d</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xyscaler</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;xyscaler&#39;</span><span class="p">):</span> <span class="n">xyscaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyscaler</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">xyscaler</span><span class="p">):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xyscaler</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="c1"># Params</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">)</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>
        <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwsh</span><span class="p">,</span> <span class="n">kwgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
        <span class="c1">#kwsh.setdefault(&#39;zorder&#39;, zorder-0.01)</span>
        <span class="c1">#kwgl.setdefault(&#39;zorder&#39;, zorder-0.01)</span>

        <span class="c1"># Plot</span>
        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Effects</span>
        <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">o</span></div>

<div class="viewcode-block" id="Plot.add_place"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_place">[docs]</a>    <span class="k">def</span> <span class="nf">add_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
            <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">text_offset</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Place a point using :meth:`add_point` and a label using :meth:`add_text`</span>

<span class="sd">        :Examples:</span>

<span class="sd">            &gt;&gt;&gt; m = map2(sst, show=False)</span>
<span class="sd">            &gt;&gt;&gt; m.add_place(-5, 44, &#39;Buoy 654&#39;, text_offset=(20,0), text_ha=&#39;left&#39;,</span>
<span class="sd">                text_color=&#39;b&#39;, point_size=100, shadow=True)</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **x/y**: Coordinates of the place in data units.</span>
<span class="sd">            - **text**: Name of the place.</span>
<span class="sd">            - **text_offset**, optional: Offset of the text in points with relative to</span>
<span class="sd">              coordinates.</span>
<span class="sd">            - **point_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :meth:`add_point`.</span>
<span class="sd">            - **text_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :meth:`add_text`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwpoint</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;point_&#39;</span><span class="p">)</span>
        <span class="n">kwtext</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;text_&#39;</span><span class="p">)</span>
        <span class="n">kwcom</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="n">shadow</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="n">glow</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">dict_check_defaults</span><span class="p">(</span><span class="n">kwpoint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwcom</span><span class="p">)</span>
        <span class="n">dict_check_defaults</span><span class="p">(</span><span class="n">kwtext</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="n">ha</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="n">va</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwcom</span><span class="p">)</span>
        <span class="n">tha</span> <span class="o">=</span> <span class="n">kwtext</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span>
        <span class="n">tva</span> <span class="o">=</span> <span class="n">kwtext</span><span class="p">[</span><span class="s1">&#39;va&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tha</span><span class="o">==</span><span class="s1">&#39;auto&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">text_offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">tha</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
            <span class="k">elif</span> <span class="n">text_offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">tha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tha</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
        <span class="k">if</span> <span class="n">tva</span><span class="o">==</span><span class="s1">&#39;auto&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">text_offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">tva</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
            <span class="k">elif</span> <span class="n">text_offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">tva</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tva</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
        <span class="n">kwtext</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tha</span>
        <span class="n">kwtext</span><span class="p">[</span><span class="s1">&#39;va&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tva</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwpoint</span><span class="p">)</span>
        <span class="n">kwtext</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transoffset</span><span class="p">(</span><span class="o">*</span><span class="n">text_offset</span><span class="p">))</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwtext</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">t</span></div>


<div class="viewcode-block" id="Plot.add_lines"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_lines">[docs]</a>    <span class="k">def</span> <span class="nf">add_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
        <span class="n">xyscaler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add lines to the plot using :meth:`matplotlib.axes.Axes.plot`</span>

<span class="sd">        :Params:</span>


<span class="sd">            - **xx/yy**: Coordinates (in degrees).</span>
<span class="sd">            - **color**, optional: Line color of the line.</span>
<span class="sd">            - **closed**, optional: Close the lines to form a polygon.</span>
<span class="sd">            - **shadow**, optional: Add a droped shadow below the box</span>
<span class="sd">              (see :func:`add_shadow`).</span>
<span class="sd">            - **shadow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :func:`add_shadow`.</span>
<span class="sd">            - **glow**, optional: Add a glow effect the box</span>
<span class="sd">              (see :func:`add_glow`).</span>
<span class="sd">            - **glow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :func:`add_glow`.</span>
<span class="sd">            - Other keywords are passed to :func:`matplotlib.pyplot.plot`.</span>

<span class="sd">        :See also: :func:`matplotlib.pyplot.plot`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Positions</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">_asnum_</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">atleast_1d</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">_asnum_</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span> <span class="n">atleast_1d</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">xx</span><span class="o">.</span><span class="n">size</span><span class="o">!=</span><span class="n">yy</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;xx and yy must have the same number of elements (</span><span class="si">%i</span><span class="s1">!=</span><span class="si">%i</span><span class="s1">)&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="n">yy</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">xyscaler</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;xyscaler&#39;</span><span class="p">):</span> <span class="n">xyscaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyscaler</span>
        <span class="k">if</span> <span class="n">xyscaler</span><span class="p">:</span>
            <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">xyscaler</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>

        <span class="c1"># Params</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">)</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>
        <span class="n">kwsh</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="p">)</span>
        <span class="n">kwgl</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="p">)</span>
        <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwsh</span><span class="p">,</span> <span class="n">kwgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>

        <span class="c1"># Plot</span>
        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Effects</span>
        <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">o</span></div>


<div class="viewcode-block" id="Plot.add_glow"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_glow">[docs]</a>    <span class="k">def</span> <span class="nf">add_glow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">,</span> <span class="n">gtypes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add glow effect to objects</span>

<span class="sd">        :See: :func:`add_glow`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="n">anim</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;anim&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">add_glow</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">gtypes</span><span class="p">,</span> <span class="n">anim</span><span class="o">=</span><span class="n">anim</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.add_shadow"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.add_shadow">[docs]</a>    <span class="k">def</span> <span class="nf">add_shadow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">,</span> <span class="n">gtypes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add shadow to objects</span>

<span class="sd">        :See: :func:`add_shadow`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="n">anim</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;anim&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">gtypes</span><span class="p">,</span> <span class="n">anim</span><span class="o">=</span><span class="n">anim</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.savefig"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.savefig">[docs]</a>    <span class="k">def</span> <span class="nf">savefig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figfile</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the figure to a file</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **figfile**: Figure file name. Also accepts</span>
<span class="sd">              :class:`~vacumm.misc.remote.OutputWorkFile`.</span>
<span class="sd">            - **verbose**, optional: Informs about file name when written.</span>
<span class="sd">            - **mkdir**, optional: Make figure directory if it does not exists.</span>
<span class="sd">            - Other keywords are passed to :func:`matplotlib.pyplot.savefig`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">figfile</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># List of files</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figfile</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">oo</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="n">figfile</span><span class="p">:</span>
                <span class="n">oo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="n">mkdir</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">oo</span>

        <span class="c1"># Remote output file</span>
        <span class="n">rem</span> <span class="o">=</span> <span class="n">figfile</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figfile</span><span class="p">,</span> <span class="n">OutputWorkFile</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">rem</span><span class="p">:</span> <span class="n">figfile</span> <span class="o">=</span> <span class="n">figfile</span><span class="o">.</span><span class="n">local_file</span>

        <span class="c1"># Extension</span>
        <span class="n">backend</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">ext_standalone</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ps&#39;</span><span class="p">,</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span><span class="s1">&#39;svg&#39;</span><span class="p">]</span>
        <span class="n">ext_others</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="s1">&#39;gif&#39;</span><span class="p">,</span><span class="s1">&#39;jpg&#39;</span><span class="p">,</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="s1">&#39;bmp&#39;</span><span class="p">]</span>
        <span class="n">basename</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">figfile</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span>
            <span class="n">figfile</span> <span class="o">+=</span> <span class="s1">&#39;.png&#39;</span>
        <span class="k">elif</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.py&quot;</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span>
            <span class="n">figfile</span> <span class="o">=</span> <span class="n">basename</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rem</span> <span class="ow">and</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ext_others</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ext_standalone</span> <span class="ow">and</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ext_standalone</span><span class="p">:</span>
                <span class="n">figfile</span> <span class="o">+=</span> <span class="s1">&#39;.png&#39;</span>
            <span class="k">elif</span> <span class="n">backend</span> <span class="ow">in</span> <span class="n">ext_standalone</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endwith</span><span class="p">(</span><span class="n">backend</span><span class="p">):</span>
                <span class="n">figfile</span> <span class="o">+=</span> <span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">backend</span>

        <span class="c1"># Directory</span>
        <span class="n">figdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">figfile</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mkdir</span> <span class="ow">and</span> <span class="n">figdir</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">figdir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">figdir</span><span class="p">)</span>

        <span class="c1"># Save</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figfile</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;Saved plot to &#39;</span><span class="o">+</span><span class="n">figfile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_figfile</span> <span class="o">=</span> <span class="n">figfile</span>

        <span class="c1"># Transfer</span>
        <span class="k">if</span> <span class="n">rem</span><span class="p">:</span> <span class="n">rem</span><span class="o">.</span><span class="n">put</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">figfile</span></div>

<div class="viewcode-block" id="Plot.savefigs"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.savefigs">[docs]</a>    <span class="k">def</span> <span class="nf">savefigs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figfile</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save a figure to png (and optionaly) pdf files using :func:`~vacumm.misc.plot.savefigs`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">figfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="kn">from</span> <span class="nn">vacumm.misc.plot</span> <span class="k">import</span> <span class="n">savefigs</span>
        <span class="n">savefigs</span><span class="p">(</span><span class="n">figfile</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.show"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show the current figure</span>

<span class="sd">        If the backend does not allow showing the figure using</span>
<span class="sd">        :func:`matplotlib.pyplot.show`, it uses an external viewer</span>
<span class="sd">        after saving the figure to a temporary file using</span>
<span class="sd">        :func:`matplotlib.pyplot.savefig`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwanim</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;anim_&#39;</span><span class="p">)</span>
        <span class="n">viewers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;pdf&#39;</span><span class="p">:[</span><span class="s1">&#39;/usr/bin/kghostview&#39;</span><span class="p">,</span>
                <span class="s1">&#39;/usr/bin/evince&#39;</span><span class="p">,</span>
                <span class="s1">&#39;/usr/bin/xpdf&#39;</span><span class="p">,</span>
                <span class="s1">&#39;/usr/local/bin/acroread&#39;</span><span class="p">],</span>
            <span class="s1">&#39;ps&#39;</span><span class="p">:[</span><span class="s1">&#39;/usr/bin/kghostview&#39;</span><span class="p">,</span>
                <span class="s1">&#39;/usr/bin/evince&#39;</span><span class="p">,</span>
                <span class="s1">&#39;/usr/bin/ghostview&#39;</span><span class="p">],</span>
            <span class="s1">&#39;svg&#39;</span><span class="p">:[</span><span class="s1">&#39;/usr/bin/svgdisplay&#39;</span><span class="p">,</span>
                <span class="s1">&#39;/usr/bin/konqueror&#39;</span><span class="p">]}</span>
        <span class="n">backend</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">backend</span> <span class="ow">in</span> <span class="n">viewers</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tmpfig</span> <span class="o">=</span> <span class="n">mktemp</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">backend</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">tmpfig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tmpfig</span> <span class="o">=</span> <span class="n">savefig</span>
            <span class="k">for</span> <span class="n">viewer</span> <span class="ow">in</span> <span class="n">viewers</span><span class="p">[</span><span class="n">backend</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">viewer</span><span class="p">):</span>
                    <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">viewer</span><span class="p">,</span><span class="n">tmpfig</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Unable to view file with command: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cmd</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmpfig</span><span class="p">)</span>
                    <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Animation</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">anim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">dict_check_defaults</span><span class="p">(</span><span class="n">kwanim</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">repeat_delay</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">animator</span><span class="o">.</span><span class="n">make_animation</span><span class="p">(</span><span class="o">**</span><span class="n">kwanim</span><span class="p">)</span>

            <span class="c1"># Show</span>
            <span class="n">P</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="Plot.has_data"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.has_data">[docs]</a>    <span class="k">def</span> <span class="nf">has_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Guess if object has data&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Plot.has_valid_data"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.has_valid_data">[docs]</a>    <span class="k">def</span> <span class="nf">has_valid_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Guess if object has unmasked data&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked</span></div>

    <span class="c1"># Some properties</span>

<div class="viewcode-block" id="Plot.get_anim"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_anim">[docs]</a>    <span class="k">def</span> <span class="nf">get_anim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the :attr:`anim` attribute`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_anim&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.set_anim"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_anim">[docs]</a>    <span class="k">def</span> <span class="nf">set_anim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">anim</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the :attr:`anim` attribute`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_anim</span> <span class="o">=</span> <span class="n">anim</span></div>
    <span class="n">anim</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_anim</span><span class="p">,</span> <span class="n">set_anim</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Is each plot saved for final animation?&quot;&quot;&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_animator"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_animator">[docs]</a>    <span class="k">def</span> <span class="nf">get_animator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the current :class:`Animator` instance or None&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">anim</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_animator&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;_vacumm_animator&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">_vacumm_animator</span> <span class="o">=</span> <span class="n">Animator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_animator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">_vacumm_animator</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_animator</span></div>
<div class="viewcode-block" id="Plot.set_animator"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_animator">[docs]</a>    <span class="k">def</span> <span class="nf">set_animator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">animator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the current :class:`Animator` instance&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_animator</span> <span class="o">=</span> <span class="n">animator</span></div>
    <span class="n">animator</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_animator</span><span class="p">,</span> <span class="n">set_animator</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Current :class:`Animator` instance or None&quot;&quot;&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.animator_append"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.animator_append">[docs]</a>    <span class="k">def</span> <span class="nf">animator_append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">anim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append an object to current :class:`Animator`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">anim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">anim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anim</span>
        <span class="k">if</span> <span class="n">anim</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">anim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">animator</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">anim</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">anim</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">anim</span> <span class="o">=</span> <span class="n">anim</span>
        <span class="k">return</span> <span class="n">anim</span></div>

<div class="viewcode-block" id="Plot.register_obj"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.register_obj">[docs]</a>    <span class="k">def</span> <span class="nf">register_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">gtypes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">anim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Register an object with :meth:`add_obj` and :meth:`animator_append`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">gtypes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gtypes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gtypes</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">gtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">gtypes</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;plotted&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gtypes</span><span class="p">:</span>
            <span class="n">gtypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;plotted&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_obj</span><span class="p">(</span><span class="n">gtypes</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animator_append</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">anim</span><span class="o">=</span><span class="n">anim</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span></div>


<div class="viewcode-block" id="Plot.get_uvlat"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_uvlat">[docs]</a>    <span class="k">def</span> <span class="nf">get_uvlat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">45.</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`uvlat`</span>

<span class="sd">        If a latitude axis is available on X or Y plot axis,</span>
<span class="sd">        its mean value is used, else it defaults to ``default``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;uvlat&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;y&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[:]][</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">lat</span> <span class="k">if</span> <span class="n">lat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">default</span></div>
<div class="viewcode-block" id="Plot.set_uvlat"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_uvlat">[docs]</a>    <span class="k">def</span> <span class="nf">set_uvlat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`uvlat`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_uvlat"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_uvlat">[docs]</a>    <span class="k">def</span> <span class="nf">del_uvlat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`uvlat`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;uvlat&#39;</span><span class="p">)</span></div>
    <span class="n">uvlat</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_uvlat</span><span class="p">,</span> <span class="n">set_uvlat</span><span class="p">,</span> <span class="n">del_uvlat</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Latitude used for guessing :attr:`uvscaler`&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_uvscaler"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_uvscaler">[docs]</a>    <span class="k">def</span> <span class="nf">get_uvscaler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`uvscaler`</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **guess**, optional: Guess scaler from axis types</span>
<span class="sd">              and data units if not specified.</span>
<span class="sd">            - **lat**, optional: Latitude value passed to</span>
<span class="sd">              :meth:`get_metric_scale` to guess plot axis metric scale.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">uvscaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;uvscaler&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">uvscaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uvscaler_</span><span class="p">(</span><span class="n">uvscaler</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">guess</span><span class="p">:</span> <span class="k">return</span>

        <span class="c1"># Skip data mode</span>
        <span class="k">if</span> <span class="s1">&#39;d&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">:</span> <span class="k">return</span>

        <span class="c1"># Guess</span>
        <span class="k">if</span> <span class="n">uvscaler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="c1"># Latitude</span>
            <span class="k">if</span> <span class="n">lat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">uvlat</span> <span class="o">=</span> <span class="n">lat</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uvlat</span>

            <span class="c1"># Along X</span>
            <span class="n">xmscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_scale</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xmscale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
            <span class="n">uunits</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span>  <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">uunits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
            <span class="n">umscale</span> <span class="o">=</span> <span class="n">tometric</span><span class="p">(</span><span class="n">uunits</span><span class="p">,</span> <span class="n">munits</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">umscale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>

            <span class="c1"># Along Y</span>
            <span class="n">ymscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_scale</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ymscale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
            <span class="n">vunits</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span>  <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vunits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
            <span class="n">vmscale</span> <span class="o">=</span> <span class="n">tometric</span><span class="p">(</span><span class="n">vunits</span><span class="p">,</span> <span class="n">munits</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vmscale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>

            <span class="c1"># Scale</span>
            <span class="n">uvscaler</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmscale</span><span class="o">*</span><span class="n">xmscale</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[:]</span><span class="o">.</span><span class="n">ptp</span><span class="p">())</span><span class="o">/</span><span class="p">(</span><span class="n">umscale</span><span class="o">*</span><span class="n">ymscale</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[:]</span><span class="o">.</span><span class="n">ptp</span><span class="p">())</span>

        <span class="c1"># Parse</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uvscaler</span> <span class="o">=</span> <span class="n">uvscaler</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uvscaler_</span><span class="p">(</span><span class="n">uvscaler</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_uvscaler_</span><span class="p">(</span><span class="n">uvscaler</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">uvscaler</span><span class="p">):</span> <span class="k">return</span> <span class="n">uvscaler</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">uvscaler</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span>
            <span class="n">_</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">uvscaler</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">uvscaler</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">raw</span><span class="p">:</span> <span class="k">return</span> <span class="n">uvscaler</span>
            <span class="n">uvscaler</span> <span class="o">=</span> <span class="n">_</span>
        <span class="k">if</span> <span class="n">N</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">uvscaler</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">raw</span><span class="p">:</span> <span class="k">return</span> <span class="n">uvscaler</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uvscaler</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;uvscaler must be a callable, a scalar or a&quot;</span><span class="o">+</span>
            <span class="s2">&quot; 2-element tuple or list&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.set_uvscaler"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_uvscaler">[docs]</a>    <span class="k">def</span> <span class="nf">set_uvscaler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uvscaler</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`uvscaler`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_uvscaler_</span><span class="p">(</span><span class="n">uvscaler</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;uvscaler&#39;</span><span class="p">,</span> <span class="n">uvscaler</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_uvscaler"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_uvscaler">[docs]</a>    <span class="k">def</span> <span class="nf">del_uvscaler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`uvscaler`&quot;&quot;&quot;</span></div>
    <span class="n">uvscaler</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_uvscaler</span><span class="p">,</span> <span class="n">set_uvscaler</span><span class="p">,</span>
        <span class="n">del_uvscaler</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Function to rescale U anv V data along X and Y axes.</span>
<span class="s2">            ``None`` is returned if no scaling is possible.</span>

<span class="s2">            :Example:</span>

<span class="s2">                &gt;&gt;&gt; uvscaler = myplot.uvscaler</span>
<span class="s2">                &gt;&gt;&gt; if uvscaler is not None:</span>
<span class="s2">                    ... u2,v2 = myplot.uvscaler(u, v)</span>

<span class="s2">            :Return: A callable function or ``None`` if no scaling is possible</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>



<div class="viewcode-block" id="Plot.get_metric_scale"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_metric_scale">[docs]</a>    <span class="k">def</span> <span class="nf">get_metric_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get units of X or Y plot axis as meters if possible</span>

<span class="sd">        Longitude and latitude coordinates are converted using</span>
<span class="sd">        :func:`~vacumm.phys.units.deg2m`.</span>
<span class="sd">        else :func:`~vacumm.misc.phys.units.tometric` is used</span>
<span class="sd">        using axis units.</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **xy**: Plot axis type (``&quot;x&quot;``, ``&quot;y&quot;``...).</span>
<span class="sd">            - **lat**, optional: Latitude for degrees to meter conversion</span>
<span class="sd">              of longitude coordinates. It default to :attr:`uvlat`.</span>

<span class="sd">        :Return:</span>

<span class="sd">            - ``None`` if conversion of possible, else a float value.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># X or Y plot axis</span>
        <span class="k">if</span> <span class="n">xy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]:</span> <span class="k">return</span>

        <span class="c1"># From order type</span>
        <span class="n">axtype</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="o">+</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axtype</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">lat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">uvlat</span> <span class="o">=</span> <span class="n">lat</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uvlat</span>
            <span class="k">return</span> <span class="n">deg2m</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axtype</span><span class="o">==</span><span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">deg2m</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
        <span class="n">units</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="o">+</span><span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axtype</span><span class="o">!=</span><span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="k">return</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
        <span class="c1">#if units.startswith(&#39;deg&#39;):</span>
            <span class="c1">#if getattr(self, xy+&#39;type&#39;)==&#39;x&#39;:</span>
                <span class="c1">#return deg2m(1., lat=lat)</span>
            <span class="c1">#if getattr(self, xy+&#39;type&#39;)==&#39;y&#39;:</span>
                <span class="c1">#return deg2m(1.)</span>
        <span class="k">return</span> <span class="n">tometric</span><span class="p">(</span><span class="n">units</span><span class="p">,</span>  <span class="n">munits</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.get_vmin"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_vmin">[docs]</a>    <span class="k">def</span> <span class="nf">get_vmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`vmin`&quot;&quot;&quot;</span>
        <span class="n">gmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;vmin&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">gmin</span>
<span class="c1">#        if not self.has_data(): return</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span> <span class="c1"># All components (m,u,v)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_valid_data</span><span class="p">():</span>
                <span class="n">vmins</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vmins</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">glob</span><span class="p">:</span> <span class="c1"># Of all plotters</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brothers</span><span class="p">(</span><span class="n">notme</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get_min</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">vmins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">vmins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="n">vmins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># Selected component</span>
            <span class="n">vmins</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_valid_data</span><span class="p">()</span> <span class="k">else</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">glob</span><span class="p">:</span> <span class="c1"># Of all plotters</span>
                <span class="n">vmins</span> <span class="o">=</span> <span class="n">vmins</span><span class="o">+</span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">get_min</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brothers</span><span class="p">(</span><span class="n">notme</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
            <span class="n">vmins</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vmins</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
            <span class="n">vmins</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">vmins</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vmins</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">vmins</span></div>
<div class="viewcode-block" id="Plot.set_vmin"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_vmin">[docs]</a>    <span class="k">def</span> <span class="nf">set_vmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`vmin`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;vmin&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_vmin"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_vmin">[docs]</a>    <span class="k">def</span> <span class="nf">del_vmin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`vmin`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;vmin&#39;</span><span class="p">)</span></div>
    <span class="n">vmin</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_vmin</span><span class="p">,</span> <span class="n">set_vmin</span><span class="p">,</span> <span class="n">del_vmin</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Data min to use for plot&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_vmax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_vmax">[docs]</a>    <span class="k">def</span> <span class="nf">get_vmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`vmax`&quot;&quot;&quot;</span>
        <span class="n">gmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;vmax&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">gmax</span>
<span class="c1">#        if not self.has_data(): return</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span> <span class="c1"># All components (m,u,v)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span>
                <span class="n">maxs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">maxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">glob</span><span class="p">:</span> <span class="c1"># Of all plotters</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brothers</span><span class="p">(</span><span class="n">notme</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get_max</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">vmaxs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">vmaxs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="n">vmaxs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># Selected component</span>
            <span class="n">vmaxs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_valid_data</span><span class="p">()</span> <span class="k">else</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">glob</span><span class="p">:</span> <span class="c1"># Of all plotters</span>
                <span class="n">vmaxs</span> <span class="o">=</span> <span class="n">vmaxs</span><span class="o">+</span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">get_max</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brothers</span><span class="p">(</span><span class="n">notme</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
            <span class="n">vmaxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vmaxs</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
            <span class="n">vmaxs</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">vmaxs</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vmaxs</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">vmaxs</span></div>
<div class="viewcode-block" id="Plot.set_vmax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_vmax">[docs]</a>    <span class="k">def</span> <span class="nf">set_vmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`vmax`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;vmax&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_vmax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_vmax">[docs]</a>    <span class="k">def</span> <span class="nf">del_vmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`vmax`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;vmax&#39;</span><span class="p">)</span></div>
    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_vmax</span><span class="p">,</span> <span class="n">set_vmax</span><span class="p">,</span> <span class="n">del_vmax</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Data max to use for plot&quot;</span><span class="p">)</span>




    <span class="c1"># X/Y MASKED</span>

<div class="viewcode-block" id="Plot.get_xymasked"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_xymasked">[docs]</a>    <span class="k">def</span> <span class="nf">get_xymasked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`xymasked`&quot;&quot;&quot;</span>
        <span class="n">gmasked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;xymasked&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gmasked</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">gmasked</span></div>
<div class="viewcode-block" id="Plot.set_xymasked"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_xymasked">[docs]</a>    <span class="k">def</span> <span class="nf">set_xymasked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`xymasked`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;xymasked&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_xymasked"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_xymasked">[docs]</a>    <span class="k">def</span> <span class="nf">del_xymasked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`xymasked`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;xymasked&#39;</span><span class="p">)</span></div>
    <span class="n">xymasked</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xymasked</span><span class="p">,</span> <span class="n">set_xymasked</span><span class="p">,</span> <span class="n">del_xymasked</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Whether X and Y data are not considered if no data at these coordinates&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="Plot.get_xmasked"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_xmasked">[docs]</a>    <span class="k">def</span> <span class="nf">get_xmasked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`xmasked`&quot;&quot;&quot;</span>
        <span class="n">gmasked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;xmasked&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gmasked</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">gmasked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xymasked</span>
        <span class="k">return</span> <span class="n">gmasked</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">gmasked</span></div>
<div class="viewcode-block" id="Plot.set_xmasked"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_xmasked">[docs]</a>    <span class="k">def</span> <span class="nf">set_xmasked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`xmasked`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;xmasked&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_xmasked"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_xmasked">[docs]</a>    <span class="k">def</span> <span class="nf">del_xmasked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`xmasked`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;xmasked&#39;</span><span class="p">)</span></div>
    <span class="n">xmasked</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xmasked</span><span class="p">,</span> <span class="n">set_xmasked</span><span class="p">,</span> <span class="n">del_xmasked</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Whether X data are not considered if no data at these coordinates&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="Plot.get_ymasked"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_ymasked">[docs]</a>    <span class="k">def</span> <span class="nf">get_ymasked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`ymasked`&quot;&quot;&quot;</span>
        <span class="n">gmasked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;ymasked&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gmasked</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">gmasked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xymasked</span>
        <span class="k">return</span> <span class="n">gmasked</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">gmasked</span></div>
<div class="viewcode-block" id="Plot.set_ymasked"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_ymasked">[docs]</a>    <span class="k">def</span> <span class="nf">set_ymasked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`ymasked`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;ymasked&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_ymasked"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_ymasked">[docs]</a>    <span class="k">def</span> <span class="nf">del_ymasked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`ymasked`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;ymasked&#39;</span><span class="p">)</span></div>
    <span class="n">ymasked</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_ymasked</span><span class="p">,</span> <span class="n">set_ymasked</span><span class="p">,</span> <span class="n">del_ymasked</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Whether X data are not considered if no data at these coordinates&quot;</span><span class="p">)</span>

    <span class="c1"># X MIN/MAX</span>

<div class="viewcode-block" id="Plot.get_xmin"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_xmin">[docs]</a>    <span class="k">def</span> <span class="nf">get_xmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`xmin`&quot;&quot;&quot;</span>
        <span class="n">gmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;xmin&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">gmin</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span> <span class="n">masked</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">masked</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">masked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmasked</span>
<span class="c1">#        if not self.has_data(): return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vmin</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
                <span class="n">xmin</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="n">masked</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span>
                    <span class="n">xmin</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="n">masked</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">glob</span><span class="p">:</span>
            <span class="n">xmins</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">xmin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="n">xmin</span><span class="p">]</span>
            <span class="n">xmins</span> <span class="o">+=</span> <span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">get_xmin</span><span class="p">(</span><span class="n">glob</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="n">masked</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brothers</span><span class="p">(</span><span class="n">notme</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
            <span class="n">xmins</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">xmins</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xmins</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xmins</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">xmin</span></div>
<div class="viewcode-block" id="Plot.set_xmin"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_xmin">[docs]</a>    <span class="k">def</span> <span class="nf">set_xmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`xmin`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;xmin&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_xmin"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_xmin">[docs]</a>    <span class="k">def</span> <span class="nf">del_xmin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`xmin`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_axobj</span><span class="p">(</span><span class="s1">&#39;xmin&#39;</span><span class="p">)</span></div>
    <span class="n">xmin</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xmin</span><span class="p">,</span> <span class="n">set_xmin</span><span class="p">,</span> <span class="n">del_xmin</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Min of X axis to use for plot&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_xmax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_xmax">[docs]</a>    <span class="k">def</span> <span class="nf">get_xmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`xmax`&quot;&quot;&quot;</span>
        <span class="n">gmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;xmax&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">gmax</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span> <span class="n">masked</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">masked</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">masked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmasked</span>
<span class="c1">#        if not self.has_data(): return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vmax</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
                <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="n">masked</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span>
                    <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="n">masked</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">glob</span><span class="p">:</span>
            <span class="n">xmaxs</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">xmax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="n">xmax</span><span class="p">]</span>
            <span class="n">xmaxs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">get_xmax</span><span class="p">(</span><span class="n">glob</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="n">masked</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brothers</span><span class="p">(</span><span class="n">notme</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
            <span class="n">xmaxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">xmaxs</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xmaxs</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xmaxs</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">xmax</span></div>
<div class="viewcode-block" id="Plot.set_xmax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_xmax">[docs]</a>    <span class="k">def</span> <span class="nf">set_xmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`xmax`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;xmax&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_xmax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_xmax">[docs]</a>    <span class="k">def</span> <span class="nf">del_xmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`xmax`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_axobj</span><span class="p">(</span><span class="s1">&#39;xmax&#39;</span><span class="p">)</span></div>
    <span class="n">xmax</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xmax</span><span class="p">,</span> <span class="n">set_xmax</span><span class="p">,</span> <span class="n">del_xmax</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Max of X axis to use for plot&quot;</span><span class="p">)</span>

    <span class="c1"># Y MIN/XMAX</span>

<div class="viewcode-block" id="Plot.get_ymin"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_ymin">[docs]</a>    <span class="k">def</span> <span class="nf">get_ymin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`ymin`&quot;&quot;&quot;</span>
        <span class="n">gmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;ymin&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">gmin</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span> <span class="n">masked</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">masked</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">masked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymasked</span>
<span class="c1">#        if not self.has_data(): return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vmin</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
                <span class="n">ymin</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="n">masked</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span>
                    <span class="n">ymin</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ymin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="n">masked</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ymin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">glob</span><span class="p">:</span>
            <span class="n">ymins</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">ymin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="n">ymin</span><span class="p">]</span>
            <span class="n">ymins</span> <span class="o">+=</span> <span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">get_ymin</span><span class="p">(</span><span class="n">glob</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="n">masked</span><span class="o">=</span><span class="n">masked</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brothers</span><span class="p">(</span><span class="n">notme</span><span class="o">=</span><span class="kc">True</span><span class="p">,)]</span>
            <span class="n">ymins</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ymins</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ymins</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ymins</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">ymin</span></div>
<div class="viewcode-block" id="Plot.set_ymin"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_ymin">[docs]</a>    <span class="k">def</span> <span class="nf">set_ymin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`ymin`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;ymin&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_ymin"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_ymin">[docs]</a>    <span class="k">def</span> <span class="nf">del_ymin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`ymin`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_axobj</span><span class="p">(</span><span class="s1">&#39;ymin&#39;</span><span class="p">)</span></div>
    <span class="n">ymin</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_ymin</span><span class="p">,</span> <span class="n">set_ymin</span><span class="p">,</span> <span class="n">del_ymin</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Min of Y axis to use for plot&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_ymax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_ymax">[docs]</a>    <span class="k">def</span> <span class="nf">get_ymax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`ymax`&quot;&quot;&quot;</span>
        <span class="n">gmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;ymax&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">gmax</span>
        <span class="k">if</span> <span class="n">masked</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">masked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymasked</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span> <span class="n">masked</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1">#        if not self.has_data(): return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vmax</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="n">masked</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span>
                    <span class="n">ymax</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="n">masked</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">glob</span><span class="p">:</span>
            <span class="n">ymaxs</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">ymax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="n">ymax</span><span class="p">]</span>
            <span class="n">ymaxs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">get_ymax</span><span class="p">(</span><span class="n">glob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brothers</span><span class="p">(</span><span class="n">notme</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
            <span class="n">ymaxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ymaxs</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ymaxs</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ymaxs</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">ymaxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ymax</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">get_ymax</span><span class="p">(</span><span class="n">glob</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="n">masked</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brothers</span><span class="p">(</span><span class="n">notme</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
            <span class="n">ymaxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ymaxs</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ymaxs</span><span class="p">)</span> <span class="k">if</span> <span class="n">ymaxs</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">ymax</span></div>
<div class="viewcode-block" id="Plot.set_ymax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_ymax">[docs]</a>    <span class="k">def</span> <span class="nf">set_ymax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`ymax`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;ymax&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_ymax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_ymax">[docs]</a>    <span class="k">def</span> <span class="nf">del_ymax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`ymax`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_axobj</span><span class="p">(</span><span class="s1">&#39;ymax&#39;</span><span class="p">)</span></div>
    <span class="n">ymax</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_ymax</span><span class="p">,</span> <span class="n">set_ymax</span><span class="p">,</span> <span class="n">del_ymax</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Max of Y axis to use for plot&quot;</span><span class="p">)</span>



    <span class="c1"># X/Y TICKS</span>

<div class="viewcode-block" id="Plot.get_xticks"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_xticks">[docs]</a>    <span class="k">def</span> <span class="nf">get_xticks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get X ticks&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">()</span></div>
<div class="viewcode-block" id="Plot.set_xticks"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_xticks">[docs]</a>    <span class="k">def</span> <span class="nf">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ticks</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set X ticks&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">ticks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="n">ticks</span><span class="o">==</span><span class="s1">&#39;auto&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span><span class="k">return</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;t&#39;</span><span class="p">:</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="n">AutoDateLocator2</span><span class="p">()</span>
            <span class="n">ticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_scale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">Locator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_xticks"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_xticks">[docs]</a>    <span class="k">def</span> <span class="nf">del_xticks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del X ticks&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xticks</span> <span class="o">=</span> <span class="kc">False</span></div>
    <span class="n">xticks</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xticks</span><span class="p">,</span> <span class="n">set_xticks</span><span class="p">,</span> <span class="n">del_xticks</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;X ticks to use plot&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_yticks"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_yticks">[docs]</a>    <span class="k">def</span> <span class="nf">get_yticks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Y ticks&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()</span></div>
<div class="viewcode-block" id="Plot.set_yticks"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_yticks">[docs]</a>    <span class="k">def</span> <span class="nf">set_yticks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ticks</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Y ticks&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">ticks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="n">ticks</span><span class="o">==</span><span class="s1">&#39;auto&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span><span class="k">return</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;t&#39;</span><span class="p">:</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="n">AutoDateLocator2</span><span class="p">()</span>
            <span class="n">ticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_scale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">Locator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_yticks"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_yticks">[docs]</a>    <span class="k">def</span> <span class="nf">del_yticks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del Y ticks&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yticks</span> <span class="o">=</span> <span class="kc">False</span></div>
    <span class="n">yticks</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_yticks</span><span class="p">,</span> <span class="n">set_yticks</span><span class="p">,</span>
        <span class="n">del_yticks</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;X ticks to use for plot&quot;</span><span class="p">)</span>


    <span class="c1"># Generic attribute management</span>
    <span class="k">def</span> <span class="nf">_get_xyattr_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">att</span><span class="p">,</span> <span class="n">idata</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get an attribute of an X/Y axis or current data&quot;&quot;&quot;</span>

<span class="c1">#        # Nothing</span>
<span class="c1">#        if not self.has_data(): return</span>

        <span class="c1"># From a variable</span>
        <span class="k">if</span> <span class="n">xy</span><span class="o">==</span><span class="s1">&#39;d&#39;</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="o">+</span><span class="s1">&#39;type&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span> <span class="k">return</span>
            <span class="k">if</span> <span class="n">idata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">idata</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">idata</span> <span class="o">=</span> <span class="p">[</span><span class="n">idata</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idata</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">+</span><span class="n">i</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">&gt;</span><span class="n">i</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">att</span><span class="p">):</span>
                    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">att</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># From an axis</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">),</span> <span class="n">att</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_xyattr_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">att</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">idata</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set an attribute to an X/Y axis or current data&quot;&quot;&quot;</span>

<span class="c1">#        # Nothing</span>
<span class="c1">#        if not self.has_data(): return</span>

        <span class="c1"># Del</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_del_xyattr_</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">att</span><span class="p">)</span>

        <span class="c1"># Variable or axis?</span>
        <span class="k">if</span> <span class="n">xy</span><span class="o">==</span><span class="s1">&#39;d&#39;</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="o">+</span><span class="s1">&#39;type&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idata</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">)</span>
<span class="c1">#            setattr(self.data[idata], att, value)</span>

        <span class="c1"># Set</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">att</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_del_xyattr_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">att</span><span class="p">,</span> <span class="n">idata</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del an attribute from an X/Y axis or current data&quot;&quot;&quot;</span>

        <span class="c1"># Nothing</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span> <span class="k">return</span>

        <span class="c1"># To a variable</span>
        <span class="k">if</span> <span class="n">xy</span><span class="o">==</span><span class="s1">&#39;d&#39;</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="o">+</span><span class="s1">&#39;type&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idata</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">)</span>

        <span class="c1"># Del</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">att</span><span class="p">):</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">att</span><span class="p">)</span>


    <span class="c1"># ID / SHORT NAME</span>

<div class="viewcode-block" id="Plot.get_id"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_id">[docs]</a>    <span class="k">def</span> <span class="nf">get_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idata</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`id`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xyattr_</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">idata</span><span class="o">=</span><span class="n">idata</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.set_id"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_id">[docs]</a>    <span class="k">def</span> <span class="nf">set_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`id`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_xyattr_</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_id"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_id">[docs]</a>    <span class="k">def</span> <span class="nf">del_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`id`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_del_xyattr_</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span></div>
    <span class="nb">id</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_id</span><span class="p">,</span> <span class="n">set_id</span><span class="p">,</span>
        <span class="n">del_id</span><span class="p">,</span> <span class="s1">&#39;Current data id&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_xid"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_xid">[docs]</a>    <span class="k">def</span> <span class="nf">get_xid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`xid`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xyattr_</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.set_xid"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_xid">[docs]</a>    <span class="k">def</span> <span class="nf">set_xid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`xid`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_xyattr_</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_xid"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_xid">[docs]</a>    <span class="k">def</span> <span class="nf">del_xid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`xid`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_del_xyattr_</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span></div>
    <span class="n">xid</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xid</span><span class="p">,</span> <span class="n">set_xid</span><span class="p">,</span>
        <span class="n">del_xid</span><span class="p">,</span> <span class="s1">&#39;Current id of X axis&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_yid"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_yid">[docs]</a>    <span class="k">def</span> <span class="nf">get_yid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`yid`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xyattr_</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.set_yid"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_yid">[docs]</a>    <span class="k">def</span> <span class="nf">set_yid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`yid`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_xyattr_</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_yid"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_yid">[docs]</a>    <span class="k">def</span> <span class="nf">del_yid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`yid`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_del_xyattr_</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span></div>
    <span class="n">yid</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_yid</span><span class="p">,</span> <span class="n">set_yid</span><span class="p">,</span>
        <span class="n">del_yid</span><span class="p">,</span> <span class="s1">&#39;Current id of Y axis&#39;</span><span class="p">)</span>



    <span class="c1"># LONG_NAME</span>

<div class="viewcode-block" id="Plot.get_long_name"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_long_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_long_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idata</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`long_name`&quot;&quot;&quot;</span>
        <span class="n">long_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xyattr_</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="n">idata</span><span class="o">=</span><span class="n">idata</span><span class="p">)</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">idata</span><span class="o">=</span><span class="n">idata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">long_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">id</span><span class="p">:</span>
            <span class="n">long_name</span> <span class="o">=</span> <span class="nb">id</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">long_name</span></div>
<div class="viewcode-block" id="Plot.set_long_name"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_long_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_long_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`long_name`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_xyattr_</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="n">long_name</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_long_name"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_long_name">[docs]</a>    <span class="k">def</span> <span class="nf">del_long_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`long_name`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_del_xyattr_</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">)</span></div>
    <span class="n">long_name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_long_name</span><span class="p">,</span> <span class="n">set_long_name</span><span class="p">,</span>
        <span class="n">del_long_name</span><span class="p">,</span> <span class="s1">&#39;Current long name&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_xlong_name"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_xlong_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_xlong_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`xlong_name`&quot;&quot;&quot;</span>
        <span class="n">long_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xyattr_</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">long_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">long_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xid</span><span class="p">()</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">long_name</span></div>
<div class="viewcode-block" id="Plot.set_xlong_name"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_xlong_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_xlong_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`xlong_name`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_xyattr_</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="n">long_name</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_xlong_name"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_xlong_name">[docs]</a>    <span class="k">def</span> <span class="nf">del_xlong_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`xlong_name`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_del_xyattr_</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">)</span></div>
    <span class="n">xlong_name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xlong_name</span><span class="p">,</span> <span class="n">set_xlong_name</span><span class="p">,</span>
        <span class="n">del_xlong_name</span><span class="p">,</span> <span class="s1">&#39;Current long_name of X axis&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_ylong_name"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_ylong_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_ylong_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`ylong_name`&quot;&quot;&quot;</span>
        <span class="n">long_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xyattr_</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">long_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">long_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_yid</span><span class="p">()</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">long_name</span></div>
<div class="viewcode-block" id="Plot.set_ylong_name"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_ylong_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_ylong_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`ylong_name`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_xyattr_</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="n">long_name</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_ylong_name"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_ylong_name">[docs]</a>    <span class="k">def</span> <span class="nf">del_ylong_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`ylong_name`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_del_xyattr_</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">)</span></div>
    <span class="n">ylong_name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_ylong_name</span><span class="p">,</span> <span class="n">set_ylong_name</span><span class="p">,</span>
        <span class="n">del_ylong_name</span><span class="p">,</span> <span class="s1">&#39;Current long_name of Y axis&#39;</span><span class="p">)</span>


    <span class="c1"># UNITS</span>

<div class="viewcode-block" id="Plot.get_units"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_units">[docs]</a>    <span class="k">def</span> <span class="nf">get_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idata</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`units`&quot;&quot;&quot;</span>
        <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xyattr_</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="n">idata</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;$&#39;</span> <span class="ow">and</span> <span class="n">units</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;$&#39;</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="n">units</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isset</span><span class="p">(</span><span class="s1">&#39;latex_units&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">latex_units</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">units</span></div>
<div class="viewcode-block" id="Plot.set_units"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_units">[docs]</a>    <span class="k">def</span> <span class="nf">set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`units`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_xyattr_</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="n">units</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_units"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_units">[docs]</a>    <span class="k">def</span> <span class="nf">del_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`units`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_del_xyattr_</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">)</span></div>
    <span class="n">units</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_units</span><span class="p">,</span> <span class="n">set_units</span><span class="p">,</span> <span class="n">del_units</span><span class="p">,</span> <span class="s1">&#39;Current units&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_xunits"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_xunits">[docs]</a>    <span class="k">def</span> <span class="nf">get_xunits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`xunits`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xyattr_</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.set_xunits"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_xunits">[docs]</a>    <span class="k">def</span> <span class="nf">set_xunits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`xunits`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_xyattr_</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="n">units</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_xunits"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_xunits">[docs]</a>    <span class="k">def</span> <span class="nf">del_xunits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`xunits`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_del_xyattr_</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">)</span></div>
    <span class="n">xunits</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xunits</span><span class="p">,</span> <span class="n">set_xunits</span><span class="p">,</span>
        <span class="n">del_xunits</span><span class="p">,</span> <span class="s1">&#39;Current units of X axis&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_yunits"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_yunits">[docs]</a>    <span class="k">def</span> <span class="nf">get_yunits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`yunits`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xyattr_</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.set_yunits"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_yunits">[docs]</a>    <span class="k">def</span> <span class="nf">set_yunits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`yunits`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_xyattr_</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="n">units</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_yunits"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_yunits">[docs]</a>    <span class="k">def</span> <span class="nf">del_yunits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`yunits`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_del_xyattr_</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">)</span></div>
    <span class="n">yunits</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_yunits</span><span class="p">,</span> <span class="n">set_yunits</span><span class="p">,</span>
        <span class="n">del_yunits</span><span class="p">,</span> <span class="s1">&#39;Current units of Y axis&#39;</span><span class="p">)</span>

    <span class="c1"># INTERPRET UNITS WITH LATEX?</span>

<div class="viewcode-block" id="Plot.get_latex_units"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_latex_units">[docs]</a>    <span class="k">def</span> <span class="nf">get_latex_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`latex_units`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;latex_units&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="kc">False</span></div>
<div class="viewcode-block" id="Plot.set_latex_units"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_latex_units">[docs]</a>    <span class="k">def</span> <span class="nf">set_latex_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`units`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;latex_units&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_latex_units"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_latex_units">[docs]</a>    <span class="k">def</span> <span class="nf">del_latex_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`units`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;latex_units&#39;</span><span class="p">)</span></div>
    <span class="n">latex_units</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_latex_units</span><span class="p">,</span> <span class="n">set_latex_units</span><span class="p">,</span> <span class="n">del_latex_units</span><span class="p">,</span> <span class="s1">&#39;Interpret units with latex&#39;</span><span class="p">)</span>

    <span class="n">re_latex_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\$.+\$&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span>
<div class="viewcode-block" id="Plot.is_latex"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.is_latex">[docs]</a>    <span class="k">def</span> <span class="nf">is_latex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Is this text formatted as latex formula (&quot;$...$&quot;)?&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">re_latex_match</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>


    <span class="c1"># TITLE OF THE PLOT</span>

    <span class="k">def</span> <span class="nf">_strfill_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strpat</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;pattern&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Try to fill strpat with self.sndict() or return strpat with not filling&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">strpat</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">sndict</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
<span class="c1">#            warn(&quot;Error when filling %(name)s (skipping): %(strpat)s&quot;%locals())</span>
            <span class="k">return</span> <span class="n">strpat</span>


<div class="viewcode-block" id="Plot.get_title"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_title">[docs]</a>    <span class="k">def</span> <span class="nf">get_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`title`&quot;&quot;&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;_auto_&#39;</span><span class="p">:</span> <span class="n">title</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strfill_</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="s1">&#39;title pattern&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">long_name</span></div>
<div class="viewcode-block" id="Plot.set_title"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_title">[docs]</a>    <span class="k">def</span> <span class="nf">set_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set attr:`title`</span>

<span class="sd">        .. note:: If set to ``False``, the title is not plotted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_title"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_title">[docs]</a>    <span class="k">def</span> <span class="nf">del_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del attr:`title`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_axobj</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span></div>
    <span class="n">title</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_title</span><span class="p">,</span> <span class="n">set_title</span><span class="p">,</span>
        <span class="n">del_title</span><span class="p">,</span> <span class="s1">&#39;Preformed title to use for the plot. &#39;</span>
        <span class="s1">&#39;It may be formed as a template using other attributes &#39;</span>
        <span class="s1">&#39;like :attr:`long_name`, :attr:`units`,  :attr:`xmin`,  etc.&#39;</span><span class="p">)</span>


    <span class="c1"># LABELS</span>

<div class="viewcode-block" id="Plot.get_label"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_label">[docs]</a>    <span class="k">def</span> <span class="nf">get_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`label`&quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strfill_</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="s1">&#39;label pattern&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">long_name</span></div>
<div class="viewcode-block" id="Plot.set_label"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_label">[docs]</a>    <span class="k">def</span> <span class="nf">set_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`label`</span>

<span class="sd">        .. note:: If set to ``False``, the label is not plotted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.del_label"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_label">[docs]</a>    <span class="k">def</span> <span class="nf">del_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`label`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_axobj</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span></div>
    <span class="n">label</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_label</span><span class="p">,</span> <span class="n">set_label</span><span class="p">,</span>
        <span class="n">del_label</span><span class="p">,</span> <span class="s1">&#39;Preformed label to use for the plot. &#39;</span>
        <span class="s1">&#39;It may be formed as a template using other attributes &#39;</span>
        <span class="s1">&#39;like :attr:`long_name`, :attr:`units`,  :attr:`xmin`,  etc.&#39;</span><span class="p">)</span>



<div class="viewcode-block" id="Plot.get_xlabel"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_xlabel">[docs]</a>    <span class="k">def</span> <span class="nf">get_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr::`xlabel`&quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;xlabel&#39;</span><span class="p">)</span>
<span class="c1">#        label = getattr(self, &#39;_xlabel&#39;, None)</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fmt_lnu</span><span class="p">(</span><span class="n">long_name</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fmt_lnu</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strfill_</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="s1">&#39;xlabel pattern&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.set_xlabel"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_xlabel">[docs]</a>    <span class="k">def</span> <span class="nf">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;set :attr::`xlabel`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;xlabel&#39;</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span></div>
<span class="c1">#        self._xlabel = label</span>
<div class="viewcode-block" id="Plot.del_xlabel"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_xlabel">[docs]</a>    <span class="k">def</span> <span class="nf">del_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr::`xlabel`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_axobj</span><span class="p">(</span><span class="s1">&#39;xlabel&#39;</span><span class="p">)</span></div>
<span class="c1">#        if hasattr(self, &#39;_xlabel&#39;): del self._xlabel</span>
    <span class="n">xlabel</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xlabel</span><span class="p">,</span> <span class="n">set_xlabel</span><span class="p">,</span>
        <span class="n">del_xlabel</span><span class="p">,</span> <span class="s1">&#39;Label of X axis. &#39;</span>
        <span class="s1">&#39;It may be formed as a template using other attributes &#39;</span>
        <span class="s1">&#39;like :attr:`long_name`, :attr:`units`,  :attr:`xmin`,  etc.&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_ylabel"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_ylabel">[docs]</a>    <span class="k">def</span> <span class="nf">get_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr::`ylabel`&quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">)</span>
<span class="c1">#        label = getattr(self, &#39;_ylabel&#39;, None)</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fmt_lnu</span><span class="p">(</span><span class="n">long_name</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fmt_lnu</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strfill_</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="s1">&#39;ylabel pattern&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot.set_ylabel"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.set_ylabel">[docs]</a>    <span class="k">def</span> <span class="nf">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr::`ylabel`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span></div>
<span class="c1">#        self._ylabel = label</span>
<div class="viewcode-block" id="Plot.del_ylabel"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.del_ylabel">[docs]</a>    <span class="k">def</span> <span class="nf">del_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr::`ylabel`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_axobj</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">)</span></div>
<span class="c1">#        if hasattr(self, &#39;_ylabel&#39;): del self._ylabel</span>
    <span class="n">ylabel</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_ylabel</span><span class="p">,</span> <span class="n">set_ylabel</span><span class="p">,</span>
        <span class="n">del_ylabel</span><span class="p">,</span> <span class="s1">&#39;Label of Y axis. &#39;</span>
        <span class="s1">&#39;It may be formed as a template using other attributes &#39;</span>
        <span class="s1">&#39;like :attr:`long_name`, :attr:`units`,  :attr:`xmin`,  etc.&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_fmt_lnu"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.get_fmt_lnu">[docs]</a>    <span class="k">def</span> <span class="nf">get_fmt_lnu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">fmtln</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(long_name)s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fmtu</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(units)s</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">fmtlnu</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(long_name)s</span><span class="s1"> [</span><span class="si">%(units)s</span><span class="s1">]&#39;</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Format long_name and units as string according to their availability</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **prefix**, optional: Prefix of the attributes</span>

<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; myplot.get_fmt_lnu()</span>
<span class="sd">            &#39;%(long_name)s [%(units)s]&#39;</span>
<span class="sd">            &gt;&gt;&gt; myplot.get_fmt_lnu(prefix=&#39;x&#39;, fmtlnu=&#39;%(long_name)s [%(units)s]&#39;)</span>
<span class="sd">            &#39;%(xlong_name)s [%(xunits)s]&#39;</span>
<span class="sd">            &gt;&gt;&gt; myplot.get_fmt_lnu(long_name=False)</span>
<span class="sd">            &#39;%(xunits)s&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="o">+</span><span class="s1">&#39;long_name&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">long_name</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="o">+</span><span class="s1">&#39;units&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">units</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">long_name</span> <span class="ow">and</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">fmtlnu</span>
        <span class="k">elif</span> <span class="n">long_name</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">fmtln</span>
        <span class="k">elif</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">fmtu</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
        <span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1">(</span><span class="si">%s</span><span class="s1">long_name)s&#39;</span><span class="o">%</span><span class="n">prefix</span>
        <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1">(</span><span class="si">%s</span><span class="s1">units)s&#39;</span><span class="o">%</span><span class="n">prefix</span>
        <span class="k">return</span> <span class="n">fmt</span><span class="o">%</span><span class="nb">locals</span><span class="p">()</span></div>


    <span class="c1"># DICTIONARY OF ATTRIBUTES</span>

<div class="viewcode-block" id="Plot.dict"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.dict">[docs]</a>    <span class="k">def</span> <span class="nf">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="o">**</span><span class="n">items</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get attributes as a dictionary</span>

<span class="sd">        .. note::</span>

<span class="sd">            :attr:`units` is treated in a special way.</span>
<span class="sd">            If :attr:`latex_units` is ``True``, it is formatted</span>
<span class="sd">            as ``$&lt;units&gt;$``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_primary_attributes</span><span class="p">)</span>
        <span class="n">dd</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">dd</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="n">items</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">])</span>
        <span class="n">dd</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_units</span> <span class="ow">and</span> <span class="s1">&#39;units&#39;</span> <span class="ow">in</span> <span class="n">dd</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_latex</span><span class="p">(</span><span class="n">dd</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]):</span>
            <span class="n">dd</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;$</span><span class="si">%(units)s</span><span class="s1">$&#39;</span><span class="o">%</span><span class="n">dd</span>
        <span class="k">return</span> <span class="n">dd</span></div>

<div class="viewcode-block" id="Plot.sndict"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.sndict">[docs]</a>    <span class="k">def</span> <span class="nf">sndict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="o">**</span><span class="n">items</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get attributes as a dictionary of strings or numbers&quot;&quot;&quot;</span>
        <span class="n">dd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="o">**</span><span class="n">items</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dd</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">dd</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">dd</span></div>


<div class="viewcode-block" id="Plot.sdict"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot.sdict">[docs]</a>    <span class="k">def</span> <span class="nf">sdict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="o">**</span><span class="n">items</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get attributes as a dictionary of strings&quot;&quot;&quot;</span>
        <span class="n">dd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sndict</span><span class="p">(</span><span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="o">**</span><span class="n">items</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dd</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dd</span></div></div>


    <span class="c1"># ADVANCED GRAPHICAL METHODS</span>


<div class="viewcode-block" id="Plot1D"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot1D">[docs]</a><span class="k">class</span> <span class="nc">Plot1D</span><span class="p">(</span><span class="n">Plot</span><span class="p">):</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;zd&#39;</span><span class="p">,</span> <span class="s1">&#39;d-&#39;</span><span class="p">,</span> <span class="s1">&#39;-d&#39;</span><span class="p">]</span>
    <span class="n">rank</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_check_order_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check order of data</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **vertical**, optional: Plot vertically.</span>

<span class="sd">        :Sea also: :meth:`Plot._check_order_`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Force vertical plot</span>
        <span class="k">if</span> <span class="n">vertical</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span> <span class="p">]</span>
        <span class="k">elif</span> <span class="n">vertical</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">o</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)]</span>

        <span class="c1"># Old stuff</span>
        <span class="k">return</span> <span class="n">Plot</span><span class="o">.</span><span class="n">_check_order_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="c1">#    check_order.__doc__ = Plot.check_order.__doc__</span>

    <span class="k">def</span> <span class="nf">_set_axes_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axisatts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get/set used axes</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **axis**, optional: Change plot axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get axis and adjust order</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">isaxis</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">cdms2</span><span class="o">.</span><span class="n">createAxis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
                    <span class="n">cp_atts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">axis</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span> <span class="c1"># adjust order</span>
                <span class="n">orders</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">getOrder</span><span class="p">()</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">ivar</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">c</span><span class="o">!=</span><span class="s1">&#39;-&#39;</span> <span class="ow">or</span> <span class="n">orders</span><span class="p">[</span><span class="n">ivar</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;-&#39;</span><span class="p">:</span>
                        <span class="n">set_order</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;No axis data available for this plot&#39;</span><span class="p">)</span>

        <span class="c1"># Change attributes</span>
        <span class="k">if</span> <span class="n">axisatts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">set_atts</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">axisatts</span><span class="p">)</span>

        <span class="c1"># Set X axis by default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>


<span class="c1">#    _set_axes_.__doc__ = Plot._set_axes_.__doc__</span>

        <span class="c1"># Restore order</span>


<div class="viewcode-block" id="Plot1D.get_axis_data"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot1D.get_axis_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_axis_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return data of the axis&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span> <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xtype</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ScalarMappable"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable">[docs]</a><span class="k">class</span> <span class="nc">ScalarMappable</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Abstract class for adding scalar mappable utilities</span>

<span class="sd">    :Attribute params:</span>

<span class="sd">        - **levels**, optional: Levels to use for contours or colorbar ticks.</span>
<span class="sd">          &quot;They can be specified as a single value, a list or array, or &quot;</span>
<span class="sd">          &quot;as a tuple used as argument to :func:`numpy.arange`.</span>
<span class="sd">          It sets the attribute :attr:`~vacumm.misc.core_plot.ScalarMappable.levels`.</span>
<span class="sd">        - **nmax_levels**, optional: Maximal number of levels when</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.ScalarMappable.levels` are computed automatically.</span>
<span class="sd">          It sets the attribute :attr:`~vacumm.misc.core_plot.ScalarMappable.nmax_levels`.</span>
<span class="sd">        - **nmax**, optional: Same as **nmax_levels**.</span>
<span class="sd">          It sets the attribute :attr:`~vacumm.misc.core_plot.ScalarMappable.keepminmax`.</span>
<span class="sd">        - **cmap**, optional: Colormap name (see :func:`vacumm.misc.color.get_cmap`).</span>
<span class="sd">          If not specified, it is taken from</span>
<span class="sd">          config section ``[vacumm.misc.plot]`` and config option ``cmap``, as a string</span>
<span class="sd">          that defaults to ``magic``.</span>
<span class="sd">        - **levels_mode**, optional: Mode of computing levels if needed.</span>
<span class="sd">          It can be specified at initialisation with</span>
<span class="sd">          attribute :attr:`~vacumm.misc.core_plot.ScalarMappable.levels_mode`.</span>
<span class="sd">          If not specified, it it taken from the config section</span>
<span class="sd">          ``[vacumm.misc.plot]`` and config option ``levels_mode``.</span>

<span class="sd">            - ``&quot;symetric&quot;``: Min and max are set opposite.</span>
<span class="sd">            - ``&quot;positive&quot;``: Min is set to 0.</span>
<span class="sd">            - ``&quot;negative&quot;``: Max is set to 0.</span>
<span class="sd">            - ``&quot;auto&quot;``: If abs(min) and abs(max) are close,</span>
<span class="sd">              ``&quot;symetric&quot;`` is assumed. If min and max are &gt; 0,</span>
<span class="sd">              ``&quot;positive&quot;`` is assumed, and the reverse for</span>
<span class="sd">              ``&quot;negative&quot;``.</span>
<span class="sd">        - **keepminmax**, optional:</span>
<span class="sd">          It can be specified at initialisation with</span>
<span class="sd">          attribute :attr:`~vacumm.misc.core_plot.ScalarMappable.keepminmax`.</span>
<span class="sd">          If not specified, it it taken from the config section</span>
<span class="sd">          ``[vacumm.misc.plot]`` and config option ``keepminmax``.</span>
<span class="sd">          If False or 0, adjust</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.ScalarMappable.vmin` and</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.ScalarMappable.vmax`</span>
<span class="sd">          to first and last values of :attr:`~vacumm.misc.core_plot.ScalarMappable.levels`;</span>
<span class="sd">          if 1, do not change :attr:`~vacumm.misc.core_plot.ScalarMappable.vmin`,</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.ScalarMappable.vmax` and :attr:`levels`</span>
<span class="sd">          if 2, adjust first and last values of :attr:`levels` or</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.ScalarMappable.vmin`,</span>
<span class="sd">          :attr:`~vacumm.misc.core_plot.ScalarMappable.vmax`.</span>
<span class="sd">          It sets the attribute :attr:`~vacumm.misc.core_plot.ScalarMappable.cmap`.</span>
<span class="sd">        - **cblabel**, optional: Preformed label of the colorbar.</span>
<span class="sd">          It may be formed as a template using other attributes</span>
<span class="sd">          like :attr:`long_name`, :attr:`~vacumm.misc.core_plot.Plot.units`,</span>
<span class="sd">          :attr:`xmin`,  etc. Example: ``&quot;%(long_name)s [%(units)s]&quot;``.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_primary_attributes</span> <span class="o">=</span> <span class="n">Plot</span><span class="o">.</span><span class="n">_primary_attributes</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;nmax&#39;</span><span class="p">,</span> <span class="s1">&#39;nmax_levels&#39;</span><span class="p">,</span>
        <span class="s1">&#39;levels_mode&#39;</span><span class="p">,</span> <span class="s1">&#39;levels&#39;</span><span class="p">,</span> <span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="s1">&#39;keepminmax&#39;</span><span class="p">]</span>
    <span class="n">_secondary_attributes</span> <span class="o">=</span> <span class="n">Plot</span><span class="o">.</span><span class="n">_secondary_attributes</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;cblabel&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="ScalarMappable.get_nmax_levels"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.get_nmax_levels">[docs]</a>    <span class="k">def</span> <span class="nf">get_nmax_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`nmax_levels`&quot;&quot;&quot;</span>
        <span class="n">nmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;nmax_levels&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">nmax</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">get_config_value</span><span class="p">(</span><span class="s1">&#39;vacumm.misc.plot&#39;</span><span class="p">,</span> <span class="s1">&#39;nmax_levels&#39;</span><span class="p">))</span></div>
<div class="viewcode-block" id="ScalarMappable.set_nmax_levels"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.set_nmax_levels">[docs]</a>    <span class="k">def</span> <span class="nf">set_nmax_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`nmax_levels`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;nmax_levels&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="ScalarMappable.del_nmax_levels"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.del_nmax_levels">[docs]</a>    <span class="k">def</span> <span class="nf">del_nmax_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`nmax_levels`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;nmax_levels&#39;</span><span class="p">)</span></div>
    <span class="n">nmax_levels</span> <span class="o">=</span> <span class="n">nmax</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_nmax_levels</span><span class="p">,</span> <span class="n">set_nmax_levels</span><span class="p">,</span>
        <span class="n">del_nmax_levels</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Max number of :attr:`levels` for contours and colorbar ticks.&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="ScalarMappable.get_levels"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.get_levels">[docs]</a>    <span class="k">def</span> <span class="nf">get_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepminmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nocache</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">autoscaling</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`levels` for contours and colorbar ticks</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **mode**, optional: Mode of computing levels if needed.</span>
<span class="sd">              It can be specified at initialisation with</span>
<span class="sd">              attribute :attr:`levels_mode`.</span>
<span class="sd">              If not specified, it it taken from the config section</span>
<span class="sd">              ``[vacumm.misc.plot]`` and config option ``levels_mode``.</span>

<span class="sd">                - ``&quot;normal&quot;``: Min and max are not preprocessed.</span>
<span class="sd">                - ``&quot;symetric&quot;``: Min and max are set opposite.</span>
<span class="sd">                - ``&quot;positive&quot;``: Min is set to 0.</span>
<span class="sd">                - ``&quot;negative&quot;``: Max is set to 0.</span>
<span class="sd">                - ``&quot;auto&quot;``: If abs(min) and abs(max) are close,</span>
<span class="sd">                  ``&quot;symetric&quot;``is assumed. If min and max are &gt; 0,</span>
<span class="sd">                  ``&quot;positive&quot;`` is assumed, and the reverse for</span>
<span class="sd">                  ``&quot;negative&quot;``.</span>

<span class="sd">            - **keepminmax**, optional:</span>
<span class="sd">              It can be specified at initialisation with</span>
<span class="sd">              attribute :attr:`keepminmax`.</span>
<span class="sd">              If not specified, it it taken from the config section</span>
<span class="sd">              ``[vacumm.misc.plot]`` and config option ``keepminmax``.</span>
<span class="sd">              If False or 0, adjust</span>
<span class="sd">              :attr:`vmin` and :attr:`vmax` to first and last values of :attr:`levels`;</span>
<span class="sd">              if 1, do not change :attr:`vmin`, :attr:`vmax` and :attr:`levels`</span>
<span class="sd">              if 2, adjust first and last values of :attr:`levels` or</span>
<span class="sd">              :attr:`vmin`, :attr:`vmax`.</span>
<span class="sd">            - **nocache**, optional: Once levels are computed, they are stored</span>
<span class="sd">              in cache. If ``nocache is True``, first check cache before</span>
<span class="sd">              trying to compute levels.</span>
<span class="sd">            - **autoscaling**, optional: Autoscaling mode.</span>

<span class="sd">                - ``&quot;normal&quot;``: Use :func:`~vacumm.misc.misc.auto_scale`.</span>
<span class="sd">                - ``&quot;degrees&quot;``: Use :func:`~vacumm.misc.misc.geo_scale`.</span>
<span class="sd">                - `A callable: Use it to auto scale. It should accept</span>
<span class="sd">                  the follwing keywords: vmin, vmax, nmax, keepminmax.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Cache</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;levels&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">):</span>
                <span class="n">levels</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">levels</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">levels</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">*</span><span class="n">levels</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_levels</span> <span class="o">=</span> <span class="n">levels</span>
            <span class="k">return</span> <span class="n">levels</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_levels&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">nocache</span><span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_levels</span>

        <span class="c1"># Inits</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">levels</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">levels_mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels_mode</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">keepminmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">keepminmax</span> <span class="o">=</span> <span class="n">keepminmax</span>
        <span class="n">keepminmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keepminmax</span>

        <span class="c1"># Min and max</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;symetric&#39;</span><span class="p">,</span> <span class="s1">&#39;anomaly&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="n">key</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isset</span><span class="p">(</span><span class="s1">&#39;vmin&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isset</span><span class="p">(</span><span class="s1">&#39;vmax&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minmax2levelsmode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">levels_mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="k">if</span> <span class="n">mode</span><span class="o">==</span><span class="s1">&#39;positive&#39;</span><span class="p">:</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">elif</span> <span class="n">mode</span><span class="o">==</span><span class="s1">&#39;negative&#39;</span><span class="p">:</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">elif</span> <span class="n">mode</span><span class="o">==</span><span class="s1">&#39;symetric&#39;</span><span class="p">:</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="p">),</span> <span class="n">N</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="p">))</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">vmax</span>

        <span class="c1"># Compute base levels</span>
        <span class="k">assert</span> <span class="n">autoscaling</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">callable</span><span class="p">(</span><span class="n">autoscaling</span><span class="p">),</span> <span class="s1">&#39;Wrong autoscaling parameter&#39;</span>
        <span class="k">if</span> <span class="n">autoscaling</span><span class="o">==</span><span class="s1">&#39;normal&#39;</span><span class="p">:</span>
            <span class="n">autoscaling</span> <span class="o">=</span> <span class="n">auto_scale</span>
        <span class="k">elif</span> <span class="n">autoscaling</span><span class="o">==</span><span class="s1">&#39;degrees&#39;</span><span class="p">:</span>
            <span class="n">autoscaling</span> <span class="o">=</span> <span class="n">geo_scale</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">autoscaling</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
            <span class="n">nmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nmax_levels</span><span class="p">,</span> <span class="n">keepminmax</span><span class="o">=</span><span class="n">keepminmax</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Change min and max</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">keepminmax</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span>


        <span class="c1"># Cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_levels</span> <span class="o">=</span> <span class="n">levels</span>
        <span class="k">return</span> <span class="n">levels</span></div>

<div class="viewcode-block" id="ScalarMappable.minmax2levelsmode"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.minmax2levelsmode">[docs]</a>    <span class="k">def</span> <span class="nf">minmax2levelsmode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get auto levels mode from min and max value</span>

<span class="sd">        :Return: normal, symetric, positive or negative&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span>
        <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">vmin</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">vmax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">vmin</span><span class="o">&lt;=</span><span class="n">vmax</span><span class="o">/</span><span class="mf">3.</span><span class="p">):</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;positive&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">vmin</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">vmax</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">vmax</span><span class="o">&gt;=</span><span class="n">vmin</span><span class="o">/</span><span class="mf">3.</span><span class="p">):</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;negative&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">vmin</span><span class="o">+</span><span class="n">vmax</span><span class="p">)</span><span class="o">&lt;</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="p">(</span><span class="n">vmax</span><span class="o">-</span><span class="n">vmin</span><span class="p">):</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;symetric&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span>
        <span class="k">return</span> <span class="n">mode</span></div>

<div class="viewcode-block" id="ScalarMappable.set_levels"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.set_levels">[docs]</a>    <span class="k">def</span> <span class="nf">set_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`levels`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;levels&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="ScalarMappable.del_levels"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.del_levels">[docs]</a>    <span class="k">def</span> <span class="nf">del_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`levels`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;levels&#39;</span><span class="p">)</span></div>
    <span class="n">levels</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_levels</span><span class="p">,</span> <span class="n">set_levels</span><span class="p">,</span>
        <span class="n">del_levels</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Levels to use for contours or colorbar ticks. &quot;</span>
            <span class="s2">&quot;They can be specified as a single value, a list or array, or &quot;</span>
            <span class="s2">&quot;as a tuple used as argument to :func:`numpy.arange`.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="ScalarMappable.get_keepminmax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.get_keepminmax">[docs]</a>    <span class="k">def</span> <span class="nf">get_keepminmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`keepminmax`&quot;&quot;&quot;</span>
        <span class="n">keepminmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;keepminmax&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">keepminmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">keepminmax</span> <span class="o">=</span> <span class="n">get_config_value</span><span class="p">(</span><span class="s1">&#39;vacumm.misc.plot&#39;</span><span class="p">,</span> <span class="s1">&#39;keepminmax&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">keepminmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keepminmax</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Error with keepminmax: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">keepminmax</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">keepminmax</span></div>
<div class="viewcode-block" id="ScalarMappable.set_keepminmax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.set_keepminmax">[docs]</a>    <span class="k">def</span> <span class="nf">set_keepminmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`keepminmax`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;keepminmax&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="ScalarMappable.del_keepminmax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.del_keepminmax">[docs]</a>    <span class="k">def</span> <span class="nf">del_keepminmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`keepminmax`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;keepminmax&#39;</span><span class="p">)</span></div>
    <span class="n">keepminmax</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_keepminmax</span><span class="p">,</span> <span class="n">set_keepminmax</span><span class="p">,</span>
        <span class="n">del_keepminmax</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Do not adjust :attr:`vmin` and :attr:`vmax` when setting :attr:`levels`. If 0, :attr:`vmin` and :attr:`vmax` are set to first and last :attr:`levels`; if 1, they are not adjested to :attr:`levels` ; if 2, first and last :attr:`levels` are adjusted to :attr:`vmin` and :attr:`vmax`.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="ScalarMappable.get_levels_mode"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.get_levels_mode">[docs]</a>    <span class="k">def</span> <span class="nf">get_levels_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`levels_mode`&quot;&quot;&quot;</span>
        <span class="n">levels_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;levels_mode&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">levels_mode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">levels_mode</span> <span class="o">=</span> <span class="n">get_config_value</span><span class="p">(</span><span class="s1">&#39;vacumm.misc.plot&#39;</span><span class="p">,</span> <span class="s1">&#39;levels_mode&#39;</span><span class="p">)</span>
        <span class="n">levels_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_levels_mode_</span><span class="p">(</span><span class="n">levels_mode</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">levels_mode</span></div>
<div class="viewcode-block" id="ScalarMappable.set_levels_mode"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.set_levels_mode">[docs]</a>    <span class="k">def</span> <span class="nf">set_levels_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`levels_mode`&quot;&quot;&quot;</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_levels_mode_</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;levels_mode&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span></div>
<div class="viewcode-block" id="ScalarMappable.del_levels_mode"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.del_levels_mode">[docs]</a>    <span class="k">def</span> <span class="nf">del_levels_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`levels_mode`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;levels_mode&#39;</span><span class="p">)</span></div>
    <span class="n">levels_mode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_levels_mode</span><span class="p">,</span> <span class="n">set_levels_mode</span><span class="p">,</span>
        <span class="n">del_levels_mode</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;The way :attr:`levels` are estimated from &quot;</span>
            <span class="s2">&quot;:attr:`vmin` and :attr:`vmax`: &#39;positive&#39;/&#39;negative&#39; means levels &quot;</span>
            <span class="s2">&quot;starting/ending from 0, &#39;anomaly&#39; or &#39;symetric&#39; means symetric &quot;</span>
            <span class="s2">&quot;levels, &#39;auto&#39; or &#39;smart&#39; means that mode is estimated &quot;</span>
            <span class="s2">&quot;from min and max, and &#39;normal&#39; means no special treatment.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_check_levels_mode_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check values and aliases, and fallback to config value&quot;&quot;&quot;</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;smart&#39;</span><span class="p">,</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="s1">&#39;basic&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">,</span>
                <span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;symetric&#39;</span><span class="p">,</span> <span class="s1">&#39;anomaly&#39;</span><span class="p">]:</span>
            <span class="n">oldmode</span> <span class="o">=</span> <span class="n">mode</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">get_config_value</span><span class="p">(</span><span class="s1">&#39;vacumm.misc.plot&#39;</span><span class="p">,</span> <span class="s1">&#39;levels_mode&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Bad value for config value [vacumm.misc.plot] levels_mode: </span><span class="si">%s</span><span class="s1">. Switched to default: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">oldmode</span><span class="p">,</span> <span class="n">mode</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">mode</span><span class="o">==</span><span class="s1">&#39;anomaly&#39;</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;symetric&#39;</span>
        <span class="k">elif</span> <span class="n">mode</span><span class="o">==</span><span class="s1">&#39;smart&#39;</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">elif</span> <span class="n">mode</span><span class="o">==</span><span class="s1">&#39;basic&#39;</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span>
        <span class="k">return</span> <span class="n">mode</span>

<div class="viewcode-block" id="ScalarMappable.get_vmin"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.get_vmin">[docs]</a>    <span class="k">def</span> <span class="nf">get_vmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`vmin`&quot;&quot;&quot;</span>
        <span class="n">gmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;vmin&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">gmin</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_levels&#39;</span><span class="p">):</span>
            <span class="n">mins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">glob</span><span class="p">:</span> <span class="c1"># Of all plotters</span>
                <span class="n">mins</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">mins</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">min</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brothers</span><span class="p">(</span><span class="n">notme</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
            <span class="k">return</span> <span class="n">mins</span>
        <span class="k">return</span> <span class="n">Plot</span><span class="o">.</span><span class="n">get_vmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="n">glob</span><span class="p">)</span></div>
    <span class="n">vmin</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_vmin</span><span class="p">,</span> <span class="n">Plot</span><span class="o">.</span><span class="n">set_vmin</span><span class="p">,</span>
        <span class="n">Plot</span><span class="o">.</span><span class="n">del_vmin</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Data min to use for plot&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="ScalarMappable.get_vmax"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.get_vmax">[docs]</a>    <span class="k">def</span> <span class="nf">get_vmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`vmax`&quot;&quot;&quot;</span>
        <span class="n">gmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;vmax&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">gmax</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_levels&#39;</span><span class="p">):</span>
            <span class="n">maxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_levels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">glob</span><span class="p">:</span> <span class="c1"># Of all plotters</span>
                <span class="n">maxs</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">maxs</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">max</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brothers</span><span class="p">(</span><span class="n">notme</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
            <span class="k">return</span> <span class="n">maxs</span>
        <span class="k">return</span> <span class="n">Plot</span><span class="o">.</span><span class="n">get_vmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="n">glob</span><span class="p">)</span></div>
    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_vmax</span><span class="p">,</span> <span class="n">Plot</span><span class="o">.</span><span class="n">set_vmax</span><span class="p">,</span>
        <span class="n">Plot</span><span class="o">.</span><span class="n">del_vmax</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Data max to use for plot&quot;</span><span class="p">)</span>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_config_cmap_</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;cmap&#39;</span><span class="p">):</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_config_value</span><span class="p">(</span><span class="s1">&#39;vacumm.misc.plot&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_config_value</span><span class="p">(</span><span class="s1">&#39;vacumm.misc.plot&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">cmap</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;mpl&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>
                <span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">,</span> <span class="s1">&#39;false&#39;</span><span class="p">]:</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># default from matplotlib</span>
            <span class="k">return</span> <span class="n">cmap</span>

<div class="viewcode-block" id="ScalarMappable.get_cmap"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.get_cmap">[docs]</a>    <span class="k">def</span> <span class="nf">get_cmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nocache</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">pastel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`cmap`</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **cmap**, optional: Colormap name (see :func:`vacumm.misc.color.get_cmap`).</span>
<span class="sd">              It defaults to ``&quot;magic&quot;``.</span>
<span class="sd">            - **nocache**, optional: Once cmap is computed, it is stored</span>
<span class="sd">              in cache. If ``nocache is True``, first check cache before</span>
<span class="sd">              trying to compute cmap.</span>
<span class="sd">            - **lum**, optional: Change luminosity, between -1 and 1.</span>
<span class="sd">            - **sat**, optional: Change saturation.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># From cache</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;cmap&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">nocache</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_cmap&#39;</span><span class="p">)</span> <span class="ow">and</span>
                <span class="n">tint</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">lum</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cmap</span>

        <span class="c1"># From config</span>
        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_config_cmap_</span><span class="p">()</span>

        <span class="c1"># Aliases</span>
        <span class="k">if</span> <span class="n">cmap</span> <span class="o">==</span> <span class="s1">&#39;mpl&#39;</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">cmap</span><span class="o">==</span><span class="s1">&#39;mg&#39;</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;magic&#39;</span>
        <span class="k">elif</span> <span class="n">cmap</span><span class="o">==</span><span class="s1">&#39;rb&#39;</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;rainbow&#39;</span>
        <span class="k">elif</span> <span class="n">cmap</span> <span class="o">==</span> <span class="s1">&#39;normal&#39;</span> <span class="ow">or</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Adaptative choices</span>
        <span class="n">cmap_levels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;symetric&#39;</span><span class="p">,</span> <span class="s1">&#39;anomaly&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;magic&#39;</span><span class="p">,</span> <span class="s1">&#39;rainbow&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">cmap_levels</span><span class="p">:</span>

            <span class="c1"># Levels mode</span>
            <span class="k">if</span> <span class="n">cmap</span> <span class="ow">in</span> <span class="n">cmap_levels</span><span class="p">:</span>
                <span class="n">levels_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_levels_mode_</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">levels_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels_mode</span>
                <span class="k">if</span> <span class="n">levels_mode</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
                    <span class="n">levels_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minmax2levelsmode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">cmap</span><span class="o">==</span><span class="s1">&#39;auto&#39;</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">levels_mode</span> <span class="o">==</span> <span class="s1">&#39;normal&#39;</span><span class="p">:</span>
                    <span class="n">cmap</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">elif</span> <span class="n">levels_mode</span> <span class="o">==</span> <span class="s1">&#39;symetric&#39;</span><span class="p">:</span>
                    <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_config_cmap_</span><span class="p">(</span><span class="s1">&#39;cmap_symetric&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">cmap</span> <span class="o">=</span> <span class="n">CMAP_SYMETRIC</span>
                <span class="k">elif</span> <span class="n">levels_mode</span> <span class="o">==</span> <span class="s1">&#39;positive&#39;</span><span class="p">:</span>
                    <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_config_cmap_</span><span class="p">(</span><span class="s1">&#39;cmap_positive&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">cmap</span> <span class="o">=</span> <span class="n">CMAP_POSITIVE</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_config_cmap_</span><span class="p">(</span><span class="s1">&#39;cmap_negative&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">cmap</span> <span class="o">=</span> <span class="n">CMAP_NEGATIVE</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">errmode</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">cmap</span><span class="o">==</span><span class="s1">&#39;magic&#39;</span> <span class="ow">or</span> <span class="n">cmap</span><span class="o">==</span><span class="s1">&#39;rainbow&#39;</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">cmap</span><span class="o">==</span><span class="s1">&#39;magic&#39;</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;mode&#39;</span><span class="p">,</span> <span class="n">levels_mode</span><span class="p">)</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;stretcher&#39;</span><span class="p">,</span> <span class="s1">&#39;reduced_green&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;fill_method&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;contourf&#39;</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;contourf&#39;</span><span class="p">:</span>
                    <span class="n">dict_check_defaults</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lstretch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rstretch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="s1">&#39;cmap_&#39;</span><span class="o">+</span><span class="n">cmap</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">Colormap</span><span class="p">):</span>

            <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">errmode</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Luminosity</span>
        <span class="k">if</span> <span class="n">lum</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lum</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
        <span class="k">if</span> <span class="n">tint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lum</span> <span class="o">=</span> <span class="n">tint</span><span class="o">*.</span><span class="mi">5</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span>
        <span class="k">if</span> <span class="n">lum</span> <span class="o">!=</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">change_luminosity</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">lum</span><span class="p">)</span>


        <span class="c1"># Saturation</span>
        <span class="k">if</span> <span class="n">sat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">change_saturation</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">sat</span><span class="p">)</span>

        <span class="c1"># Pastelisation</span>
        <span class="k">if</span> <span class="n">pastel</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">pastelise</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cmap</span> <span class="o">=</span> <span class="n">cmap</span>
        <span class="k">return</span> <span class="n">cmap</span></div>
<div class="viewcode-block" id="ScalarMappable.set_cmap"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.set_cmap">[docs]</a>    <span class="k">def</span> <span class="nf">set_cmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`cmap`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="p">)</span></div>
<div class="viewcode-block" id="ScalarMappable.del_cmap"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.del_cmap">[docs]</a>    <span class="k">def</span> <span class="nf">del_cmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`cmap`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;cmap&#39;</span><span class="p">)</span></div>
    <span class="n">cmap</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_cmap</span><span class="p">,</span> <span class="n">set_cmap</span><span class="p">,</span>
        <span class="n">del_cmap</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Colomap to use for filled plots and colorbar.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="ScalarMappable.get_cblabel"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.get_cblabel">[docs]</a>    <span class="k">def</span> <span class="nf">get_cblabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`cblabel`&quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_cblabel&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fmt_lnu</span><span class="p">(</span><span class="n">long_name</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span> <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strfill_</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="s1">&#39;cblabel pattern&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="ScalarMappable.set_cblabel"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.set_cblabel">[docs]</a>    <span class="k">def</span> <span class="nf">set_cblabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`cblabel`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cblabel</span> <span class="o">=</span> <span class="n">label</span></div>
<div class="viewcode-block" id="ScalarMappable.del_cblabel"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.del_cblabel">[docs]</a>    <span class="k">def</span> <span class="nf">del_cblabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`cblabel`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_cblabel&#39;</span><span class="p">):</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cblabel</span></div>
    <span class="n">cblabel</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_cblabel</span><span class="p">,</span> <span class="n">set_cblabel</span><span class="p">,</span>
        <span class="n">del_cblabel</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Preformed label of the colorbar. &#39;</span>
        <span class="s1">&#39;It may be formed as a template using other attributes &#39;</span>
        <span class="s1">&#39;like :attr:`long_name`, :attr:`units`,  :attr:`xmin`,  etc.&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="ScalarMappable.get_scalar_mappable"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.get_scalar_mappable">[docs]</a>    <span class="k">def</span> <span class="nf">get_scalar_mappable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the current scalar mappable or ``None``</span>

<span class="sd">        It is useful for instance for :meth:`colorbar`.</span>

<span class="sd">        .. note:</span>

<span class="sd">            The scalar mappable is search for in current instance only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;scalar_mappable&#39;</span><span class="p">)</span></div>
    <span class="n">get_sm</span> <span class="o">=</span> <span class="n">get_scalar_mappable</span>

<div class="viewcode-block" id="ScalarMappable.get_colorbar"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.get_colorbar">[docs]</a>    <span class="k">def</span> <span class="nf">get_colorbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the current colorbar object        &quot;&quot;&quot;</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;colorbar&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cb</span></div>

<span class="c1">#    def get_colorbars(self):</span>
<span class="c1">#        &quot;&quot;&quot;Get the colorbar of all brothers&quot;&quot;&quot;</span>
<span class="c1">#        return [b.get_colorbar()</span>
<span class="c1">#            for b in self.get_brothers(notme=False, mefirst=True)</span>
<span class="c1">#                if cb is not None]</span>

<div class="viewcode-block" id="ScalarMappable.colorbar"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.colorbar">[docs]</a>    <span class="k">def</span> <span class="nf">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ticklabels_nmax</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a colorbar</span>

<span class="sd">        The colorbar is drawn only if :meth:`get_scalar_mappable` returns a valid</span>
<span class="sd">        scalar mappable.</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **cax**, optional: Axes for the colorbar.</span>
<span class="sd">            - **label_&lt;param&gt;**, optional: &lt;param&gt; is passed to</span>
<span class="sd">              :meth:`~matplotlib.colorbar.Colorbar.set_label`.</span>
<span class="sd">            - **ticklabels_&lt;param&gt;**, optional: &lt;param&gt; is set as a property</span>
<span class="sd">              of tick labels.</span>
<span class="sd">            - Other keywords are passed to the :meth:`matplotlib.figure.Figure.colorbar`</span>
<span class="sd">              method.</span>

<span class="sd">        :See also: :meth:`get_colorbar` :meth:`get_scalar_mappable`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get scalar mappable</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scalar_mappable</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>

        <span class="c1"># Check if already plotted</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_colorbar</span><span class="p">()</span>
        <span class="n">kwcmap</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;cmap&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># Update</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="o">**</span><span class="n">kwcmap</span><span class="p">))</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">get_clim</span><span class="p">())</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">update_normal</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cb</span>

        <span class="c1"># Plot</span>
        <span class="n">kwtl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;ticklabels&#39;</span><span class="p">)</span>
        <span class="n">kwl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="c1"># - levels</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span>
        <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">levels</span><span class="p">)</span>
        <span class="c1"># - extend</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;extend&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;extend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_extend_</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">get_clim</span><span class="p">())</span>
        <span class="c1"># - axes</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">cax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>
        <span class="c1"># - plot it</span>
<span class="c1">#        print kwargs</span>
<span class="c1">#        xxx</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># - fit to axes limits</span>
        <span class="k">if</span> <span class="n">fit</span><span class="p">:</span>
            <span class="n">axbbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="n">caxbbox</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="nb">print</span> <span class="s1">&#39;avant&#39;</span><span class="p">,</span> <span class="n">axbbox</span><span class="p">,</span> <span class="n">caxbbox</span>
            <span class="k">if</span> <span class="n">cb</span><span class="o">.</span><span class="n">orientation</span><span class="o">==</span><span class="s1">&#39;horizontal&#39;</span><span class="p">:</span>
                <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">axbbox</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">caxbbox</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">axbbox</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">caxbbox</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">caxbbox</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">axbbox</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">caxbbox</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">axbbox</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
            <span class="nb">print</span> <span class="s1">&#39;apres&#39;</span><span class="p">,</span> <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="c1"># - ticks</span>
        <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;format&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">samp</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span><span class="o">/</span><span class="n">ticklabels_nmax</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">samp</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">levels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="n">samp</span><span class="p">:</span>
                        <span class="n">levels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">kwtl</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span> <span class="k">if</span> <span class="n">cb</span><span class="o">.</span><span class="n">orientation</span><span class="o">==</span><span class="s1">&#39;horizontal&#39;</span> <span class="k">else</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;axis&#39;</span><span class="p">)</span>
                <span class="n">P</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwtl</span><span class="p">)</span>
        <span class="c1"># - label</span>
        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cblabel</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwl</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;colorbar&#39;</span><span class="p">,</span> <span class="n">cb</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_get_extend_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clim</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;clim: sm.get_clim() or self.levels&quot;&quot;&quot;</span>
        <span class="n">cmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">clim</span><span class="p">)</span>
        <span class="n">cmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">clim</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">cmin</span><span class="o">&gt;</span><span class="n">vmin</span> <span class="ow">and</span> <span class="n">cmax</span><span class="o">&lt;</span><span class="n">vmax</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;both&#39;</span>
        <span class="k">if</span> <span class="n">cmin</span><span class="o">&gt;</span><span class="n">vmin</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;min&#39;</span>
        <span class="k">if</span> <span class="n">cmax</span><span class="o">&lt;</span><span class="n">vmax</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;max&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;neither&#39;</span>

<div class="viewcode-block" id="ScalarMappable.post_plot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.ScalarMappable.post_plot">[docs]</a>    <span class="k">def</span> <span class="nf">post_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">savefigs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **colorbar**, optional: Plot the colorbar.</span>
<span class="sd">            - **colorbar_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.ScalarMappable.colorbar`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Keywords</span>
        <span class="n">kw</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">kwtype</span> <span class="ow">in</span> <span class="s1">&#39;savefig&#39;</span><span class="p">,</span> <span class="s1">&#39;savefigs&#39;</span><span class="p">,</span> <span class="s1">&#39;show&#39;</span><span class="p">,</span> <span class="s1">&#39;colorbar&#39;</span><span class="p">:</span>
            <span class="n">kw</span><span class="p">[</span><span class="n">kwtype</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">kwtype</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>

        <span class="c1"># Base stuff</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">savefigs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">Plot</span><span class="o">.</span><span class="n">post_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Colorbar</span>
        <span class="k">if</span> <span class="s1">&#39;extend&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;colorbar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;extend&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;extend&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;colorbar&#39;</span><span class="p">])</span>

        <span class="c1"># Save it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;savefig&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">savefigs</span><span class="p">(</span><span class="n">savefigs</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;savefigs&#39;</span><span class="p">])</span>

        <span class="c1"># Show or close</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;show&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">close</span><span class="p">:</span>
            <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="Curve"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Curve">[docs]</a><span class="k">class</span> <span class="nc">Curve</span><span class="p">(</span><span class="n">Plot1D</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for plotting simple curve</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **data**: Data to plot. It may be a single variable or tuple.</span>
<span class="sd">          It a tuple is passed, here are the possible forms:</span>

<span class="sd">            - ``(M,)``: Simple scalar.</span>
<span class="sd">            - ``(U,V)``: Vector coordinates and the modulus is plotted.</span>
<span class="sd">            - ``(M,U,V)``: Modulus and vector coordinates and</span>
<span class="sd">              only the modulus is used and plotted.</span>

<span class="sd">        - **parg**, optional: Argument passed to :func:`~matplotlib.pyplot.plot`</span>
<span class="sd">          after the data.</span>
<span class="sd">        - **Specific plot params**: See :meth:`plot`.</span>
<span class="sd">        - **Other generic params**: See :class:`Plot`.</span>


<span class="sd">    :Example:</span>

<span class="sd">        &gt;&gt;&gt; c = Curve(mydata, xmin=3, plot=False)</span>
<span class="sd">        &gt;&gt;&gt; c.ymax = 5.</span>
<span class="sd">        &gt;&gt;&gt; c.plot(&#39;-r&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.post_plot(savefig=&#39;toto.png&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Curve.load_data"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Curve.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check order of data</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **data**: A :mod:`MV2` 1D array.</span>

<span class="sd">        :See also: :meth:`Plot.load_data`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Plot</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Curve.plot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Curve.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nosingle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_between</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot of data as a curve</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **parg**, optional: Argument passed to :func:`~matplotlib.pyplot.plot`</span>
<span class="sd">              after the data.</span>
<span class="sd">            - **nosingle**, optional: Single point with missing data around</span>
<span class="sd">              are not plotted.</span>
<span class="sd">            - **fill_between**, optional: Plot curve using</span>
<span class="sd">              :func:`~matplotlib.pyplot.fill_between`.</span>
<span class="sd">              Reference value defaults to 0. and may be given</span>
<span class="sd">              provided by the parameter.</span>
<span class="sd">            - **fill_between_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :func:`~matplotlib.pyplot.fill_between`.</span>
<span class="sd">            - **err**, optional: Errors as ``(2,nx)`` array to add to the plot</span>
<span class="sd">              using :func:`~matplotlib.pyplot.errorbar`.</span>
<span class="sd">            - **err_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :func:`~matplotlib.pyplot.errorbar`.</span>
<span class="sd">            - **label**, optional: Alternative label for the plot</span>
<span class="sd">              (see also :attr:`~vacumm.misc.core_plot.Plot.label`).</span>
<span class="sd">            - **shadow**, optional: A shadow is plotted below the line and points.</span>
<span class="sd">            - **shadow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.Plot.add_shadow`.</span>
<span class="sd">            - **glow**, optional: A glow effect is plotted below the line and points.</span>
<span class="sd">            - **glow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.Plot.add_glow`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_valid_data</span><span class="p">():</span> <span class="k">return</span>

        <span class="c1"># Data</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(</span><span class="n">scalar</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">(</span><span class="n">scalar</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">err</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cdms2</span><span class="o">.</span><span class="n">isVariable</span><span class="p">(</span><span class="n">err</span><span class="p">):</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">asma</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">egood</span> <span class="o">=</span> <span class="o">~</span><span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmaskarray</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">egood</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">egood</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                    <span class="n">egood</span> <span class="o">=</span> <span class="n">egood</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;</span><span class="n">egood</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">err</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
                    <span class="n">egood</span> <span class="o">=</span> <span class="n">egood</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">egood</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">err</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="n">err</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">!=</span><span class="nb">len</span><span class="p">(</span><span class="n">xx</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Error array must be 1D and of size </span><span class="si">%i</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">xx</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

        <span class="c1"># Plot keywords</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>
        <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwsh</span><span class="p">,</span> <span class="n">kwgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>
        <span class="n">kwerr</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;err&#39;</span><span class="p">)</span>
        <span class="n">kwfb</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;fill_between&#39;</span><span class="p">)</span>
        <span class="n">kwline</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">line_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,</span><span class="s1">&#39;markerwidth&#39;</span><span class="p">,</span><span class="s1">&#39;drawstyle&#39;</span><span class="p">]</span>
        <span class="n">marker_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;markeredgecolor&#39;</span><span class="p">,</span><span class="s1">&#39;markeredgesize&#39;</span><span class="p">,</span><span class="s1">&#39;markersize&#39;</span><span class="p">,</span><span class="s1">&#39;markerfacecolor&#39;</span><span class="p">,</span><span class="s1">&#39;marker&#39;</span><span class="p">,</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span>
        <span class="n">line_keys</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">marker_keys</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">line_keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwline</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">parg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parg</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">parg</span> <span class="o">=</span> <span class="p">[</span><span class="n">parg</span><span class="p">]</span>
        <span class="n">kwline</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">label</span>

        <span class="c1"># Plot func</span>
        <span class="k">if</span> <span class="n">log</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
                <span class="n">pfunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">semilogy</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pfunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">semilogx</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pfunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">plot</span>

        <span class="c1"># Plot</span>

        <span class="c1"># - main</span>
        <span class="n">ll</span> <span class="o">=</span> <span class="n">pfunc</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="o">*</span><span class="n">parg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwline</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;curve&#39;</span><span class="p">,</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="s1">&#39;plot&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># - fill_between</span>
        <span class="k">if</span> <span class="n">fill_between</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">kwfb</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="n">ll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">()</span><span class="o">-</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="n">kwfb</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">kwfb</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;interpolate&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">in</span> <span class="n">kwline</span><span class="p">:</span>
                <span class="n">kwfb</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">kwline</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>
            <span class="n">b0</span> <span class="o">=</span> <span class="n">yy</span>
            <span class="k">if</span> <span class="n">fill_between</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">fill_between</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">b1</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">elif</span> <span class="n">N</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fill_between</span><span class="p">)</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">b0</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">fill_between</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
                <span class="n">ff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwfb</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwfb</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_obj</span><span class="p">(</span><span class="s1">&#39;fill_between&#39;</span><span class="p">,</span> <span class="n">ff</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span> <span class="s1">&#39;fill_between&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># - error</span>
        <span class="k">if</span> <span class="n">err</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwerr</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ecolor&#39;</span><span class="p">,</span> <span class="n">ll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
            <span class="n">kwerr</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;elinewidth&#39;</span><span class="p">,</span> <span class="n">ll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_linewidth</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">kwerr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">kwerr</span><span class="p">[</span><span class="s1">&#39;zorder&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">kwerr</span><span class="p">[</span><span class="s1">&#39;zorder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">()</span> <span class="o">-</span> <span class="n">kwerr</span><span class="p">[</span><span class="s1">&#39;zorder&#39;</span><span class="p">]</span>
            <span class="n">ee</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">egood</span><span class="p">),</span> <span class="n">yy</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">egood</span><span class="p">),</span>
                <span class="n">err</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">egood</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwerr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">ee</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># - filters</span>
        <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span> <span class="s1">&#39;lines_shadow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span> <span class="c1"># &#39;lines_shadow&#39;</span>
            <span class="k">if</span> <span class="n">err</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">ee</span><span class="p">,</span> <span class="s1">&#39;error_shadow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span> <span class="c1"># &#39;error_shadow&#39;</span>
        <span class="k">if</span> <span class="n">glow</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span> <span class="s1">&#39;lines_glow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span> <span class="c1"># &#39;lines_glow&#39;</span>
            <span class="k">if</span> <span class="n">err</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">ee</span><span class="p">,</span> <span class="s1">&#39;error_glow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span> <span class="c1"># &#39;error_glow&#39;</span>
        <span class="c1"># - single dots</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">nosingle</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="mi">2</span><span class="p">:]]:</span>
                <span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="mi">1</span><span class="o">-</span><span class="n">m</span>
            <span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">mask</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">mask</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">N</span><span class="o">.</span><span class="n">sometrue</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">mask</span><span class="p">):</span>
                <span class="n">kwmark</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">marker_keys</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                        <span class="n">kwmark</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">):</span> <span class="n">kwmark</span><span class="p">[</span><span class="s1">&#39;zorder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;zorder&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xtype</span><span class="o">!=</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
                    <span class="n">xx</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">yy</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
                <span class="n">kwmark</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">ll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
                <span class="n">dots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwmark</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">dots</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;lines_dots&#39;</span><span class="p">,</span> <span class="s1">&#39;plot&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">dots</span><span class="p">,</span> <span class="s1">&#39;lines_dots_shadow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span> <span class="c1"># &#39;lines_dots_shadow&#39;</span>
                <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">dots</span><span class="p">,</span> <span class="s1">&#39;lines_dots_glow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span> <span class="c1"># &#39;lines_dots_glow&#39;</span></div></div>



<div class="viewcode-block" id="Bar"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Bar">[docs]</a><span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="n">Plot1D</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for plotting simple curve</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **data**: 1D array.</span>
<span class="sd">        - **Specific plot params**: See :meth:`plot`.</span>
<span class="sd">        - **Other generic params**: See :class:`Plot`.</span>


<span class="sd">    :Example:</span>

<span class="sd">        &gt;&gt;&gt; c = Bar(mydata, xwidth=.8, plot=False, order=&#39;zd&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.ymax = 5.</span>
<span class="sd">        &gt;&gt;&gt; c.plot()</span>
<span class="sd">        &gt;&gt;&gt; c.post_plot(savefig=&#39;rain.png&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Bar.plot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Bar.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">lag</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot data as bar plot</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **width**, optional: Relative width of the bars(``0&lt;width&lt;1``).</span>
<span class="sd">              a width of ``1`` means that successive are bars are joined.</span>
<span class="sd">            - **lag**, optional: Relative lag to apply to the position</span>
<span class="sd">            - **align**, optional: Alignment relative to coordinates.</span>
<span class="sd">            - **shadow**, optional: Add a shadow to the bars.</span>
<span class="sd">            - **shadow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :meth:`add_shadow`.</span>
<span class="sd">            - **glow**, optional: Add a glow effect to the bars.</span>
<span class="sd">            - **glow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :meth:`add_shadow`.</span>
<span class="sd">            - **offset**, optional: Bars start at ``offset``.</span>
<span class="sd">            - **label**, optional: Alternative label for the plot</span>
<span class="sd">              (see also :attr:`~Plot.label`).</span>
<span class="sd">            - **bar_&lt;param&gt;**, optional: ``param`` is passed to :func:`matplotlib.pyplot.bar` (or :func:`matplotlib.pyplot.barh`).</span>

<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; Bar(rain1).plot(width=.45, align=&#39;left&#39;, color=&#39;cyan&#39;)</span>
<span class="sd">            &gt;&gt;&gt; Bar(rain2).plot(width=.45, lag=.5, align=&#39;left&#39;, color=&#39;b&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_valid_data</span><span class="p">():</span> <span class="k">return</span>

        <span class="c1"># Data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis_data</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">meshbounds</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">widths</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
        <span class="n">axis</span> <span class="o">+=</span> <span class="n">widths</span><span class="o">*</span><span class="p">(</span><span class="n">lag</span> <span class="k">if</span> <span class="n">lag</span> <span class="k">else</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">widths</span> <span class="o">*=</span> <span class="n">width</span>
        <span class="k">if</span> <span class="n">cdms2</span><span class="o">.</span><span class="n">isVariable</span><span class="p">(</span><span class="n">offset</span><span class="p">):</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span><span class="o">.</span><span class="n">asma</span><span class="p">()</span>

        <span class="c1"># Plot keywords</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;shadow_&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;glow_&#39;</span><span class="p">)</span>
        <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwsh</span><span class="p">,</span> <span class="n">kwgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>
        <span class="n">kwbar</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;bar_&#39;</span><span class="p">)</span>
        <span class="n">bar_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,</span><span class="s1">&#39;markerwidth&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">,</span>  <span class="s1">&#39;log&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">bar_keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="n">kwbar</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">kwbar</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span>   <span class="bp">self</span><span class="o">.</span><span class="n">label</span>  <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">label</span>

        <span class="c1"># Log data</span>
        <span class="k">if</span> <span class="n">kwbar</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="o">&lt;=</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span> <span class="k">return</span>

        <span class="c1"># Plot</span>
        <span class="c1"># - main</span>
        <span class="n">func_name</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;h&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xtype</span><span class="o">==</span><span class="s1">&#39;d&#39;</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">plot_func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">func_name</span><span class="p">)</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">plot_func</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="o">**</span><span class="n">kwbar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;patches&#39;</span><span class="p">,</span> <span class="n">func_name</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># - filters</span>
        <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="QuiverKey"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.QuiverKey">[docs]</a><span class="k">class</span> <span class="nc">QuiverKey</span><span class="p">:</span>

<div class="viewcode-block" id="QuiverKey.quiverkey"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.QuiverKey.quiverkey">[docs]</a>    <span class="k">def</span> <span class="nf">quiverkey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qv</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_mode</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a quiver key to the plot</span>

<span class="sd">        See :meth:`Plot.quiverkey` for arguments.</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **qv**: Results of :func:`~matplotlib.pyplot.quiver`.</span>
<span class="sd">            - **pos**, optional: Position of key for arrow .</span>
<span class="sd">            - **text**, optional: Text or format with variables &#39;value&#39; and &#39;units&#39;.</span>
<span class="sd">            - **value**, optional: Numeric value for key (used by text).</span>
<span class="sd">            - **units**, optional: Units for key (used by text).</span>
<span class="sd">            - **latex_units**, optional: Interpret units using latex.</span>
<span class="sd">            - Extra keywords are passed to :func:`~matplotlib.pyplot.quiverkey`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Value</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">m</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">get_quiverkey_value</span><span class="p">((</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">value_mode</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">m</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span>

        <span class="k">return</span> <span class="n">Plot</span><span class="o">.</span><span class="n">quiverkey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qv</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Stick"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Stick">[docs]</a><span class="k">class</span> <span class="nc">Stick</span><span class="p">(</span><span class="n">QuiverKey</span><span class="p">,</span> <span class="n">ScalarMappable</span><span class="p">,</span> <span class="n">Curve</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for makeing a stick plot (vectors on a line)</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **udata**: 1D array of intensities along X.</span>
<span class="sd">        - **vdata**: 1D array of intensities along V.</span>
<span class="sd">        - **Specific data loading params**: See :meth:`load_data`.</span>
<span class="sd">        - **Specific plot params**: See :meth:`plot`.</span>
<span class="sd">        - **Specific plot finalization params**: See :meth:`~vacumm.misc.core_plot.ScalarMappable.post_plot`.</span>
<span class="sd">        - **Generic  params**: See :class:`Plot`.</span>


<span class="sd">    :Example:</span>

<span class="sd">        &gt;&gt;&gt; c = Stick(u10, v10, savefig=&#39;cart.png&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c = Stick(r, theta, polar=True,width=.8, plot=False, order=&#39;zd&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c.plot()</span>
<span class="sd">        &gt;&gt;&gt; c.post_plot(savefig=&#39;polar.png&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="c1">#    _primary_attributes = Plot._primary_attributes + [&#39;levels&#39;, &#39;nmax&#39;, &#39;nmax_levels&#39;, &#39;cmap&#39;]</span>
<span class="c1">#    _secondary_attributes = Plot._secondary_attributes + [&#39;cblabel&#39;]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">udata</span><span class="p">,</span> <span class="n">vdata</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">Curve</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">udata</span><span class="p">,</span> <span class="n">vdata</span><span class="p">),</span> <span class="n">polar</span><span class="o">=</span><span class="n">polar</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="n">degrees</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="c1"># Polar case</span>
<div class="viewcode-block" id="Stick.load_data"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Stick.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load variables</span>

<span class="sd">        :Special params:</span>

<span class="sd">            - **udata**: X or radial component of arrows.</span>
<span class="sd">            - **vdata**: Y or directional component of arrows.</span>
<span class="sd">            - **polar**, optional: Consider polar coordinates: ``(u, v) -&gt; (rho, theta)``</span>
<span class="sd">            - **degrees**, optional: If True (default), trat ``theta`` as degrees, else radians.</span>

<span class="sd">        :Tasks:</span>

<span class="sd">            #. Calls :meth:`Plot.load_data`.</span>
<span class="sd">            #. Deals with polar case, if keyword ``polar==True``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">polar</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;polar&#39;</span><span class="p">)</span>
        <span class="n">degrees</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;degrees&#39;</span><span class="p">)</span>
        <span class="n">Curve</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">polar</span><span class="p">:</span>
            <span class="n">m</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">u</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span> <span class="k">if</span> <span class="n">degrees</span> <span class="k">else</span> <span class="n">v</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">MV2</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">MV2</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">angle</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">):</span>
                <span class="n">u</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">units</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">):</span>
                <span class="n">u</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;X component of &#39;</span><span class="o">+</span><span class="n">m</span><span class="o">.</span><span class="n">long_name</span>
                <span class="n">v</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;Y component of &#39;</span><span class="o">+</span><span class="n">m</span><span class="o">.</span><span class="n">long_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">m</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span></div>


    <span class="c1"># Read vector data and not modulus</span>
<div class="viewcode-block" id="Stick.get_xdata"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Stick.get_xdata">[docs]</a>    <span class="k">def</span> <span class="nf">get_xdata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Curve</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="n">scalar</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="n">masked</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span></div>
    <span class="n">get_xdata</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">Curve</span><span class="o">.</span><span class="n">get_xdata</span><span class="o">.</span><span class="vm">__doc__</span>
<div class="viewcode-block" id="Stick.get_ydata"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Stick.get_ydata">[docs]</a>    <span class="k">def</span> <span class="nf">get_ydata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Curve</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="n">scalar</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="n">masked</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span></div>
    <span class="n">get_ydata</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">Curve</span><span class="o">.</span><span class="n">get_ydata</span><span class="o">.</span><span class="vm">__doc__</span>

<div class="viewcode-block" id="Stick.plot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Stick.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mod</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">quiverkey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">headwidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headaxislength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">minshaft</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minlength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">anomaly</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Main plot</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **pos**, optional: Position of the arrow tails.</span>
<span class="sd">              It defaults to the middle of the appropriate axis.</span>
<span class="sd">            - **mod**, optional: Plot the curve of the modulus.</span>
<span class="sd">            - **mod_&lt;param&gt;***, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :meth:`Curve.plot` when plotting the modulus.</span>
<span class="sd">            - **color**: Can be either</span>

<span class="sd">                - ``&quot;mod&quot;``: The color is function of the modulus.</span>
<span class="sd">                - A normal color argument for :func:`~matplotlib.pyplot.quiver`</span>
<span class="sd">                  (single or list/array).</span>

<span class="sd">            - **line**, optional: Add a transversal line along the arrow tails.</span>
<span class="sd">            - **alpha**, optional: Opacity.</span>
<span class="sd">            - **scale**, optional: Scale of arrows</span>
<span class="sd">              (see :func:`~matplotlib.pyplot.quiver`).</span>
<span class="sd">            - **headwidth**, optional: Head width of arrows</span>
<span class="sd">              (see :func:`~matplotlib.pyplot.quiver`).</span>
<span class="sd">            - **headlength**, optional: Head length of arrows</span>
<span class="sd">              (see :func:`~matplotlib.pyplot.quiver`).</span>
<span class="sd">            - **headaxislength**, optional: Length of arrow head on axis</span>
<span class="sd">              (see :func:`~matplotlib.pyplot.quiver`).</span>
<span class="sd">            - **minlength**, optional: See :func:`~matplotlib.pyplot.quiver`.</span>
<span class="sd">            - **minshaft**, optional: See :func:`~matplotlib.pyplot.quiver`.</span>
<span class="sd">            - **quiverkey**, optional: Add key to scale arrows.</span>
<span class="sd">            - **quiverkey_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed</span>
<span class="sd">              to :meth:`~vacumm.misc.core_plot.QuiverKey.quiverkey`.</span>
<span class="sd">            - **shadow**, optional: Add a drop shadow.</span>
<span class="sd">            - **shadow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :meth:`add_shadow`</span>
<span class="sd">            - **glow**, optional: Add a drop glow effect.</span>
<span class="sd">            - **glow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to :meth:`add_glow`</span>
<span class="sd">            - **cmap**, optional: Colormap to use when ``color=&quot;mod&quot;``.</span>
<span class="sd">            - **cmap_&lt;param&gt;**, optional: Passed to</span>
<span class="sd">              meth:`~vacumm.misc.core_plot.ScalarMappable.get_cmap` to tune</span>
<span class="sd">              colormap.</span>
<span class="sd">            - **levels**, optional: Levels of values to use when ``color=&quot;mod&quot;``.</span>
<span class="sd">            - **levels_&lt;param&gt;**, optional: Passed to</span>
<span class="sd">              meth:`~vacumm.misc.core_plot.ScalarMappable.get_levels` to tune levels.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_valid_data</span><span class="p">():</span> <span class="k">return</span>

        <span class="c1"># Keywords</span>
        <span class="n">kwmod</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;mod_&#39;</span><span class="p">)</span>
        <span class="n">kwqv</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;quiver_&#39;</span><span class="p">)</span>
        <span class="n">kwqvkey</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;quiverkey_&#39;</span><span class="p">)</span>
        <span class="n">kwline</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;line_&#39;</span><span class="p">)</span>
        <span class="n">kwcmap</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;cmap_&#39;</span><span class="p">)</span>
        <span class="n">kwlevels</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;levels_&#39;</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">anomaly</span><span class="o">=</span><span class="n">anomaly</span><span class="p">))</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow_&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;glow_&#39;</span><span class="p">)</span>
        <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwsh</span><span class="p">,</span> <span class="n">kwgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>
        <span class="n">kwqv</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">label</span>

        <span class="c1"># Cmap and levels</span>
        <span class="n">numcolors</span> <span class="o">=</span> <span class="n">color</span><span class="o">==</span><span class="s1">&#39;mod&#39;</span> <span class="ow">or</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> \
            <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">color</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span><span class="o">!=</span><span class="s1">&#39;S&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">numcolors</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_levels</span><span class="p">(</span><span class="o">**</span><span class="n">kwlevels</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="n">levels</span>
<span class="c1">#            color = None</span>
            <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwcmap</span><span class="p">)</span>

        <span class="c1"># Add modulus</span>
        <span class="k">if</span> <span class="n">mod</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">att</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">kwmod</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">att</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="n">att</span><span class="p">))</span>
<span class="c1">#            if color is not None and isinstance(kwmod[&#39;color&#39;], (list, N.ndarray)):</span>
            <span class="k">if</span> <span class="n">kwmod</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwmod</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
                <span class="n">kwmod</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwmod</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">Curve</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwmod</span><span class="p">)</span>

        <span class="c1"># Data</span>
        <span class="n">mm</span><span class="p">,</span> <span class="n">uu</span><span class="p">,</span> <span class="n">vv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Coordinates</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ycenter&#39;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="c1"># compat</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ytype</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">xx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">()</span>
            <span class="n">yy</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span><span class="o">+</span><span class="n">pos</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">yy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()</span>
            <span class="n">xx</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">yy</span><span class="p">))</span><span class="o">+</span><span class="n">pos</span>

        <span class="c1"># Plot</span>
        <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">,</span> <span class="s1">&#39;headlength&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">,</span>
            <span class="s1">&#39;headlength&#39;</span><span class="p">,</span> <span class="s1">&#39;headaxislength&#39;</span><span class="p">,</span> <span class="s1">&#39;minshaft&#39;</span><span class="p">,</span> <span class="s1">&#39;minlength&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="s1">&#39;scale&#39;</span><span class="p">]:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">att</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwqv</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">att</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="n">att</span><span class="p">))</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">uu</span><span class="p">,</span> <span class="n">vv</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<span class="c1">#            kwqv[&#39;vmin&#39;] = self.vmin</span>
<span class="c1">#            kwqv[&#39;vmax&#39;] = self.vmax</span>
            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span>
            <span class="n">kwqv</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">numcolors</span><span class="p">:</span> <span class="c1"># numerical values for colors</span>
            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">kwqv</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">kwqv</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="n">qv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwqv</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;quiver&#39;</span><span class="p">,</span> <span class="s1">&#39;patches&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">numcolors</span><span class="p">:</span>
            <span class="n">kwqv</span><span class="p">[</span><span class="s1">&#39;cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmap</span>
            <span class="n">qv</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;scalar_mappable&#39;</span><span class="p">,</span> <span class="n">qv</span><span class="p">)</span>
            <span class="n">sel</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_sci</span><span class="p">(</span><span class="n">av</span><span class="p">)</span>
        <span class="n">qv</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

        <span class="c1"># Filters</span>
        <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">([</span><span class="n">qv</span><span class="p">],</span> <span class="s1">&#39;quiver_shadow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">([</span><span class="n">qv</span><span class="p">],</span> <span class="s1">&#39;quiver_glow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span>

        <span class="c1"># Zorder of modulus</span>
        <span class="k">if</span> <span class="n">mod</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwmod</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">):</span>
            <span class="n">oo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;lines&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;lines_shadow&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">oo</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;lines_shadow&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;lines_dot&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">oo</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;lines_dot&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;lines_dot_shadow&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">oo</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;lines_dot_shadow&#39;</span><span class="p">))</span>
            <span class="n">dz</span> <span class="o">=</span> <span class="n">qv</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">()</span><span class="o">-</span><span class="n">oo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">dz</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">oo</span><span class="p">:</span>
                    <span class="n">o</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">()</span><span class="o">+</span><span class="n">dz</span><span class="o">-.</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Quiver key</span>
        <span class="k">if</span> <span class="n">quiverkey</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quiverkey</span><span class="p">(</span><span class="n">qv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwqvkey</span><span class="p">)</span>

        <span class="c1"># Base line</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">hv</span><span class="p">,</span> <span class="n">pp</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">yy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ytype</span><span class="o">==</span><span class="s1">&#39;d&#39;</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">xx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">funcname</span> <span class="o">=</span> <span class="s1">&#39;ax</span><span class="si">%s</span><span class="s1">line&#39;</span><span class="o">%</span><span class="n">hv</span>
            <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">funcname</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="o">**</span><span class="n">kwline</span><span class="p">),</span> <span class="p">[</span><span class="n">funcname</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">qv</span></div>

<div class="viewcode-block" id="Stick.format_axes"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Stick.format_axes">[docs]</a>    <span class="k">def</span> <span class="nf">format_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;quiver&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;curve&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1">#</span>
            <span class="n">xy</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ytype</span><span class="o">==</span><span class="s1">&#39;d&#39;</span> <span class="k">else</span> <span class="s1">&#39;x&#39;</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;hide&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">xy</span><span class="o">+</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="p">[])</span>
<span class="c1">#            kwargs.setdefault(xy+&#39;label&#39;, &#39;&#39;)</span>
        <span class="k">return</span> <span class="n">Curve</span><span class="o">.</span><span class="n">format_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Plot2D"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D">[docs]</a><span class="k">class</span> <span class="nc">Plot2D</span><span class="p">(</span><span class="n">ScalarMappable</span><span class="p">,</span> <span class="n">QuiverKey</span><span class="p">,</span> <span class="n">Plot</span><span class="p">):</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;--&#39;</span><span class="p">]</span>
    <span class="n">_primary_attributes</span> <span class="o">=</span> <span class="n">ScalarMappable</span><span class="o">.</span><span class="n">_primary_attributes</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;fill&#39;</span><span class="p">]</span>
    <span class="n">_secondary_attributes</span> <span class="o">=</span> <span class="n">ScalarMappable</span><span class="o">.</span><span class="n">_secondary_attributes</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;cblabel&#39;</span><span class="p">]</span>
    <span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_plotter</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_set_axes_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xatts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yatts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">x2d</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y2d</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x2db</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y2db</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change axes and their attributes of the variables</span>

<span class="sd">        The main goal is to deal 2D plots on special grids where the grid</span>
<span class="sd">        cannot be properly stored internally in variables (like a section grid).</span>


<span class="sd">        :Params:</span>

<span class="sd">            - **x/yaxis**, optional: 1D or 2D array or axes to use for axis,</span>
<span class="sd">              instead of internal axes of input variables.</span>
<span class="sd">            - **x/y2d**, optional: (ny,nx) array of cell center coordinates.</span>
<span class="sd">            - **x/y2db**, optional: (ny+1,nx+1) array of cell bounds coordinates</span>
<span class="sd">              used in pcolor like plots.</span>
<span class="sd">            - **x/yatts**, optional: Dictionnary of alter given ``x/yaxis``.</span>

<span class="sd">        &quot;&quot;&quot;</span>



        <span class="c1"># Get axes and adjust order</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">xaxis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">yaxis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>

            <span class="c1"># Adjust order</span>
            <span class="k">for</span> <span class="n">ivar</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
                <span class="n">order</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">getOrder</span><span class="p">()</span>
                <span class="c1">#self.data[ivar] = var2d(var, xaxis, yaxis, xatts=xatts, yatts=yatts)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">yaxis</span><span class="p">,</span> <span class="n">xaxis</span><span class="p">]):</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">order</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">c</span><span class="o">!=</span><span class="s1">&#39;-&#39;</span><span class="p">:</span> <span class="n">order</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
                <span class="n">set_order</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ivar</span><span class="p">],</span> <span class="n">order</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ivar</span><span class="p">]</span><span class="o">.</span><span class="n">_nogridorder</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
            <span class="n">xax</span> <span class="o">=</span> <span class="n">get_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">yax</span> <span class="o">=</span> <span class="n">get_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xaxis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
                <span class="n">xaxis</span> <span class="o">=</span> <span class="n">xax</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;No xaxis data available&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">isaxis</span><span class="p">(</span><span class="n">xaxis</span><span class="p">):</span>
            <span class="n">xaxis</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
                <span class="n">cp_atts</span><span class="p">(</span><span class="n">xax</span><span class="p">,</span> <span class="n">xaxis</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">yaxis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
                <span class="n">yaxis</span> <span class="o">=</span> <span class="n">yax</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;No yaxis data available&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">isaxis</span><span class="p">(</span><span class="n">yaxis</span><span class="p">):</span>
            <span class="n">yaxis</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yaxis</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
                <span class="n">cp_atts</span><span class="p">(</span><span class="n">yax</span><span class="p">,</span> <span class="n">yaxis</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Change attributes</span>
        <span class="k">if</span> <span class="n">xatts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">set_atts</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">xatts</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">yatts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">set_atts</span><span class="p">(</span><span class="n">yaxis</span><span class="p">,</span> <span class="n">yatts</span><span class="p">)</span>

        <span class="c1"># Set axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">xaxis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">yaxis</span>

        <span class="c1"># Mesh form</span>
        <span class="n">xdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># - centers</span>
        <span class="k">if</span> <span class="n">x2d</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">y2d</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span> <span class="o">=</span> <span class="n">meshgrid</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x2d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x2d</span> <span class="o">=</span> <span class="n">x2d</span>
        <span class="k">if</span> <span class="n">y2d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span> <span class="o">=</span> <span class="n">y2d</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x2dr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y2dr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span> <span class="c1"># save raw values</span>
        <span class="c1"># - bounds</span>
        <span class="k">if</span> <span class="n">x2db</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">y2db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span> <span class="o">=</span> <span class="n">meshbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x2db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x2db</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x2db</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">x2db</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2db</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">x2db</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x2db</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">shift1d</span><span class="p">(</span><span class="n">x2db</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">shift1d</span><span class="p">(</span><span class="n">x2db</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">0.5</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x2db</span> <span class="o">=</span> <span class="n">x2db</span>
        <span class="k">if</span> <span class="n">y2db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">y2db</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">y2db</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y2d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">y2db</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">T</span>
            <span class="k">elif</span> <span class="n">y2db</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y2d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">shift1d</span><span class="p">(</span><span class="n">y2db</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">shift1d</span><span class="p">(</span><span class="n">y2db</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">0.5</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span> <span class="o">=</span> <span class="n">y2db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x2dbr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y2dbr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span> <span class="c1"># save raw values</span>

<div class="viewcode-block" id="Plot2D.load_data"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load data and axes</span>

<span class="sd">        :Tasks:</span>

<span class="sd">            #. Call to :meth:`Plot.load_data`.</span>
<span class="sd">            #. Compute :attr:`x2d`, :attr:`y2d`, :attr:`x2db`, :attr:`y2db`</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **data**: A single or a tuple or 2D :mod:`MV2` arrays.</span>

<span class="sd">              - Single variable: Plot 2D scalar field with contours, filled contours, pcolor or image.</span>
<span class="sd">              - 2-tuple ``(U,V)``: Plot arrows.</span>
<span class="sd">              - 3-tuple ``(M,U,V)``: Plot both scalar field ``M`` and arrows.</span>

<span class="sd">        :Specific attributes:</span>

<span class="sd">            .. attribute:: x2d</span>

<span class="sd">                2D version of the X axis data.</span>

<span class="sd">            .. attribute:: y2d</span>

<span class="sd">                2D version of the Y axis data.</span>

<span class="sd">            .. attribute:: x2db</span>

<span class="sd">                2D bounds coordinates of the X axis data.</span>

<span class="sd">            .. attribute:: y2db</span>

<span class="sd">                2D bounds coordinates of the Y axis data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">#        # Check</span>
<span class="c1">#        if data is None: return</span>

        <span class="c1"># Normal load</span>
        <span class="n">Plot</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_transpose_axes_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Normal transpose</span>
        <span class="n">Plot</span><span class="o">.</span><span class="n">_transpose_axes_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Mesh form</span>
        <span class="c1"># - centers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="o">.</span><span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x2dr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2dr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2dr</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2dr</span><span class="o">.</span><span class="n">T</span>
        <span class="c1"># - bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="o">.</span><span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x2dbr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2dbr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2dbr</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2dbr</span><span class="o">.</span><span class="n">T</span>


<div class="viewcode-block" id="Plot2D.get_xyscaler"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.get_xyscaler">[docs]</a>    <span class="k">def</span> <span class="nf">get_xyscaler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`xyscaler`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;xyscaler&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot2D.set_xyscaler"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.set_xyscaler">[docs]</a>    <span class="k">def</span> <span class="nf">set_xyscaler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scaler</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set :attr:`xyscaler`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;xyscaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot2D.del_xyscaler"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.del_xyscaler">[docs]</a>    <span class="k">def</span> <span class="nf">del_xyscaler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del :attr:`xyscaler`&quot;&quot;&quot;</span></div>
    <span class="n">xyscaler</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xyscaler</span><span class="p">,</span> <span class="n">set_xyscaler</span><span class="p">,</span>
        <span class="n">del_xyscaler</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Function to rescale  X and Y coordinates.</span>
<span class="s2">            ``None`` is returned if no scaler is available.</span>

<span class="s2">            A typical scaler is a :class:`mpl_toolkits.basemap.Basemap` or</span>
<span class="s2">            a :class:`mpl_toolkits.pyproj.Proj` instance that converts</span>
<span class="s2">            positions from degrees to meters using a geographic</span>
<span class="s2">            projection.</span>

<span class="s2">            This scaler is used by :meth:`plot_quiver` for undersampling</span>
<span class="s2">            based on resolution.</span>

<span class="s2">            :Example:</span>

<span class="s2">                &gt;&gt;&gt; xyscaler = myplot.xyscaler</span>
<span class="s2">                &gt;&gt;&gt; if xyscaler is not None:</span>
<span class="s2">                    ... x,y = myplot.xyscaler(x, y)</span>

<span class="s2">            :Return: A callable function or ``None`` if no scaling is possible</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_fill_method_</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s1">&#39;pcolormesh&#39;</span><span class="p">,</span> <span class="n">pcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nofill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fill</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="n">get_config_value</span><span class="p">(</span><span class="s1">&#39;vacumm.misc.plot&#39;</span><span class="p">,</span> <span class="s1">&#39;fill&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fill</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fill</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                    <span class="n">fill</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">fill</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;False&#39;</span><span class="p">]:</span>
                    <span class="n">fill</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fill</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;pcolor&#39;</span><span class="p">):</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;pcolormesh&#39;</span>
        <span class="k">if</span> <span class="n">nofill</span><span class="p">:</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">pcolor</span><span class="p">:</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;pcolormesh&#39;</span>
        <span class="k">elif</span> <span class="n">pcolor</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;contourf&#39;</span>
        <span class="k">elif</span> <span class="n">pcolor</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;imshow&#39;</span>
        <span class="k">if</span> <span class="n">fill</span> <span class="o">==</span> <span class="s1">&#39;nofill&#39;</span> <span class="ow">or</span> <span class="n">fill</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">elif</span> <span class="n">fill</span> <span class="o">==</span> <span class="s1">&#39;contour&#39;</span><span class="p">:</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;contourf&#39;</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fill</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">fill</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;pcolor&#39;</span><span class="p">,</span> <span class="s1">&#39;contourf&#39;</span><span class="p">,</span> <span class="s1">&#39;imshow&#39;</span><span class="p">,</span> <span class="s1">&#39;scatter&#39;</span><span class="p">][</span><span class="n">fill</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">fill</span>


<div class="viewcode-block" id="Plot2D.get_fill"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.get_fill">[docs]</a>    <span class="k">def</span> <span class="nf">get_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nofill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the :attr:`fill` attribute&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fill</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_method_</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">pcolor</span><span class="o">=</span><span class="n">pcolor</span><span class="p">,</span> <span class="n">nofill</span><span class="o">=</span><span class="n">nofill</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot2D.set_fill"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.set_fill">[docs]</a>    <span class="k">def</span> <span class="nf">set_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fill</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the :attr:`fill` attribute&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="p">)</span></div>
<div class="viewcode-block" id="Plot2D.del_fill"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.del_fill">[docs]</a>    <span class="k">def</span> <span class="nf">del_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Del the :attr:`fill` attribute&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">del_obj</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">)</span></div>
    <span class="n">fill</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_fill</span><span class="p">,</span> <span class="n">set_fill</span><span class="p">,</span> <span class="n">del_fill</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Fill method for 2D plots: &#39;pcolor&#39;, None, True, False, &#39;contourf&#39;, &#39;imshow&#39;, &#39;pcolormesh&#39;&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot2D.plot_fill"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.plot_fill">[docs]</a>    <span class="k">def</span> <span class="nf">plot_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">zorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot filled stuff</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **fill**, optional: Type filling.</span>
<span class="sd">              It defaults to ``fill`` option of the ``[vacumm.misc.plot]`` section</span>
<span class="sd">              of the configuration (see :func:`~vacumm.config.edit_config`).</span>

<span class="sd">                - ``0`` or ``&quot;no&quot;`` or ``&quot;nofill&quot;`` or ``False``: No filling.</span>
<span class="sd">                - ``1`` or ``&quot;pcolor&quot;`` or ``&quot;pcolormesh&quot;``: Fill using :func:`~matplotlib.pyplot.pcolor`</span>
<span class="sd">                  or :func:`~matplotlib.pyplot.pcolormesh`.</span>
<span class="sd">                - ``2`` or ``&quot;imshow&quot;``: Fill using :func:`~matplotlib.pyplot.imshow`.</span>
<span class="sd">                - ``3`` or ``&quot;contourf&quot;``: Fill using :func:`~matplotlib.pyplot.contourf`.</span>

<span class="sd">            - **fill_&lt;param&gt;**: ``&lt;param&gt;`` is passed to the corresponding plot function.</span>
<span class="sd">            - **nofill**, optional: Implies ``fill=0``.</span>
<span class="sd">            - **cmap**, optional: Colormap (defaults to ``&quot;magic&quot;``).</span>
<span class="sd">            - **cmap_&lt;param&gt;**, optional: Passed to</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.ScalarMappable.get_cmap` to tune</span>
<span class="sd">              colormap.</span>
<span class="sd">            - **norm**, optional: :class:`~matplotlib.colors.Normalize` instance.</span>
<span class="sd">            - **alpha**, optional: Opacity.</span>
<span class="sd">            - **shading**, optional: Shading with :func:`~matplotlib.pyplot.pcolor`.</span>
<span class="sd">            - **extend**, optional: Let&#39;s :func:`~matplotlib.pyplot.contourf` add</span>
<span class="sd">              contours to cover all data range.</span>
<span class="sd">            - **zorder**, optional: Plot order.</span>

<span class="sd">        :Tasks:</span>

<span class="sd">            #. Guess the fill method.</span>
<span class="sd">            #. Get the colormap with :meth:`~ScalarMappable.get_cmap`.</span>
<span class="sd">            #. Get the scalar data with :meth:`~Plot.get_data`.</span>
<span class="sd">            #. Calls :func:`~matplotlib.pyplot.imshow` or</span>
<span class="sd">               :func:`~matplotlib.pyplot.pcolor` or</span>
<span class="sd">               :func:`~matplotlib.pyplot.pcolormesh` or</span>
<span class="sd">               :func:`~matplotlib.pyplot.contourf`.</span>
<span class="sd">            #. Calls :func:`~matplotlib.pyplot.clabel`</span>

<span class="sd">        .. note::</span>

<span class="sd">            :meth:`~ScalarMappable.get_levels` must have been previously called.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_valid_data</span><span class="p">():</span> <span class="k">return</span>



        <span class="c1"># Keywords</span>
        <span class="n">kwfill</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;fill_&#39;</span><span class="p">)</span>
        <span class="n">kwnorm</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;norm&#39;</span><span class="p">)</span>
        <span class="n">kwcmap</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">kwlevels</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;levels_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zorder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwfill</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="p">)</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>
        <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwsh</span><span class="p">,</span> <span class="n">kwgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>

        <span class="c1"># Fill method</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fill</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fill</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="k">return</span>

        <span class="c1"># Levels</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_levels</span><span class="p">(</span><span class="o">**</span><span class="n">kwlevels</span><span class="p">)</span>

        <span class="c1"># Norm</span>
<span class="c1">#        from matplotlib.colors import Normalize</span>
        <span class="k">if</span> <span class="n">norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">color</span> <span class="k">import</span> <span class="n">StepsNorm</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">StepsNorm</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwnorm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">norm</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">levels</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">levels</span><span class="p">))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">norm</span><span class="p">,</span> <span class="n">Normalize</span><span class="p">):</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Color map</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="o">**</span><span class="n">kwcmap</span><span class="p">)</span>

        <span class="c1"># Data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Plots</span>
        <span class="k">if</span> <span class="n">fill</span> <span class="o">==</span> <span class="s1">&#39;imshow&#39;</span><span class="p">:</span>
            <span class="n">kwfill</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;origin&#39;</span><span class="p">,</span> <span class="s1">&#39;lower&#39;</span><span class="p">)</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="p">,</span>
                <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="o">**</span><span class="n">kwfill</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">alpha</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">pp</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;imshow&#39;</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">fill</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;pcolor&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fill</span><span class="o">==</span><span class="s1">&#39;pcolormesh&#39;</span><span class="p">:</span> <span class="c1"># self.mask is MV2.nomask or</span>
                <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span><span class="o">.</span><span class="n">pcolormesh</span>
                <span class="n">kwfill</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;edgecolors&#39;</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kwfill</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;edgecolors&#39;</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="n">kwfill</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span><span class="o">.</span><span class="n">pcolor</span>
            <span class="k">for</span> <span class="n">att</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">kwfill</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">att</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwfill</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">alpha</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">pp</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
                <span class="n">pp</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;pcolor&#39;</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>


        <span class="k">elif</span> <span class="n">fill</span> <span class="o">==</span> <span class="s1">&#39;contourf&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">extend</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">extend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_extend_</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
            <span class="n">dict_check_defaults</span><span class="p">(</span><span class="n">kwfill</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwfill</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;contourf&#39;</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">alpha</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">pp</span><span class="o">.</span><span class="n">collections</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">col</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>

        <span class="k">elif</span> <span class="n">fill</span> <span class="o">==</span> <span class="s1">&#39;scatter&#39;</span><span class="p">:</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
                <span class="n">c</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwfill</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">alpha</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">pp</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Wrong fill method&#39;</span><span class="p">)</span>


        <span class="c1"># Register</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">([</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;scalar_mappable&#39;</span><span class="p">],</span> <span class="n">pp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span>  <span class="s1">&#39;patches&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_sci</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span>


        <span class="c1"># Filters</span>
        <span class="k">if</span> <span class="n">shadow</span> <span class="ow">or</span> <span class="n">glow</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">collections</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="s1">&#39;collections&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">pp</span>
            <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;fill_shadow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;fill_glow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span>

        <span class="c1"># Hacks</span>
<span class="c1">#        if zorder is not None: pp.set_zorder(zorder)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="s1">&#39;edgecolors&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidths&#39;</span><span class="p">:</span>
<span class="c1">#            if hasatt(pp, &#39;set_&#39;+key):</span>
<span class="c1">#                getattr(pp, &#39;set_&#39;+key)(kwfill[key])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">kwfill</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="s1">&#39;collections&#39;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pp</span><span class="o">.</span><span class="n">collections</span><span class="p">:</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;set_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">)(</span><span class="n">kwfill</span><span class="p">[</span><span class="n">key</span><span class="p">])</span></div>
<span class="c1">#        if kwfill.has_key(&#39;edgecolor&#39;):</span>
<span class="c1">#            for p in pp.collections:</span>
<span class="c1">#                p.set_edgecolor(kwfill[&#39;edgecolor&#39;])</span>
<span class="c1">#        if kwfill.has_key(&#39;linewidth&#39;):</span>
<span class="c1">#            for p in pp.collections:</span>
<span class="c1">#                p.set_linewidth(kwfill[&#39;linewidth&#39;])</span>


<div class="viewcode-block" id="Plot2D.plot_contour"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.plot_contour">[docs]</a>    <span class="k">def</span> <span class="nf">plot_contour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">clabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot contour lines</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **contour_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :func:`~matplotlib.pyplot.contour`.</span>
<span class="sd">            - **zorder**, optional: Plot order.</span>
<span class="sd">            - **alpha**, optional: Opacity.</span>
<span class="sd">            - **linewidths**, optional: Contour linewidths.</span>
<span class="sd">            - **clabel**, optional: Add contour labels with</span>
<span class="sd">              :func:`~matplotlib.pyplot.clabel`. If not specified, it is taken from</span>
<span class="sd">              config section ``[vacumm.misc.plot]`` and config option ``clabel``.</span>
<span class="sd">            - **clabel_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :func:`~matplotlib.pyplot.clabel`..</span>
<span class="sd">            - **contour_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :func:`~matplotlib.pyplot.contour`.</span>

<span class="sd">        :Tasks:</span>

<span class="sd">            #. Get the scalar data with :meth:`~Plot.get_data`.</span>
<span class="sd">            #. Calls :func:`~matplotlib.pyplot.contour`.</span>
<span class="sd">            #. Calls :func:`~matplotlib.pyplot.clabel`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_valid_data</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="c1"># Keywords</span>

        <span class="k">if</span> <span class="n">clabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">clabel</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">get_config_value</span><span class="p">(</span><span class="s1">&#39;vacumm.misc.plot&#39;</span><span class="p">,</span> <span class="s1">&#39;clabel&#39;</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">clabel</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">get_config_value</span><span class="p">(</span><span class="s1">&#39;vacumm.misc.plot&#39;</span><span class="p">,</span> <span class="s1">&#39;clabel&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

        <span class="n">kw</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;contour&#39;</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">))</span>
        <span class="n">kwcl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;clabel&#39;</span><span class="p">)</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
        <span class="n">kwsh</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span> <span class="s1">&#39;shadow_&#39;</span><span class="p">))</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span> <span class="s1">&#39;glow_&#39;</span><span class="p">))</span>
        <span class="n">kwcmap</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#        kwcmap.update(kwfilter(kw, &#39;cmap_&#39;))</span>
        <span class="n">shadow</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;shadow&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="p">)</span>
        <span class="n">glow</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;glow&#39;</span><span class="p">,</span> <span class="n">glow</span><span class="p">)</span>
        <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwsh</span><span class="p">,</span> <span class="n">kwgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>

        <span class="c1"># Setup</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s1">&#39;fmt&#39;</span><span class="p">):</span>
            <span class="n">kwcl</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]</span>
        <span class="n">kwcl</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;fmt&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">kw</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_method</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;pcolor&#39;</span><span class="p">)</span> <span class="ow">or</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_method</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;imshow&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">kwcl</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;linewidth&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
            <span class="n">linewidths</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">linewidths</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;linewidth&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">linewidths</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">linewidths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kw</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;linewidths&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zorder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kw</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="p">)</span>

        <span class="c1"># Colors</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;cmap&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;color&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;colors&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="o">**</span><span class="n">kwcmap</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmap</span>
        <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;colors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span>

        <span class="c1"># Data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Contours</span>
        <span class="n">cc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span> <span class="n">cc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">cc</span><span class="o">.</span><span class="n">collections</span><span class="p">,</span> <span class="s1">&#39;contour_shadow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">cc</span><span class="o">.</span><span class="n">collections</span><span class="p">,</span> <span class="s1">&#39;contour_glow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span>


        <span class="c1"># Labels</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cc</span><span class="o">.</span><span class="n">collections</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwcl</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;hide&#39;</span><span class="p">,</span> <span class="ow">not</span> <span class="n">clabel</span><span class="p">):</span>
            <span class="n">kwcl</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="n">cc</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">())</span>
            <span class="n">clshadow</span> <span class="o">=</span> <span class="n">kwcl</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;shadow&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="p">)</span>
            <span class="n">kwclsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwcl</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
            <span class="n">clglow</span> <span class="o">=</span> <span class="n">kwcl</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;glow&#39;</span><span class="p">,</span> <span class="n">glow</span><span class="p">)</span>
            <span class="n">kwclgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwcl</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>
            <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwclsh</span><span class="p">,</span> <span class="n">kwclgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwcl</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;clabel&#39;</span><span class="p">,</span> <span class="n">cl</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">cl</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">cl</span><span class="p">:</span>
                <span class="n">l</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">kwcl</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])</span>
                <span class="n">l</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="n">kwcl</span><span class="p">[</span><span class="s1">&#39;zorder&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">clshadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">cl</span><span class="p">,</span> <span class="o">**</span><span class="n">kwclsh</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">clglow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">cl</span><span class="p">,</span> <span class="o">**</span><span class="n">kwclgl</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot2D.plot_quiver"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.plot_quiver">[docs]</a>    <span class="k">def</span> <span class="nf">plot_quiver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiverkey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">barbs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiver_cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">quiver_vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiver_vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">quiver_samp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiver_xsamp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiver_ysamp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiver_res</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">quiver_relres</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiver_xres</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiver_xrelres</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiver_yres</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">quiver_yrelres</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiver_res_scaler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiver_nauto</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot arrows</span>

<span class="sd">        You can undersample arrows using direct undersampling (parameters</span>
<span class="sd">        with &quot;samp&quot;) or undersampling based on resolution (using</span>
<span class="sd">        :func:`~vacumm.misc.grid.masking.resol_mask`).</span>
<span class="sd">        Resolution undersampling may be in input (like degrees) or</span>
<span class="sd">        transformed (like meters) coordinates. Transformed</span>
<span class="sd">        coordinates are deduced from input coordinates using</span>
<span class="sd">        ``quiver_res_scaler``, which defaults to :attr:`xyscaler`.</span>

<span class="sd">        .. note::</span>

<span class="sd">            Direct unsampling is incompatible with resolution undersampling:</span>
<span class="sd">            the former prevails against the latter.</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **quiver_norm**,optional: Normalize/colorize arrows</span>

<span class="sd">                - ``0`` or ``None``: No normalization, no colorization (default)</span>
<span class="sd">                - ``1``: Normalization, no colorization.</span>
<span class="sd">                - ``2``: Normalization, colorization.</span>
<span class="sd">                - ``3``: No normalization, colorization.</span>

<span class="sd">            - **quiver_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :func:`~matplotlib.pyplot.quiver`.</span>
<span class="sd">            - **barbs**, optional: Plot wind barbs instead of arrows</span>
<span class="sd">              (see :func:`~matplotlib.pyplot.barbs`).</span>
<span class="sd">            - **zorder**, optional: Plot order.</span>
<span class="sd">            - **alpha**, optional: Opacity.</span>
<span class="sd">            - **shadow**, optional: Add shadow below arrows.</span>
<span class="sd">            - **glow**, optional: Add glow effect to arrows.</span>
<span class="sd">            - **quiverkey**, optional: Add key to scale arrows.</span>
<span class="sd">            - **quiverkey_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed</span>
<span class="sd">              to :meth:`~vacumm.misc.core_plot.QuiverKey.quiverkey`.</span>
<span class="sd">            - **cmap**, optional: Colormap to use when ``color=&quot;mod&quot;`` (defaults to</span>
<span class="sd">              ``&quot;magic&quot;``).</span>
<span class="sd">            - **quiver_samp**, optional: Horizontal sampling of arrows (in both directions) [default: 1]</span>
<span class="sd">            - **quiver_x/ysamp**, optional: Sampling along X/Y [default: quiver_samp]</span>
<span class="sd">            - **quiver_res**, optional: Horizontal resolution of arrows (in both directions)</span>
<span class="sd">              for undersampling [default: None]</span>
<span class="sd">                If ``&#39;auto&#39;``, resolution is computed so as to have at max ``quiver_nauto``</span>
<span class="sd">                arrow in along an axis. If it is a :class:`complex` type, its imaginary part</span>
<span class="sd">                set the ``quiver_nauto`` parameter and ``quiver_res`` is set to ``&#39;auto&#39;``.</span>
<span class="sd">            - **quiver_x/yres**, optional: Same along X/Y [default: quiver_res]</span>
<span class="sd">            - **quiver_relres**, optional: Relative resolution (in both directions).</span>

<span class="sd">              - If &gt; 0, = ``mean(res)*relres``.</span>
<span class="sd">              - If &lt; -1, = ``min(res)*abs(relres)``.</span>
<span class="sd">              - If &lt; 0 and &gt; -1, = ``max(res)*abs(relres)``</span>

<span class="sd">            - **quiver_x/yrelres**, optional: Same along X/Y [default: quiver_relres]</span>


<span class="sd">        :Tasks:</span>

<span class="sd">            #. Get the scalar data with :meth:`~Plot.get_data`.</span>
<span class="sd">            #. Calls :func:`~matplotlib.pyplot.quiver`.</span>
<span class="sd">            #. Calls :func:`~matplotlib.pyplot.quiverkey`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_valid_data</span><span class="p">():</span> <span class="k">return</span>

        <span class="c1"># Get data</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">!=</span><span class="mi">3</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">x2d</span><span class="p">,</span> <span class="n">y2d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span>
        <span class="n">x2dr</span><span class="p">,</span> <span class="n">y2dr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2dr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2dr</span>
        <span class="n">mm</span><span class="p">,</span> <span class="n">uu</span><span class="p">,</span> <span class="n">vv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">mm</span>
        <span class="n">mm</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">uu</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vv</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Keywords</span>
        <span class="n">kwqv</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;quiver&#39;</span><span class="p">)</span><span class="c1">#, defaults=dict(angles=&#39;uv&#39;))</span>
        <span class="n">kwqvkey</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;quiverkey&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zorder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwqv</span><span class="p">[</span><span class="s1">&#39;zorder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zorder</span>
<span class="c1">#        if kwqv.has_key(&#39;width&#39;) and kwqv[&#39;width&#39;] &gt; .01:</span>
<span class="c1">#            kwqv[&#39;width&#39;] *= 0.001</span>
        <span class="n">shadow</span> <span class="o">=</span> <span class="n">kwqv</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;shadow&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="p">)</span>
        <span class="n">glow</span> <span class="o">=</span> <span class="n">kwqv</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;glow&#39;</span><span class="p">,</span> <span class="n">glow</span><span class="p">)</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwqv</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwqv</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>
        <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwsh</span><span class="p">,</span> <span class="n">kwgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>
        <span class="n">kwcmap</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scalar_mappable</span><span class="p">()</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="n">kwcmap</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwqv</span><span class="p">,</span> <span class="s1">&#39;cmap&#39;</span><span class="p">))</span>

        <span class="c1"># Undersampling</span>
        <span class="c1"># - setup</span>
        <span class="k">if</span> <span class="n">quiver_samp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">quiver_xsamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">quiver_xsamp</span> <span class="o">=</span> <span class="n">quiver_samp</span>
            <span class="k">if</span> <span class="n">quiver_ysamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">quiver_ysamp</span> <span class="o">=</span> <span class="n">quiver_samp</span>
        <span class="k">if</span> <span class="n">quiver_xsamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">quiver_xres</span> <span class="o">=</span> <span class="n">quiver_xrelres</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">quiver_ysamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">quiver_yres</span> <span class="o">=</span> <span class="n">quiver_yrelres</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># - indirect</span>
        <span class="n">rmask</span> <span class="o">=</span> <span class="n">resol_mask</span><span class="p">((</span><span class="n">x2dr</span><span class="p">,</span> <span class="n">y2dr</span><span class="p">),</span> <span class="n">res</span><span class="o">=</span><span class="n">quiver_res</span><span class="p">,</span> <span class="n">xres</span><span class="o">=</span><span class="n">quiver_xres</span><span class="p">,</span> <span class="n">yres</span><span class="o">=</span><span class="n">quiver_yres</span><span class="p">,</span>
            <span class="n">relres</span><span class="o">=</span><span class="n">quiver_relres</span><span class="p">,</span> <span class="n">xrelres</span><span class="o">=</span><span class="n">quiver_xrelres</span><span class="p">,</span> <span class="n">yrelres</span><span class="o">=</span><span class="n">quiver_yrelres</span><span class="p">,</span>
            <span class="n">scaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyscaler</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nauto</span><span class="o">=</span><span class="n">quiver_nauto</span><span class="p">)</span>

        <span class="c1"># - apply</span>
        <span class="k">if</span> <span class="n">rmask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">uu</span> <span class="o">=</span> <span class="n">uu</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">vv</span> <span class="o">=</span> <span class="n">vv</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">mm</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">uu</span><span class="p">[</span><span class="n">rmask</span><span class="p">]</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">masked</span>
            <span class="n">vv</span><span class="p">[</span><span class="n">rmask</span><span class="p">]</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">masked</span>
            <span class="n">mm</span><span class="p">[</span><span class="n">rmask</span><span class="p">]</span> <span class="o">=</span> <span class="n">MV2</span><span class="o">.</span><span class="n">masked</span>
        <span class="k">if</span> <span class="n">quiver_xsamp</span> <span class="ow">or</span> <span class="n">quiver_ysamp</span><span class="p">:</span>
            <span class="n">xslice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">quiver_xsamp</span><span class="p">)</span>
            <span class="n">yslice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">quiver_ysamp</span><span class="p">)</span>
            <span class="n">x2d</span> <span class="o">=</span> <span class="n">x2d</span><span class="p">[</span><span class="n">yslice</span><span class="p">,</span> <span class="n">xslice</span><span class="p">]</span>
            <span class="n">y2d</span> <span class="o">=</span> <span class="n">y2d</span><span class="p">[</span><span class="n">yslice</span><span class="p">,</span> <span class="n">xslice</span><span class="p">]</span>
            <span class="n">uu</span> <span class="o">=</span> <span class="n">uu</span><span class="p">[</span><span class="n">yslice</span><span class="p">,</span> <span class="n">xslice</span><span class="p">]</span>
            <span class="n">vv</span> <span class="o">=</span> <span class="n">vv</span><span class="p">[</span><span class="n">yslice</span><span class="p">,</span> <span class="n">xslice</span><span class="p">]</span>
            <span class="n">mm</span> <span class="o">=</span> <span class="n">mm</span><span class="p">[</span><span class="n">yslice</span><span class="p">,</span> <span class="n">xslice</span><span class="p">]</span>

        <span class="c1"># Norm</span>
        <span class="n">quiver_norm</span> <span class="o">=</span> <span class="n">kwqv</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;norm&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">quiver_norm</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">:</span>
            <span class="n">quiverkey</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">good</span> <span class="o">=</span> <span class="n">mm</span><span class="o">!=</span><span class="mf">0.</span>
            <span class="n">uu</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">good</span><span class="p">,</span> <span class="n">uu</span><span class="o">/</span><span class="n">mm</span><span class="p">,</span> <span class="n">uu</span><span class="p">)</span>
            <span class="n">vv</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">good</span><span class="p">,</span> <span class="n">vv</span><span class="o">/</span><span class="n">mm</span><span class="p">,</span> <span class="n">vv</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">good</span>
            <span class="n">qvargs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x2d</span><span class="p">,</span> <span class="n">y2d</span><span class="p">,</span> <span class="n">uu</span><span class="p">,</span> <span class="n">vv</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">quiver_norm</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">qvargs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qvargs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x2d</span><span class="p">,</span> <span class="n">y2d</span><span class="p">,</span> <span class="n">uu</span><span class="p">,</span> <span class="n">vv</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">quiver_norm</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">qvargs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">quiver_norm</span> <span class="o">&gt;=</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">quiver_cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">quiver_cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="o">**</span><span class="n">kwcmap</span><span class="p">)</span>
            <span class="n">kwqv</span><span class="p">[</span><span class="s1">&#39;cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">quiver_cmap</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="n">quiver_vmin</span> <span class="k">if</span> <span class="n">quiver_vmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="n">quiver_vmax</span> <span class="k">if</span> <span class="n">quiver_vmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span>
            <span class="n">kwqv</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">uu</span><span class="p">)</span><span class="o">.</span><span class="n">mask</span>
        <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">MV2</span><span class="o">.</span><span class="n">nomask</span><span class="p">:</span>
            <span class="n">good</span> <span class="o">=</span> <span class="o">~</span><span class="n">mask</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
            <span class="n">qvargs</span> <span class="o">=</span> <span class="p">[</span><span class="n">N</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">good</span><span class="p">,</span> <span class="n">qa</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> <span class="k">for</span> <span class="n">qa</span> <span class="ow">in</span> <span class="n">qvargs</span><span class="p">]</span> <span class="p">;</span> <span class="k">del</span> <span class="n">qa</span>

        <span class="c1"># Arrows</span>
        <span class="k">if</span> <span class="n">barbs</span><span class="p">:</span>
            <span class="n">quiver_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span><span class="o">.</span><span class="n">barbs</span>
            <span class="n">quiverkey</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quiver_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span><span class="o">.</span><span class="n">quiver</span>
            <span class="n">angles</span> <span class="o">=</span> <span class="s1">&#39;xy&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">uvscaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;uv&#39;</span>
            <span class="n">kwqv</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;angles&#39;</span><span class="p">,</span> <span class="n">angles</span><span class="p">)</span>
        <span class="n">qv</span> <span class="o">=</span> <span class="n">quiver_func</span><span class="p">(</span><span class="o">*</span><span class="n">qvargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwqv</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qv</span><span class="p">,</span>  <span class="nb">tuple</span><span class="p">):</span> <span class="n">qv</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">qv</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;quiver&#39;</span><span class="p">,</span> <span class="n">qv</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">qv</span><span class="p">,</span> <span class="s1">&#39;patches&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">quiver_norm</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scalar_mappable</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;scalar_mappable&#39;</span><span class="p">,</span> <span class="n">qv</span><span class="p">)</span>

        <span class="c1"># Filters</span>
        <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">qv</span><span class="p">,</span> <span class="s1">&#39;quiver_shadow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">qv</span><span class="p">,</span> <span class="s1">&#39;quiver_glow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span>

        <span class="c1"># Quiver key</span>
        <span class="k">if</span> <span class="n">quiverkey</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quiverkey</span><span class="p">(</span><span class="n">qv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwqvkey</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">qv</span></div>


<div class="viewcode-block" id="Plot2D.plot_streamplot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.plot_streamplot">[docs]</a>    <span class="k">def</span> <span class="nf">plot_streamplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">streamplot_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">streamplot_linewidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">streamplot_lwmodmin</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">streamplot_lwmodmax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">streamplot_cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">streamplot_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">streamplot_vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">streamplot_vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot stream lines with :func:`~matplotlib.pyplot.streamplot`</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **streamplot_color**,optional:</span>

<span class="sd">                - ``None`` or `&quot;default&quot;`: Default colorization.</span>
<span class="sd">                - ``&quot;modulus&quot;``: Colorization as a function of the modulus.</span>
<span class="sd">                - Else, passed directly to :func:`~matplotlib.pyplot.streamplot`</span>

<span class="sd">            - **streamplot_linewidth**,optional:</span>

<span class="sd">                - ``None`` or ``&quot;default&quot;``: Default linewidth.</span>
<span class="sd">                - ``&quot;modulus&quot;``: Linewidth proportional to the modulus with a maximum</span>
<span class="sd">                  linewidth of ``streamplot_lwmod``.</span>
<span class="sd">                - Else, passed directly to :func:`~matplotlib.pyplot.streamplot`</span>

<span class="sd">            - **streamplot_lwmodmin**, optional: Min linewidth used when ``streamplot_linewidth``</span>
<span class="sd">              is set to ``&quot;modulus&quot;``.</span>
<span class="sd">            - **streamplot_lwmodmax**, optional: Max linewidth used when ``streamplot_linewidth``</span>
<span class="sd">              is set to ``&quot;modulus&quot;``.</span>
<span class="sd">            - **streamplot_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :func:`~matplotlib.pyplot.streamplot`.</span>
<span class="sd">            - **zorder**, optional: Plot order.</span>
<span class="sd">            - **alpha**, optional: Opacity.</span>
<span class="sd">            - **shadow**, optional: Add shadow below arrows.</span>
<span class="sd">            - **glow**, optional: Add glow effect to arrows.</span>
<span class="sd">            - **streamplotkey**, optional: Add key to scale arrows.</span>
<span class="sd">            - **cmap**, optional: Colormap to use when ``color=&quot;modulus&quot;`` (defaults to</span>
<span class="sd">              ``&quot;magic&quot;``).</span>


<span class="sd">        :Tasks:</span>

<span class="sd">            #. Get the scalar data with :meth:`~Plot.get_data`.</span>
<span class="sd">            #. Calls :func:`~matplotlib.pyplot.streamplot`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_valid_data</span><span class="p">():</span> <span class="k">return</span>

        <span class="c1"># Get data</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">!=</span><span class="mi">3</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">x2d</span><span class="p">,</span> <span class="n">y2d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span>
        <span class="n">mm</span><span class="p">,</span> <span class="n">uu</span><span class="p">,</span> <span class="n">vv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">mm</span>
        <span class="n">mm</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">uu</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vv</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Keywords</span>
        <span class="n">kwsp</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;streamplot&#39;</span><span class="p">)</span><span class="c1">#, defaults=dict(angles=&#39;uv&#39;))</span>
        <span class="k">if</span> <span class="n">zorder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwsp</span><span class="p">[</span><span class="s1">&#39;zorder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zorder</span>
        <span class="k">if</span> <span class="n">kwsp</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">kwsp</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">01</span><span class="p">:</span>
            <span class="n">kwsp</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">0.001</span>
        <span class="n">shadow</span> <span class="o">=</span> <span class="n">kwsp</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;shadow&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="p">)</span>
        <span class="n">glow</span> <span class="o">=</span> <span class="n">kwsp</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;glow&#39;</span><span class="p">,</span> <span class="n">glow</span><span class="p">)</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwsp</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwsp</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>
        <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwsh</span><span class="p">,</span> <span class="n">kwgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>
        <span class="n">kwcmap</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scalar_mappable</span><span class="p">()</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="n">kwcmap</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwsp</span><span class="p">,</span> <span class="s1">&#39;cmap&#39;</span><span class="p">))</span>

        <span class="c1"># Color</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">streamplot_vmax</span> <span class="k">if</span> <span class="n">streamplot_vmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">streamplot_vmin</span> <span class="k">if</span> <span class="n">streamplot_vmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span>
        <span class="k">if</span> <span class="n">streamplot_color</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">]:</span>
            <span class="n">streamplot_color</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">streamplot_color</span><span class="o">==</span><span class="s1">&#39;modulus&#39;</span><span class="p">:</span>
            <span class="n">streamplot_color</span> <span class="o">=</span> <span class="n">mm</span>
            <span class="k">if</span> <span class="n">streamplot_cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">streamplot_cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="o">**</span><span class="n">kwcmap</span><span class="p">)</span>
            <span class="n">kwsp</span><span class="p">[</span><span class="s1">&#39;cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">streamplot_cmap</span>
            <span class="k">if</span> <span class="n">streamplot_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">streamplot_norm</span>  <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
            <span class="n">kwsp</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">streamplot_norm</span>
        <span class="n">kwsp</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">streamplot_color</span>


        <span class="c1"># Linewidth</span>
        <span class="n">streamplot_linewidth</span> <span class="o">=</span> <span class="n">kwsp</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lw&#39;</span><span class="p">,</span> <span class="n">streamplot_linewidth</span><span class="p">)</span>
        <span class="n">streamplot_lwmodmax</span> <span class="o">=</span> <span class="n">kwsp</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lwmod&#39;</span><span class="p">,</span> <span class="n">streamplot_lwmodmax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">streamplot_linewidth</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">]:</span>
            <span class="n">streamplot_linewidth</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">streamplot_linewidth</span><span class="o">==</span><span class="s1">&#39;modulus&#39;</span><span class="p">:</span>
            <span class="n">streamplot_linewidth</span> <span class="o">=</span> <span class="p">(</span><span class="n">streamplot_lwmodmin</span><span class="o">+</span>
                <span class="p">(</span><span class="n">streamplot_lwmodmax</span><span class="o">-</span><span class="n">streamplot_lwmodmin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">mm</span><span class="o">-</span><span class="n">vmin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">vmax</span><span class="o">-</span><span class="n">vmin</span><span class="p">))</span>
        <span class="n">kwsp</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">streamplot_linewidth</span>

        <span class="c1"># Lines</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">x2d</span><span class="p">,</span> <span class="n">y2d</span><span class="p">,</span> <span class="n">uu</span><span class="p">,</span> <span class="n">vv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;streamplot&#39;</span><span class="p">,</span> <span class="n">sp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">arrows</span><span class="p">,</span> <span class="s1">&#39;patches&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">lines</span><span class="p">,</span> <span class="s1">&#39;lines&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">streamplot_color</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scalar_mappable</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">arrows</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">streamplot_color</span><span class="p">)</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">arrows</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">arrows</span><span class="o">.</span><span class="n">set_norm</span><span class="p">(</span><span class="n">kwsp</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">])</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">arrows</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="n">kwsp</span><span class="p">[</span><span class="s1">&#39;cmap&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_obj</span><span class="p">(</span><span class="s1">&#39;scalar_mappable&#39;</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">arrows</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sp</span></div>

<div class="viewcode-block" id="Plot2D.plot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">anomaly</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">streamplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot filled and/or contoured content</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **levels**, optional: Levels for contouring and/or colormap.</span>
<span class="sd">            - **levels_&lt;param&gt;**, optional: Passed to</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.ScalarMappable.get_levels` to tune levels.</span>
<span class="sd">            - **contour**, optional: Plot line contours.</span>
<span class="sd">            - **streamplot**, optional: Plot stream lines instead of arrows.</span>
<span class="sd">            - Other arguments are passed to :meth:`plot_fill` and :meth:`plot_contour`.</span>

<span class="sd">        :Tasks:</span>

<span class="sd">            #. Get :attr:`~ScalarMappable.levels`.</span>
<span class="sd">            #. Calls :meth:`plot_fill`.</span>
<span class="sd">            #. Calls :meth:`plot_contour`.</span>
<span class="sd">            #. Calls :meth:`plot_quiver` or :meth:`plot_streamplot`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_valid_data</span><span class="p">():</span> <span class="k">return</span>

        <span class="c1"># Get levels</span>
        <span class="n">kwlevels</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;levels&#39;</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">anomaly</span><span class="o">=</span><span class="n">anomaly</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="n">levels</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_levels</span><span class="p">(</span><span class="o">**</span><span class="n">kwlevels</span><span class="p">)</span>

        <span class="c1"># Plotter</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>

        <span class="c1"># Fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_fill</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Contours</span>
        <span class="k">if</span> <span class="n">contour</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Quiver or stream lines</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">streamplot</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_quiver</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_streamplot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot2D.add_grid"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Plot2D.add_grid">[docs]</a>    <span class="k">def</span> <span class="nf">add_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add the coordinates as a grid with centers and corners</span>

<span class="sd">        See :func:`~vacumm.misc.plot.add_grid` for parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.plot</span> <span class="k">import</span> <span class="n">add_grid</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">xcorners</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="p">,</span> <span class="n">ycorners</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y2db</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="n">add_grid</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="s1">&#39;grid&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Hov"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Hov">[docs]</a><span class="k">class</span> <span class="nc">Hov</span><span class="p">(</span><span class="n">Plot2D</span><span class="p">):</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;zT&#39;</span><span class="p">,</span> <span class="s1">&#39;Tx&#39;</span><span class="p">,</span> <span class="s1">&#39;yT&#39;</span><span class="p">,</span> <span class="s1">&#39;T-&#39;</span><span class="p">,</span> <span class="s1">&#39;-T&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="Section"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Section">[docs]</a><span class="k">class</span> <span class="nc">Section</span><span class="p">(</span><span class="n">Plot2D</span><span class="p">):</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Zx&#39;</span><span class="p">,</span> <span class="s1">&#39;Zy&#39;</span><span class="p">]</span></div>




<div class="viewcode-block" id="Map"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map">[docs]</a><span class="k">class</span> <span class="nc">Map</span><span class="p">(</span><span class="n">Plot2D</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is used for plotting a map with or without data</span>

<span class="sd">    It uses a :class:`mpl_toolkits.basemap.Basemap` instance, stored in attribute :attr:`map`.</span>
<span class="sd">    Some other attributes: :attr:`lon`, :attr:`lat`, :attr:`map_update`.</span>

<span class="sd">    .. attribute:: map</span>

<span class="sd">        A :class:`~mpl_toolkits.basemap.Basemap` initialized in :meth:`pre_plot`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_order</span> <span class="o">=</span> <span class="s1">&#39;YX&#39;</span>
    <span class="nb">map</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_set_axes_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xatts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yatts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">Plot2D</span><span class="o">.</span><span class="n">_set_axes_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">=</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">=</span><span class="n">yaxis</span><span class="p">,</span> <span class="n">xatts</span><span class="o">=</span><span class="n">xatts</span><span class="p">,</span> <span class="n">yatts</span><span class="o">=</span><span class="n">yatts</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">xaxis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">designateLongitude</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">yaxis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">designateLatitude</span><span class="p">()</span>
    <span class="n">_set_axes_</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">Plot2D</span><span class="o">.</span><span class="n">_set_axes_</span><span class="o">.</span><span class="vm">__doc__</span>

<div class="viewcode-block" id="Map.format_axes"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.format_axes">[docs]</a>    <span class="k">def</span> <span class="nf">format_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Map.mapproj"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.mapproj">[docs]</a>    <span class="k">def</span> <span class="nf">mapproj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert from degrees to meters (or inverse)</span>

<span class="sd">        It uses attribute :attr:`map` if set to a</span>
<span class="sd">        :class:`~mpl_toolkits.basemap.Basemap` instance with</span>
<span class="sd">        a projection different from &quot;cyl&quot;.</span>
<span class="sd">        If no valid projection is found, et uses functions</span>
<span class="sd">        :func:`~vacumm.misc.phys.units.deg2m` and</span>
<span class="sd">        :func:`~vacumm.misc.phys.units.m2deg`.</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **x/y**: Coordinates in degrees or meters</span>
<span class="sd">            - **inverse**, optional: Reverse projection (meters-&gt;degrees)</span>
<span class="sd">            - **current**, optional: If True,</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">projection</span><span class="o">==</span><span class="s1">&#39;cyl&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inverse</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">m2deg</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">m2deg</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">deg2m</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">deg2m</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">)</span></div>

<div class="viewcode-block" id="Map.get_xyscaler"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.get_xyscaler">[docs]</a>    <span class="k">def</span> <span class="nf">get_xyscaler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`xyscaler`&quot;&quot;&quot;</span>
        <span class="n">xyscaler</span> <span class="o">=</span> <span class="n">Plot2D</span><span class="o">.</span><span class="n">get_xyscaler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xyscaler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span>
        <span class="k">return</span> <span class="n">xyscaler</span></div>
    <span class="n">xyscaler</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xyscaler</span><span class="p">,</span> <span class="n">Plot2D</span><span class="o">.</span><span class="n">set_xyscaler</span><span class="p">,</span>
        <span class="n">Plot2D</span><span class="o">.</span><span class="n">del_xyscaler</span><span class="p">,</span> <span class="n">Plot2D</span><span class="o">.</span><span class="n">xyscaler</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>

<div class="viewcode-block" id="Map.get_uvscaler"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.get_uvscaler">[docs]</a>    <span class="k">def</span> <span class="nf">get_uvscaler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :attr:`uvscaler`&quot;&quot;&quot;</span>
        <span class="n">uvscaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_obj</span><span class="p">(</span><span class="s1">&#39;uvscaler&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">uvscaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">uvscaler</span>
        <span class="k">if</span> <span class="n">guess</span><span class="p">:</span> <span class="k">return</span> <span class="n">Plot</span><span class="o">.</span><span class="n">get_uvscaler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">uvscaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uvscaler</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">rotate_vector</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">getValue</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">getValue</span><span class="p">(),</span> <span class="n">returnxy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">uvscaler</span></div>
    <span class="n">uvscaler</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_uvscaler</span><span class="p">,</span> <span class="n">Plot</span><span class="o">.</span><span class="n">set_uvscaler</span><span class="p">,</span>
        <span class="n">Plot</span><span class="o">.</span><span class="n">del_uvscaler</span><span class="p">,</span> <span class="n">Plot</span><span class="o">.</span><span class="n">uvscaler</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>

<div class="viewcode-block" id="Map.load_data"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Data loading</span>


<span class="sd">        It performs the following tasks:</span>

<span class="sd">            #. Call to the generic :meth:`Plot2D.load_data` method.</span>
<span class="sd">            #. Set attributes :attr:`lon` :attr:`lat`.</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **data**, optional: See :meth:`~vacumm.misc.core_plot.Plot2D.load_data`.</span>
<span class="sd">            - **lon**, optional: Longitude interval.</span>
<span class="sd">            - **lat**, optional: Latitude interval.</span>

<span class="sd">        .. attribute:: lon</span>

<span class="sd">            Longitudes as a two-elements tuple or and array.</span>

<span class="sd">        .. attribute:: lat</span>

<span class="sd">            Latitudes as a two-elements tuple or and array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Default bounds</span>
        <span class="n">default_lon</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">180.</span><span class="p">,</span> <span class="mf">180.</span><span class="p">])</span>
        <span class="n">default_lat</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">90.</span><span class="p">,</span> <span class="mf">90.</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">lon</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lon</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lat</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>

        <span class="c1"># Get some keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lon</span> <span class="o">=</span> <span class="n">lon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="o">=</span> <span class="n">lat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;yx&#39;</span>

        <span class="c1"># Minimal setup</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;xaxis&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lon</span> <span class="k">if</span> <span class="n">lon</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">default_lon</span>
            <span class="k">if</span> <span class="s1">&#39;yaxis&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat</span> <span class="k">if</span> <span class="n">lat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">default_lat</span>

        <span class="c1"># Basic load</span>
        <span class="n">Plot2D</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Longitudes and latitudes</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lon</span> <span class="o">=</span> <span class="n">default_lon</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="o">=</span> <span class="n">default_lat</span>
        <span class="k">else</span><span class="p">:</span>
<span class="c1">#            masked = False if self.masked else None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">(</span><span class="n">masked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span></div>


<div class="viewcode-block" id="Map.pre_plot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.pre_plot">[docs]</a>    <span class="k">def</span> <span class="nf">pre_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;cyl&#39;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
            <span class="n">epsg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fullscreen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_update</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">lon_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lon_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lat_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lat_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">lon_center</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lat_center</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lat_ts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">nocache</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cache_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot initialisation.</span>

<span class="sd">       :Tasks:</span>

<span class="sd">            #. Call to the generic :meth:`Plot.pre_plot` method.</span>
<span class="sd">            #. Setup a :class:`~mpl_toolkits.basemap.Basemap` instance</span>
<span class="sd">               and store it in :attr:`map`.</span>
<span class="sd">            #. Project :attr:`~Plot2D.x2d`, :attr:`~Plot2D.y2d`,</span>
<span class="sd">               :attr:`~Plot2D.x2db` and :attr:`~Plot2D.y2db`</span>
<span class="sd">               using :attr:`map`.</span>

<span class="sd">       :Generic params: See :meth:`Plot.pre_plot`.</span>

<span class="sd">       :Special params:</span>

<span class="sd">           - **projection**: Map projection, like &quot;merc&quot;.</span>
<span class="sd">             See :mod:`~mpl_toolkits.basemap.Basemap` for a list of possible projections.</span>
<span class="sd">           - **resolution**: GSHHS resolution of shoreline or &#39;s&#39; for Histolitt (SHOM).</span>

<span class="sd">            - ``&quot;c&quot;``: Crude.</span>
<span class="sd">            - ``&quot;l&quot;``: Low.</span>
<span class="sd">            - ``&quot;i&quot;``: Intermediate.</span>
<span class="sd">            - ``&quot;h&quot;``: High.</span>
<span class="sd">            - ``&quot;f&quot;``: Full.</span>
<span class="sd">            - ``&quot;s&quot;``: Histolittfor the french coast</span>
<span class="sd">              (from a shapefile file automatically</span>
<span class="sd">              downloaded once the license is accepted).</span>

<span class="sd">           - **nocache**: Management of cached maps.</span>

<span class="sd">             .. only:: html and epub</span>

<span class="sd">                   - ``0``: Read and write cached maps.</span>
<span class="sd">                   - ``1``: Only write cached maps.</span>
<span class="sd">                   - ``2``: Caching is disabled.</span>

<span class="sd">             .. only:: latex</span>

<span class="sd">                    ``0``: read and write cached maps.;</span>
<span class="sd">                    ``1``: Only write cached maps;</span>
<span class="sd">                    ``2``: Caching is disabled.</span>

<span class="sd">            - **map_update**: Force the update of the map latter by :meth:`post_plot`,</span>
<span class="sd">              setting :attr:`map_update`.</span>

<span class="sd">            - **zoom**: Zoom on map bounds before creating it.</span>

<span class="sd">        .. attribute:: map_update</span>

<span class="sd">            An attribute to know if current map must be updated by :meth:`post_plot`.</span>
<span class="sd">            It is also a parameter to method.</span>
<span class="sd">        &quot;&quot;&quot;</span>



        <span class="c1"># Aliases</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="nb">map</span><span class="p">)</span>


        <span class="c1"># Common init</span>
        <span class="n">Plot</span><span class="o">.</span><span class="n">pre_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Check if map exists</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">,</span> <span class="n">Plot</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">,</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;map&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;map&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
                <span class="n">map_update</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">map_update</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">map_update</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">map_update</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map_update</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">map_update</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map_update</span>  <span class="o">=</span> <span class="mi">2</span>


        <span class="c1"># Create the map</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">kwmap</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;basemap&#39;</span><span class="p">)</span>
            <span class="n">kwmap</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;map_&#39;</span><span class="p">))</span>
            <span class="n">lon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmasked</span> <span class="k">else</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lon</span><span class="p">)</span>
            <span class="n">lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymasked</span> <span class="k">else</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">lon_min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lon_min</span> <span class="o">=</span> <span class="n">lon</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">lon_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lon_max</span> <span class="o">=</span> <span class="n">lon</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">lat_min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lat_min</span> <span class="o">=</span> <span class="n">lat</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">lat_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lat_max</span> <span class="o">=</span> <span class="n">lat</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">projection</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;proj&#39;</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span>
            <span class="kn">from</span> <span class="nn">vacumm.misc.grid.basemap</span> <span class="k">import</span> <span class="n">create_map</span>
            <span class="n">resolution</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;res&#39;</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="o">=</span> <span class="n">create_map</span><span class="p">(</span><span class="n">lon_min</span><span class="p">,</span> <span class="n">lon_max</span><span class="p">,</span> <span class="n">lat_min</span><span class="p">,</span> <span class="n">lat_max</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
                <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="n">overlay</span><span class="p">,</span> <span class="n">fullscreen</span><span class="o">=</span><span class="n">fullscreen</span><span class="p">,</span>
                <span class="n">lon_center</span><span class="o">=</span><span class="n">lon_center</span><span class="p">,</span> <span class="n">lat_center</span><span class="o">=</span><span class="n">lat_center</span><span class="p">,</span> <span class="n">lat_ts</span><span class="o">=</span><span class="n">lat_ts</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="n">epsg</span><span class="p">,</span>
                <span class="n">nocache</span><span class="o">=</span><span class="n">nocache</span><span class="p">,</span> <span class="n">cache_dir</span><span class="o">=</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="n">zoom</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwmap</span><span class="p">)</span>

        <span class="c1"># Projection of coordinates</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyscaler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyscaler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x2db</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2db</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">,</span> <span class="s1">&#39;res&#39;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">resolution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;map&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">)</span>
        <span class="c1">#self._plotter = self.map</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span></div>

    <span class="k">def</span> <span class="nf">_check_map_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Map still no set&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert coordinates with a geographic projection</span>
<span class="sd">            using the current :meth:`~mpl_toolkits.basemap.Basemap` instance (:attr:`map`).</span>

<span class="sd">        See :meth:`mpl_toolkits.basemap.Basemap.__call__`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_map_</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">)</span>


<div class="viewcode-block" id="Map.plot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Main plot</span>

<span class="sd">        It performs the following tasks:</span>

<span class="sd">            #. Call to generic :meth:`~Plot2D.plot` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>



        <span class="c1"># Generic 2D plot</span>
        <span class="n">Plot2D</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Update map limits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">set_axes_limits</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span></div>


<div class="viewcode-block" id="Map.plot_quiver"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.plot_quiver">[docs]</a>    <span class="k">def</span> <span class="nf">plot_quiver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quiver_res_scaler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiver_angles</span><span class="o">=</span><span class="s1">&#39;uv&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">quiver_res_scaler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">quiver_res_scaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapproj</span>
        <span class="k">return</span> <span class="n">Plot2D</span><span class="o">.</span><span class="n">plot_quiver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quiver_res_scaler</span><span class="o">=</span><span class="n">quiver_res_scaler</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    <span class="n">plot_quiver</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">Plot2D</span><span class="o">.</span><span class="n">plot_quiver</span><span class="o">.</span><span class="vm">__doc__</span>



<div class="viewcode-block" id="Map.add_lowhighs"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.add_lowhighs">[docs]</a>    <span class="k">def</span> <span class="nf">add_lowhighs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">lowtext</span><span class="o">=</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">hightext</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">,</span>
        <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Mark position of mins and maxs using letters.</span>

<span class="sd">        It is typically used for adding L and H to depressions and anticyclones.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_valid_data</span><span class="p">():</span> <span class="k">return</span>

        <span class="c1"># Data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">2</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">2</span><span class="p">:</span> <span class="k">return</span>

        <span class="c1"># Smooth</span>
        <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">generic2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">smooth</span><span class="p">)</span>

        <span class="c1"># Gradients</span>
        <span class="n">ndata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">filled</span><span class="p">()</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

        <span class="c1"># High and low fields</span>
        <span class="n">lows</span> <span class="o">=</span>  <span class="n">dx</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span>
        <span class="n">lows</span> <span class="o">&amp;=</span> <span class="n">dx</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">&gt;</span><span class="mi">0</span>
        <span class="n">lows</span> <span class="o">&amp;=</span> <span class="n">dy</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span>
        <span class="n">lows</span> <span class="o">&amp;=</span> <span class="n">dy</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">&gt;</span><span class="mi">0</span>
        <span class="n">highs</span> <span class="o">=</span>  <span class="n">dx</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span>
        <span class="n">highs</span> <span class="o">&amp;=</span> <span class="n">dx</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">&lt;</span><span class="mi">0</span>
        <span class="n">highs</span> <span class="o">&amp;=</span> <span class="n">dy</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span>
        <span class="n">highs</span> <span class="o">&amp;=</span> <span class="n">dy</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">&lt;</span><span class="mi">0</span>

        <span class="c1"># Masking</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">mask</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
            <span class="k">for</span> <span class="n">hl</span> <span class="ow">in</span> <span class="n">lows</span><span class="p">,</span> <span class="n">highs</span><span class="p">:</span>
                <span class="n">var</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Positions</span>
        <span class="n">xlows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">lows</span><span class="p">]</span>
        <span class="n">ylows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">lows</span><span class="p">]</span>
        <span class="n">xhighs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x2d</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">highs</span><span class="p">]</span>
        <span class="n">yhighs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y2d</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">highs</span><span class="p">]</span>

        <span class="c1"># Plot text</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
        <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>
        <span class="n">dict_copy_items</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="n">kwsh</span><span class="p">,</span> <span class="n">kwgl</span><span class="p">],</span> <span class="s1">&#39;anim&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;va&#39;</span><span class="p">,</span> <span class="s1">&#39;ha&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="n">tts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">),</span> <span class="n">text</span> <span class="ow">in</span> <span class="p">(((</span><span class="n">xlows</span><span class="p">,</span> <span class="n">ylows</span><span class="p">),</span> <span class="n">lowtext</span><span class="p">),</span> <span class="p">((</span><span class="n">xhighs</span><span class="p">,</span> <span class="n">yhighs</span><span class="p">),</span> <span class="n">hightext</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">):</span>
                <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_obj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="s1">&#39;lowhighs&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">tts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;lowhighs_shadow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">glow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_glow</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;lowhighs_glow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span>

        <span class="k">del</span> <span class="n">xlows</span><span class="p">,</span> <span class="n">ylows</span><span class="p">,</span> <span class="n">xhighs</span><span class="p">,</span> <span class="n">yhighs</span>
        <span class="k">return</span> <span class="n">tts</span></div>


<div class="viewcode-block" id="Map.add_arcgisimage"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.add_arcgisimage">[docs]</a>    <span class="k">def</span> <span class="nf">add_arcgisimage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an Arcgis image</span>

<span class="sd">        Available service aliases (see :attr:`ARCGISIMAGE_ALIASES`): {}</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Alias</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">service</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">service</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">service</span> <span class="o">=</span> <span class="s2">&quot;esriimagery&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="n">service</span> <span class="o">=</span> <span class="n">ARCGISIMAGE_ALIASES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">service</span><span class="p">)</span>

        <span class="c1"># Pixels</span>
        <span class="n">axext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extents</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">xpixels</span> <span class="o">=</span> <span class="p">(</span><span class="n">axext</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">axext</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">fact</span>
<span class="c1">#        ypixels = (axext[3]-axext[1])*fact</span>
        <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">dpi</span>

        <span class="c1"># Call the basemap method</span>
        <span class="n">dict_check_defaults</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="n">service</span><span class="p">,</span>
            <span class="n">xpixels</span><span class="o">=</span><span class="n">xpixels</span><span class="p">,</span>
<span class="c1">#            ypixels=ypixels,</span>
            <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">arcgisimage</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Error when plotting arcgisimage: </span><span class="si">{}</span><span class="s1">.</span><span class="se">\n</span><span class="s1">Message: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">service</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">))</span></div>

    <span class="n">add_arcgisimage</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ARCGISIMAGE_ALIASES</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">_get_posposref_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">posref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xrel</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">yrel</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span>
        <span class="n">xpad</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get position of point and reference points in data coordinates (meters)</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **pos**: Position in data (lon, lat), axes or figure coordinates for placement.</span>
<span class="sd">            - **posref**: Position in data (lon, lat) coordinates of reference point.</span>
<span class="sd">            - **x/yrel**: Default placement position relative to longitude and latitude ranges.</span>
<span class="sd">            - **transform**: Coordinates transform for ``pos`` which defaults to &quot;data&quot;.</span>
<span class="sd">              Use a valid transform, or &quot;data&quot;, &quot;axes&quot; or &quot;figure&quot;.</span>
<span class="sd">            - **x/ypad**: Padding if dots for placement when given as a string like &quot;upper left&quot;.</span>

<span class="sd">        Return: ``(x,y),(xref,yref)`` in meters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Placement point</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">xrel</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">xrel</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">yrel</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">yrel</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lonmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">lonmin</span>
            <span class="n">lonmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">lonmax</span>
            <span class="n">latmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">latmin</span>
            <span class="n">latmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">latmax</span>
            <span class="n">dlon</span> <span class="o">=</span> <span class="n">lonmax</span><span class="o">-</span><span class="n">lonmin</span>
            <span class="n">dlat</span> <span class="o">=</span> <span class="n">latmax</span><span class="o">-</span><span class="n">latmin</span>
            <span class="n">lon0</span> <span class="o">=</span> <span class="n">lonmin</span><span class="o">+</span><span class="n">xrel</span><span class="o">*</span><span class="n">dlon</span>
            <span class="n">lat0</span> <span class="o">=</span> <span class="n">latmin</span><span class="o">+</span><span class="n">yrel</span><span class="o">*</span><span class="n">dlat</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">(</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">_locations</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">xpad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">ypad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">offset</span> <span class="o">=</span> <span class="n">loc2offset</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">xpad</span><span class="o">=</span><span class="n">xpad</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="n">ypad</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="n">loc2tuple</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">xpad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="n">loc2tuple</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">xpad</span><span class="o">=</span><span class="n">xrel</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="n">yrel</span><span class="p">)</span>

                <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">transform</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span> <span class="ow">or</span> <span class="n">transform</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">((</span><span class="n">transform</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span><span class="p">)</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">))</span>

        <span class="c1"># Reference point</span>
        <span class="k">if</span> <span class="n">posref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">posref</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">posref</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="o">*</span><span class="n">posref</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">posref</span><span class="p">,</span> <span class="n">offset</span>

<div class="viewcode-block" id="Map.add_mapscale"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.add_mapscale">[docs]</a>    <span class="k">def</span> <span class="nf">add_mapscale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">posref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">barstyle</span><span class="o">=</span><span class="s1">&#39;simple&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">xrel</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">yrel</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">getpos</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">posonly</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a map scale using :meth:`mpl_toolkits.basemap.Basemap.drawmapscale`</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **pos**, optional: ``(lon,lat)`` where to draw it.</span>
<span class="sd">            - **posref**, optional: ``(lon,lat)`` of reference position where the scale</span>
<span class="sd">              is estimated.</span>
<span class="sd">            - **scale**, optional: Length of the scale in projection coordinates (m).</span>
<span class="sd">            - **barstyle**, optional: Bar style: &#39;simple&#39; or &#39;fancy&#39;.</span>
<span class="sd">            - **transform**, optional: Coordinates transform for ``pos`` which defaults to &quot;data&quot;.</span>
<span class="sd">              Use a valid transform, or &quot;data&quot;, &quot;axes&quot; or &quot;figure&quot;.</span>
<span class="sd">            - **x/yrel**, optional: Default placement position relative to longitude and latitude ranges.</span>
<span class="sd">            - **x/ypad**, optional: Padding if dots for placement when given as a string like &quot;upper left&quot;.</span>
<span class="sd">            - **shadow**, optional: Add a shadow.</span>
<span class="sd">            - **shadow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.Plot.add_shadow`.</span>
<span class="sd">            - Othe keywords are passed to :meth:`~mpl_toolkits.basemap.Basemap.drawmapscale`.</span>

<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; mymap.add_mapscale((.2,.2), transform=&#39;axes&#39;)</span>
<span class="sd">            &gt;&gt;&gt; mymap.add_mapscale(&#39;upper right&#39;, posref=(-2,45), fontsize=10)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow_&#39;</span><span class="p">)</span>

        <span class="c1"># Positions</span>
        <span class="n">pos</span><span class="p">,</span> <span class="n">posref</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_posposref_</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">posref</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">xrel</span><span class="o">=</span><span class="n">xrel</span> <span class="k">if</span> <span class="n">xrel</span><span class="o">&lt;.</span><span class="mi">5</span> <span class="k">else</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xrel</span><span class="p">),</span> <span class="n">yrel</span><span class="o">=</span><span class="n">yrel</span> <span class="k">if</span> <span class="n">yrel</span><span class="o">&lt;.</span><span class="mi">5</span> <span class="k">else</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">yrel</span><span class="p">),</span> <span class="n">xpad</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">getpos</span> <span class="ow">and</span> <span class="n">posonly</span><span class="p">:</span> <span class="k">return</span> <span class="n">pos</span>
        <span class="n">posref</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">posref</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">posref</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Scale</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">scales</span> <span class="o">=</span> <span class="n">basic_auto_scale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">xmax</span><span class="p">,</span> <span class="n">nmax</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="p">(</span><span class="n">scales</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">scales</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">0.001</span>

        <span class="c1"># Draw it</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;barstyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">barstyle</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">drawmapscale</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">posref</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">posref</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">scale</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_obj</span><span class="p">(</span><span class="s1">&#39;mapscale&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="p">)</span>

        <span class="c1"># Finalize</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">ms</span><span class="p">:</span>
            <span class="n">o</span><span class="o">.</span><span class="n">set_clip_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">o</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="n">zorder</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">getpos</span><span class="p">:</span> <span class="k">return</span> <span class="n">ms</span><span class="p">,</span> <span class="n">pos</span>
        <span class="k">return</span> <span class="n">ms</span></div>


<div class="viewcode-block" id="Map.add_compass"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.add_compass">[docs]</a>    <span class="k">def</span> <span class="nf">add_compass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">posref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;simple&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">xpad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xrel</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">yrel</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">getpos</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a compass to the map using :func:`~vacumm.misc.plot.add_compass`</span>

<span class="sd">        See :func:`~vacumm.misc.plot.add_compass` all options.</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **pos**, optional: ``(lon,lat)`` where to draw it.</span>
<span class="sd">            - **size**, optional: Size in pixels.</span>
<span class="sd">            - **posref**, optional: ``(lon,lat)`` of reference position where the north</span>
<span class="sd">              is estimated.</span>
<span class="sd">            - **style**, optional: Compas style: &#39;simple&#39; or &#39;fancy&#39;.</span>
<span class="sd">            - **transform**: Coordinates transform for ``pos`` which defaults to &quot;data&quot;.</span>
<span class="sd">              Use a valid transform, or &quot;data&quot;, &quot;axes&quot; or &quot;figure&quot;.</span>
<span class="sd">            - **x/yrel**: Default placement position relative to longitude and latitude ranges.</span>
<span class="sd">            - **x/ypad**: Padding in dots for placement when given as a string like &quot;upper left&quot;.</span>
<span class="sd">            - **shadow**, optional: Add a shadow.</span>
<span class="sd">            - **shadow_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.Plot.add_shadow`.</span>
<span class="sd">            - Othe keywords are passed to :func:`~vacumm.misc.plot.add_compass`.</span>

<span class="sd">        :Example:</span>

<span class="sd">            &gt;&gt;&gt; map2(data, compass=True)</span>
<span class="sd">            &gt;&gt;&gt; mymap.add_compass((-4,45), 40, facecolor1=&#39;r&#39;, text_weight=&#39;bold&#39;)</span>
<span class="sd">            &gt;&gt;&gt; mymap.add_compass(pos=&quot;upper right&quot;, style=&quot;fancy&quot;, xpad=100)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow_&#39;</span><span class="p">)</span>

        <span class="c1"># Transform</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">)</span>

        <span class="c1"># Positions</span>
        <span class="k">if</span> <span class="n">xpad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">xpad</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span>
        <span class="n">pos</span><span class="p">,</span> <span class="n">posref</span><span class="p">,</span> <span class="n">poffset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_posposref_</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">posref</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">xrel</span><span class="o">=</span><span class="n">xrel</span><span class="p">,</span> <span class="n">yrel</span><span class="o">=</span><span class="n">yrel</span><span class="p">,</span> <span class="n">xpad</span><span class="o">=</span><span class="n">xpad</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="n">ypad</span><span class="p">)</span>

        <span class="c1"># Departure angle from 90 for north</span>
        <span class="n">pr</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">posref</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">posref</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">uo</span><span class="p">,</span> <span class="n">vo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">rotate_vector</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span><span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">]),</span>
            <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pr</span><span class="p">[:</span><span class="mi">1</span><span class="p">]),</span><span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">vo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">uo</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">-</span><span class="mf">90.</span>

        <span class="c1"># Draw it</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;posref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">posref</span>
        <span class="n">dict_check_defaults</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">poffset</span><span class="p">,</span> <span class="n">text_zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">)</span>
        <span class="n">kwfont</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">short</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;size&#39;</span> <span class="ow">in</span> <span class="n">kwfont</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;text_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwfont</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">in</span> <span class="n">kwfont</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;text_color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwfont</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
        <span class="n">cp</span> <span class="o">=</span> <span class="n">add_compass</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">anglemode</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_obj</span><span class="p">(</span><span class="s1">&#39;compass&#39;</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>

        <span class="c1"># Finalize</span>
        <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">cp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">cp</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_shadow</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">getpos</span><span class="p">:</span> <span class="k">return</span> <span class="n">cp</span><span class="p">,</span> <span class="n">pos</span>
        <span class="k">return</span> <span class="n">cp</span></div>


<div class="viewcode-block" id="Map.add_mscp"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.add_mscp">[docs]</a>    <span class="k">def</span> <span class="nf">add_mscp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">posref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">compass_size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot a mapscale and a compass above</span>


<span class="sd">        :Params:</span>

<span class="sd">            - **pos**: Position of the mapscale (see :meth:`add_mapscale`).</span>
<span class="sd">              The compass is drawn just above.</span>
<span class="sd">            - **posref**, optional: Position of reference point for both mapscale and</span>
<span class="sd">              compass.</span>
<span class="sd">            - **mapscale_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.Map.add_mapscale`.</span>
<span class="sd">            - **scompass_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.Map.add_compass`.</span>


<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; map2(data, mscp=True, mscp_pos=(-2, 48))</span>
<span class="sd">            &gt;&gt;&gt; mymap.add_mscp(&#39;lower left&#39;)</span>
<span class="sd">            &gt;&gt;&gt; mymap.add_mscp((-4,45), mapscale_scale=100, mapscale_barstyle=&#39;fancy&#39;,</span>
<span class="sd">                compass_size=50, compass_style=&#39;simple&#39;)</span>
<span class="sd">            &gt;&gt;&gt; mymap.add_mscp((.9,.1), transform=&#39;axes&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">kwms</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;mapscale&#39;</span><span class="p">)</span>
        <span class="n">kwms</span><span class="p">[</span><span class="s1">&#39;transform&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform</span>
        <span class="n">kwcp</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;compass&#39;</span><span class="p">)</span>
        <span class="n">dict_check_defaults</span><span class="p">(</span><span class="n">kwcp</span><span class="p">,</span> <span class="n">facecolor1</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">text_color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">)</span>
        <span class="n">dict_check_defaults</span><span class="p">(</span><span class="n">kwms</span><span class="p">,</span> <span class="n">fontcolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">fillcolor2</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">)</span>

        <span class="n">msoffset</span> <span class="o">=</span> <span class="n">kwms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="mf">0.02</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">ymax</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">ymin</span><span class="p">))</span>
        <span class="n">cptextpad</span> <span class="o">=</span> <span class="n">kwcp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;text_pad&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">cpoffset</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">compass_size</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Mapscale position at top</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">_locations</span> <span class="ow">and</span> <span class="s1">&#39;top&#39;</span> <span class="ow">in</span> <span class="n">loc2align</span><span class="p">(</span><span class="n">pos</span><span class="p">)[</span><span class="s1">&#39;va&#39;</span><span class="p">]:</span>

            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_mapscale</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">posref</span><span class="o">=</span><span class="n">posref</span><span class="p">,</span> <span class="n">getpos</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">posonly</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwms</span><span class="p">)</span>
            <span class="n">mpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span>
            <span class="n">ppos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="n">mpos</span><span class="p">)</span>
            <span class="n">mpos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span>
                <span class="p">(</span><span class="n">ppos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ppos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">cpoffset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">cptextpad</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">mpos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mpos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">msoffset</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">kwms</span><span class="p">[</span><span class="s1">&#39;transform&#39;</span><span class="p">]</span>

        <span class="c1"># Mapscale</span>
        <span class="n">kwms</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="n">ms</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_mapscale</span><span class="p">(</span><span class="n">posref</span><span class="o">=</span><span class="n">posref</span><span class="p">,</span> <span class="n">getpos</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwms</span><span class="p">)</span>

        <span class="c1"># Compass above mapscale</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">msoffset</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">kwcp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">transform</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">cpoffset</span><span class="p">)</span>
        <span class="n">kwcp</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="n">cp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_compass</span><span class="p">(</span><span class="n">posref</span><span class="o">=</span><span class="n">posref</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">compass_size</span><span class="p">,</span> <span class="o">**</span><span class="n">kwcp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ms</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span></div>

<div class="viewcode-block" id="Map.post_plot"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.post_plot">[docs]</a>    <span class="k">def</span> <span class="nf">post_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drawrivers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fillcontinents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">meridional_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zonal_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">drawcoastlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drawmapboundary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">meridians</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">land_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ticklabel_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refine</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">no_seconds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fullscreen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">minutes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mapscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compass</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mscp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">bfdeg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lowhighs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arcgisimage</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Post-processing of the plot</span>

<span class="sd">        :Tasks:</span>

<span class="sd">            #. Update the map if attribute :attr:`map_update` is True:</span>

<span class="sd">                #) Treat continents if attribute :attr:`map_update` = 2 and</span>
<span class="sd">                   attribute :attr:`map` has a coastline resolution not ``None``:</span>
<span class="sd">                   draw coastlines, fill continents and draw rivers.</span>

<span class="sd">                #) Draw parallels and associated labels.</span>

<span class="sd">            #. Call to generic post processing of 2D plots (:meth:`Plot2D.post_plot`).</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **drawrivers**: Draw rivers on the map using method</span>
<span class="sd">              :meth:`~mpl_toolkits.basemap.Basemap.drawrivers`.</span>
<span class="sd">            - **drawrivers_&lt;param&gt;**: Pass ``&lt;param&gt;`` to the method.</span>
<span class="sd">            - **fillcontinents**: Fill continents with color ``land_color``</span>
<span class="sd">              using method :meth:`~mpl_toolkits.basemap.Basemap.fillcontinents`.</span>
<span class="sd">            - **land_color**: Fill color.</span>
<span class="sd">            - **fillcontinents_&lt;param&gt;**: Pass ``&lt;param&gt;`` to the method.</span>
<span class="sd">            - **drawparallels**: Display or hide parallels and associated labels using</span>
<span class="sd">              method :meth:`~mpl_toolkits.basemap.Basemap.drawparallels`.</span>
<span class="sd">            - **drawparallels_&lt;param&gt;**: Pass ``&lt;param&gt;`` to the method.</span>
<span class="sd">            - **drawparallels_fmt**: Default to :class:`MinuteLabel`.</span>
<span class="sd">            - **drawparallels_gs_&lt;param&gt;**: Passed to :func:`~vacumm.misc.misc.geo_scale`.</span>
<span class="sd">            - **parallels**: Parallels to plot.</span>
<span class="sd">            - **drawmeridians**: Display or hide medidians and associated labels using</span>
<span class="sd">              method :meth:`~mpl_toolkits.basemap.Basemap.drawmeridians`.</span>
<span class="sd">            - **drawmeridians_&lt;param&gt;**: Pass ``&lt;param&gt;`` to the method.</span>
<span class="sd">            - **drawmeridians_fmt**: Default to :class:`MinuteLabel`.</span>
<span class="sd">            - **drawmeridians_gs_&lt;param&gt;**: Passed to :func:`~vacumm.misc.misc.geo_scale`.</span>
<span class="sd">            - **meridians**: Meridians to plot.</span>
<span class="sd">            - **meridional/zonal_labels**: Display or hide meridional/zonal labels.</span>
<span class="sd">              ``meridional/zonal_labels=False`` is equivalent to ``y/xhide=True``.</span>
<span class="sd">            - **no_seconds**: Do not display seconds in labels (if applicable).</span>
<span class="sd">            - **minutes**: Do not use decimal degrees for labels (if applicable).</span>
<span class="sd">            - **bfdeg**: Degrees are in bold (latex text only, if applicable).</span>
<span class="sd">            - **x/y/ticklabels_&lt;param&gt;**: Pass ``&lt;param&gt;`` to</span>
<span class="sd">              :meth:`~mpl_toolkits.basemap.Basemap.drawmeridians` and</span>
<span class="sd">              :meth:`~mpl_toolkits.basemap.Basemap.drawparallels` to change text properties.</span>
<span class="sd">            - **fullscreen**: Full screen mode -&gt; no colorbar and no labels.</span>
<span class="sd">            - **mapscale**: Add a map scale using</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.Map.add_mapscale`.</span>
<span class="sd">            - **mapscale_&lt;param&gt;**: Pass ``&lt;param&gt;`` to the</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.Map.add_mapscale` method.</span>
<span class="sd">            - **compass**: Add a compass using</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.Map.add_compass`.</span>
<span class="sd">            - **compass_&lt;param&gt;**: Pass ``&lt;param&gt;`` to the</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.Map.add_compass` method.</span>
<span class="sd">            - **mscp**: Add a mapscale AND a compass using</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.Map.add_mscp`.</span>
<span class="sd">            - **mscp_&lt;param&gt;**: Pass ``&lt;param&gt;`` to the</span>
<span class="sd">              :meth:`~vacumm.misc.core_plot.Map.add_mscp` method.</span>


<span class="sd">        &quot;&quot;&quot;</span>



        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_update</span><span class="p">:</span>

            <span class="c1"># Full screen</span>
            <span class="k">if</span> <span class="n">fullscreen</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;colorbar&#39;</span><span class="p">,</span>  <span class="kc">False</span><span class="p">)</span>
                <span class="n">default_drawparallels</span> <span class="o">=</span> <span class="n">default_drawmeridians</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">default_drawparallels</span> <span class="o">=</span> <span class="n">default_drawmeridians</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">drawparallels</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;drawparallels&#39;</span><span class="p">,</span> <span class="n">default_drawparallels</span><span class="p">)</span>
            <span class="n">drawmeridians</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;drawmeridians&#39;</span><span class="p">,</span> <span class="n">default_drawmeridians</span><span class="p">)</span>


            <span class="c1"># Map boundaries</span>
            <span class="k">if</span> <span class="n">drawmapboundary</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;drawmapboundary&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">drawmapboundary</span><span class="p">(</span><span class="o">**</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;drawmapboundary&#39;</span><span class="p">)))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="s1">&#39;Problem with Basemap.drawmapboundary&#39;</span>

            <span class="c1"># Continents</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">res</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_update</span><span class="o">&gt;=</span><span class="mi">2</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">land_color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">land_color</span> <span class="o">=</span> <span class="n">land</span>
                <span class="n">kwdrawcoastlines</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;drawcoastlines_&#39;</span><span class="p">)</span>
                <span class="n">kwdrawcoastlines</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
                <span class="n">kwfillcontinents</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;fillcontinents_&#39;</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="n">land_color</span><span class="p">})</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span><span class="c1"># GSHHS</span>

                    <span class="c1"># Draw coastlines</span>
                    <span class="k">if</span> <span class="n">drawcoastlines</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;drawcoastlines&#39;</span><span class="p">):</span>
                        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">(</span><span class="o">**</span><span class="n">kwdrawcoastlines</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;drawcoastlines&#39;</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">add_collection3d</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>

                    <span class="c1"># Fill continents</span>
                    <span class="n">fcsh</span> <span class="o">=</span> <span class="n">kwfillcontinents</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;shadow&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                    <span class="n">kwfcsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwfillcontinents</span><span class="p">,</span> <span class="s1">&#39;shadow_&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">fillcontinents</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;fillcontinents&#39;</span><span class="p">):</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;fillcontinents&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">fillcontinents</span><span class="p">(</span><span class="o">**</span><span class="n">kwfillcontinents</span><span class="p">))</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">pass</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;fillcontinents&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">fcsh</span><span class="p">:</span>
                                <span class="n">add_shadow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;fillcontinents&#39;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwfcsh</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">polys</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">landpolygons</span><span class="p">:</span>
                                <span class="n">polys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">get_coords</span><span class="p">())</span>
                            <span class="n">kwfillcontinents</span><span class="p">[</span><span class="s1">&#39;facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwfillcontinents</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>
                            <span class="n">kwfillcontinents</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lake_color&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                            <span class="n">lc</span> <span class="o">=</span> <span class="n">PolyCollection</span><span class="p">(</span><span class="n">polys</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="o">**</span><span class="n">kwfillcontinents</span><span class="p">)</span>
                            <span class="k">del</span> <span class="n">polys</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">add_collection3d</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span>


                    <span class="c1"># Draw rivers</span>
                    <span class="k">if</span> <span class="n">drawrivers</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="s1">&#39;drawrivers&#39;</span><span class="p">):</span>
                        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">drawrivers</span><span class="p">(</span><span class="o">**</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;drawrivers&#39;</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;drawrivers&#39;</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">add_collection3d</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>

                <span class="c1">#elif m.res == &#39;s&#39;: # SHOM</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">Shapes</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">res</span><span class="o">==</span><span class="s1">&#39;s&#39;</span><span class="p">:</span>
                        <span class="kn">from</span> <span class="nn">vacumm.bathy.shorelines</span> <span class="k">import</span> <span class="n">Histolitt</span>
                        <span class="n">shoreline</span> <span class="o">=</span> <span class="n">Histolitt</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">shoreline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">res</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shoreline</span><span class="p">,</span> <span class="n">Shapes</span><span class="p">):</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">kwshoreline</span> <span class="o">=</span> <span class="p">{}</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">drawcoastlines</span><span class="p">:</span>
                                <span class="n">kwshoreline</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">kwshoreline</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwdrawcoastlines</span><span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">fillcontinents</span><span class="p">:</span>
                                <span class="n">kwshoreline</span><span class="p">[</span><span class="s1">&#39;fill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">kwshoreline</span><span class="p">[</span><span class="s1">&#39;fillcolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwfillcontinents</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>
                                <span class="n">kwshoreline</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwfillcontinents</span><span class="p">)</span>
                            <span class="n">kwshoreline</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">show</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
                            <span class="n">shoreline</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwshoreline</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
                            <span class="kn">import</span> <span class="nn">traceback</span>
                            <span class="nb">print</span> <span class="s1">&#39;*** Error in shaprefile shoreline&#39;</span>
                            <span class="nb">print</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>

            <span class="c1"># Tick labels and lines</span>
            <span class="n">kwpm_def</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">kwpm_def</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;ticklabels_&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">ticklabel_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">kwpm_def</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">ticklabel_size</span><span class="p">)</span>
            <span class="n">kwp</span> <span class="o">=</span> <span class="n">kwpm_def</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="p">;</span> <span class="n">kwm</span> <span class="o">=</span> <span class="n">kwpm_def</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">kwp</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwm</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># - parallels</span>
            <span class="k">if</span> <span class="n">drawparallels</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyhide_</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;yhide&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span><span class="p">:</span>
                    <span class="n">meridional_labels</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">kwp</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">meridional_labels</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="c1">#                kwp.update(kwpm_def)</span>
                <span class="n">kwp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;yticklabels_&#39;</span><span class="p">))</span>
                <span class="n">kwp</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;drawparallels&#39;</span><span class="p">,</span><span class="n">defaults</span><span class="o">=</span><span class="n">kwp</span><span class="p">)</span>
                <span class="n">kwgs</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwp</span><span class="p">,</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span>
                    <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;vmin&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">llcrnrlat</span><span class="p">,</span> <span class="s1">&#39;vmax&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">urcrnrlat</span><span class="p">,</span>
                        <span class="s1">&#39;minutes&#39;</span><span class="p">:</span><span class="n">minutes</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">parallels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">parallels</span> <span class="o">=</span> <span class="n">geo_scale</span><span class="p">(</span><span class="o">**</span><span class="n">kwgs</span><span class="p">)</span>
                <span class="n">parallels</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span>
                    <span class="n">_</span><span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">llcrnrlat</span> <span class="ow">and</span> <span class="n">_</span><span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">urcrnrlat</span><span class="p">,</span> <span class="n">parallels</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">minutes</span><span class="p">:</span> <span class="n">kwp</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;fmt&#39;</span><span class="p">,</span>
                    <span class="n">MinuteLabel</span><span class="p">(</span><span class="n">parallels</span><span class="p">,</span> <span class="n">zonal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">no_seconds</span><span class="o">=</span><span class="n">no_seconds</span><span class="p">,</span> <span class="n">bfdeg</span><span class="o">=</span><span class="n">bfdeg</span><span class="p">))</span>
<span class="c1">#                self.set_axobj(&#39;drawparallels&#39;, self.map.drawparallels(parallels,**kwp))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parallels</span> <span class="o">=</span> <span class="n">parallels</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parallels</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># - meridians</span>
            <span class="k">if</span> <span class="n">drawmeridians</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyhide_</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xhide&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span><span class="p">:</span>
                    <span class="n">zonal_labels</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">kwm</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">zonal_labels</span><span class="p">)])</span>
<span class="c1">#                kwm.update(kwpm_def)</span>
                <span class="n">kwm</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;xticklabels_&#39;</span><span class="p">))</span>
                <span class="n">kwm</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;drawmeridians&#39;</span><span class="p">,</span><span class="n">defaults</span><span class="o">=</span><span class="n">kwm</span><span class="p">)</span>
                <span class="n">kwgs</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwm</span><span class="p">,</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span>
                    <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;vmin&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">llcrnrlon</span><span class="p">,</span> <span class="s1">&#39;vmax&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">urcrnrlon</span><span class="p">,</span>
                        <span class="s1">&#39;minutes&#39;</span><span class="p">:</span><span class="n">minutes</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">meridians</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">meridians</span> <span class="o">=</span> <span class="n">geo_scale</span><span class="p">(</span><span class="o">**</span><span class="n">kwgs</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">meridians</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">meridians</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">&gt;=</span><span class="mf">360.</span><span class="p">:</span> <span class="c1"># to prevent overlaping</span>
                        <span class="n">meridians</span> <span class="o">=</span> <span class="n">meridians</span><span class="p">[</span><span class="n">meridians</span><span class="o">&lt;</span><span class="n">meridians</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">360.</span><span class="p">]</span>
                <span class="n">crnlon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">llcrnrlon</span><span class="p">,</span>
                <span class="n">meridians</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span>
                    <span class="n">_</span><span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">llcrnrlon</span> <span class="ow">and</span> <span class="n">_</span><span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">urcrnrlon</span><span class="p">,</span> <span class="n">meridians</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">minutes</span><span class="p">:</span>
                    <span class="n">kwm</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;fmt&#39;</span><span class="p">,</span>
                        <span class="n">MinuteLabel</span><span class="p">(</span><span class="n">meridians</span><span class="p">,</span> <span class="n">zonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">tex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">no_seconds</span><span class="o">=</span><span class="n">no_seconds</span><span class="p">,</span> <span class="n">bfdeg</span><span class="o">=</span><span class="n">bfdeg</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meridians</span> <span class="o">=</span> <span class="n">meridians</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meridians</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">addto3d</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">labstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                    <span class="sd">&quot;&quot;&quot;Handle lines ans labels for 3D plots&quot;&quot;&quot;</span>
                    <span class="n">coords</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axobj</span><span class="p">(</span><span class="n">what</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                            <span class="n">xy</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_xydata</span><span class="p">()</span>
                            <span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
                            <span class="n">x</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                            <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">what</span><span class="o">==</span><span class="s1">&#39;drawmeridians&#39;</span><span class="p">:</span>
                                <span class="n">lab</span> <span class="o">=</span> <span class="n">_setlatlab</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">labstyle</span><span class="p">)</span>
                                <span class="n">zdir</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
                                <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">lab</span> <span class="o">=</span> <span class="n">_setlonlab</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">labstyle</span><span class="p">)</span>
                                <span class="n">zdir</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
                                <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lab</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="n">ha</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                           <span class="n">zdir</span><span class="o">=</span><span class="n">zdir</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">coords</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">add_collection3d</span><span class="p">(</span><span class="n">LineCollection</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span>
                            <span class="n">linewidths</span><span class="o">=</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">get_linewidth</span><span class="p">()],</span>
                            <span class="n">linestyles</span><span class="o">=</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">get_linestyle</span><span class="p">()],</span>
                            <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">()],</span>
                            <span class="p">))</span>

            <span class="c1"># - bfdeg (bold face degrees) homogeneisation</span>
            <span class="k">if</span> <span class="n">minutes</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">drawparallels</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwp</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">],</span> <span class="n">MinuteLabel</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="n">drawmeridians</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwm</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">],</span> <span class="n">MinuteLabel</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="n">bfdeg</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
                    <span class="p">(</span><span class="n">kwp</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;bfdeg&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">kwm</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;bfdeg&#39;</span><span class="p">])):</span>
                    <span class="n">kwp</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;bfdeg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwm</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;bfdeg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># - draw</span>
            <span class="k">if</span> <span class="n">drawparallels</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;drawparallels&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">parallels</span><span class="p">,</span><span class="o">**</span><span class="n">kwp</span><span class="p">))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span><span class="p">:</span>
                    <span class="n">addto3d</span><span class="p">(</span><span class="s1">&#39;drawparallels&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">drawmeridians</span><span class="p">:</span>
                <span class="c1"># Draw</span>
                <span class="n">lonlabs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_axobj</span><span class="p">(</span><span class="s1">&#39;drawmeridians&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">meridians</span><span class="p">,</span><span class="o">**</span><span class="n">kwm</span><span class="p">))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span><span class="p">:</span>
                    <span class="n">addto3d</span><span class="p">(</span><span class="s1">&#39;drawmeridians&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwm</span><span class="p">)</span>
                <span class="c1"># Remove duplicated labels</span>
                <span class="n">llfound</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="n">lonlabs</span><span class="o">.</span><span class="n">keys</span><span class="p">()[:]:</span>
                    <span class="n">llm</span> <span class="o">=</span> <span class="n">ll</span><span class="o">%</span><span class="mf">360.</span>
                    <span class="n">istart</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">llm</span> <span class="ow">in</span> <span class="n">llfound</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">lab</span> <span class="ow">in</span> <span class="n">lonlabs</span><span class="p">[</span><span class="n">ll</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]:</span>
                        <span class="n">lab</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">llfound</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">llm</span><span class="p">)</span>

        <span class="c1"># Plot lows and highs</span>
        <span class="n">lowhighs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;lowhigh&#39;</span><span class="p">,</span> <span class="n">lowhighs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lowhighs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_lowhighs</span><span class="p">(</span><span class="o">**</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;lowhighs&#39;</span><span class="p">))</span>

        <span class="c1"># Plot arcgis image</span>
        <span class="n">arcgisimage</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;arcgisimage&#39;</span><span class="p">,</span> <span class="n">arcgisimage</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">arcgisimage</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_arcgisimage</span><span class="p">(</span><span class="n">arcgisimage</span><span class="p">,</span> <span class="o">**</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;arcgisimage&#39;</span><span class="p">))</span>

        <span class="c1"># Map scale and compass</span>
        <span class="k">if</span> <span class="n">mscp</span><span class="p">:</span>
            <span class="n">kw</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;mscp&#39;</span><span class="p">)</span>
            <span class="n">kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;mapscale_&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="n">kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;compass_&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_mscp</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># Map scale</span>
            <span class="k">if</span> <span class="n">mapscale</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_mapscale</span><span class="p">(</span><span class="o">**</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;mapscale_&#39;</span><span class="p">))</span>

            <span class="c1"># Compass</span>
            <span class="k">if</span> <span class="n">compass</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_compass</span><span class="p">(</span><span class="o">**</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;compass_&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">fullscreen</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Basic</span>
        <span class="n">Plot2D</span><span class="o">.</span><span class="n">post_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Map.get_best_loc"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.Map.get_best_loc">[docs]</a>    <span class="k">def</span> <span class="nf">get_best_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">onland</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Best location on the plot for an object according to land/sea mask&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">best_loc_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">onland</span><span class="o">=</span><span class="n">onland</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>



<span class="c1">############################################################</span>
<span class="c1">## Utilities</span>

<span class="k">def</span> <span class="nf">get_axis_scale</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an axis scale relative standard units</span>

<span class="sd">    It searches for the units of the axis,</span>
<span class="sd">    and guess conversion factor.</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **axis**: A :mod:`cdms2` axis.</span>
<span class="sd">        - **type**, optional: Its type.</span>
<span class="sd">          If ``None`` it is guessed.</span>
<span class="sd">          See :func:`~vacumm.misc.axes.axis_type`.</span>

<span class="sd">    :Return: A scalar which defaults to ``1.``</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">type</span> <span class="o">=</span> <span class="n">axis_type</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">units</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="o">==</span><span class="s1">&#39;-&#39;</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">units</span><span class="p">:</span> <span class="k">return</span> <span class="mf">1.</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]:</span>
        <span class="n">units</span>
        <span class="c1">#NOT FINISHED</span>

<div class="viewcode-block" id="get_quiverkey_value"><a class="viewcode-back" href="../../../library/misc.plot.html#vacumm.misc.core_plot.get_quiverkey_value">[docs]</a><span class="k">def</span> <span class="nf">get_quiverkey_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a decent value for a quiver key&quot;&quot;&quot;</span>
    <span class="c1"># Scalar</span>
    <span class="k">if</span> <span class="n">N</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="c1"># From components</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Reference value</span>
    <span class="k">if</span> <span class="n">mode</span><span class="o">==</span><span class="s1">&#39;max&#39;</span><span class="p">:</span>
        <span class="n">vref</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span><span class="o">==</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span>
        <span class="n">vref</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mode</span><span class="o">==</span><span class="s1">&#39;median&#39;</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Unkown quiverkey value mode: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
        <span class="n">vref</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">data</span>

    <span class="c1"># Quiverkey value</span>
    <span class="n">v10</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vref</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">v10</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">v10</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">v10</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">v10</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">v10</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">10.</span><span class="o">**</span><span class="n">v10</span></div>


<span class="c1">############################################################</span>
<span class="c1">## Locators</span>
<span class="c1">############################################################</span>



<div class="viewcode-block" id="AutoDateLocator2"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.AutoDateLocator2">[docs]</a><span class="k">class</span> <span class="nc">AutoDateLocator2</span><span class="p">(</span><span class="n">AutoDateLocator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A clever :class:`matplotlib.dates.AutoDateLocator`&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">noweek</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;noweek&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">AutoDateLocator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;maxticks&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">AutoDateLocator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldlocator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldlims</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">noweek</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">intervald</span><span class="p">[</span><span class="n">DAILY</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">][:</span><span class="mi">2</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">noweek</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">minticks</span> <span class="o">=</span> <span class="mi">3</span>

<div class="viewcode-block" id="AutoDateLocator2.get_locator"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.AutoDateLocator2.get_locator">[docs]</a>    <span class="k">def</span> <span class="nf">get_locator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># Check cache</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oldlocator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">_oldlims</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">get_view_interval</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">get_data_interval</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oldlocator</span>

        <span class="c1"># Get normal locator</span>
        <span class="n">locator</span> <span class="o">=</span> <span class="n">AutoDateLocator</span><span class="o">.</span><span class="n">get_locator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Rectifications</span>
        <span class="k">try</span><span class="p">:</span> <span class="c1"># sampling interval</span>
            <span class="n">sampling</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">rule</span><span class="o">.</span><span class="n">_rrule</span><span class="o">.</span><span class="n">_interval</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sampling</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">_base</span>
        <span class="n">update</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span> <span class="o">==</span> <span class="n">DAILY</span> <span class="ow">and</span> <span class="n">sampling</span><span class="o">%</span><span class="mi">7</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Fix daily/7 to weekly/monday locator (start on monday)</span>
            <span class="n">locator</span><span class="o">.</span><span class="n">rule</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">byweekday</span><span class="o">=</span><span class="n">MO</span><span class="p">)</span>
            <span class="n">locator</span><span class="o">.</span><span class="n">rule</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">update</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span> <span class="o">==</span> <span class="n">HOURLY</span> <span class="ow">and</span> <span class="n">sampling</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Fix hourly locator to start at midnight</span>
            <span class="n">good</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
            <span class="n">sampling</span> <span class="o">=</span> <span class="n">good</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">good</span><span class="p">,</span> <span class="n">sampling</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">good</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">sampling</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">locator</span><span class="o">.</span><span class="n">rule</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">byhour</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="n">sampling</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="n">locator</span><span class="o">.</span><span class="n">rule</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">update</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
            <span class="n">locator</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
            <span class="n">locator</span><span class="o">.</span><span class="n">set_view_interval</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">get_view_interval</span><span class="p">())</span>
            <span class="n">locator</span><span class="o">.</span><span class="n">set_data_interval</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">get_data_interval</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldlocator</span> <span class="o">=</span> <span class="n">locator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldlims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">get_view_interval</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">get_data_interval</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">locator</span></div></div>

<div class="viewcode-block" id="AutoDateMinorLocator"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.AutoDateMinorLocator">[docs]</a><span class="k">class</span> <span class="nc">AutoDateMinorLocator</span><span class="p">(</span><span class="n">AutoDateLocator2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An extension to the :class:`AutoDateLocator2` for minor locators&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;minticks&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;maxticks&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
        <span class="n">AutoDateLocator2</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<div class="viewcode-block" id="AutoDateMinorLocator.viewlim_to_dt"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.AutoDateMinorLocator.viewlim_to_dt">[docs]</a>    <span class="k">def</span> <span class="nf">viewlim_to_dt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">major_ticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">get_majorticklocs</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">num2date</span><span class="p">(</span><span class="n">major_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">),</span> <span class="n">num2date</span><span class="p">(</span><span class="n">major_ticks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">)</span></div>
<div class="viewcode-block" id="AutoDateMinorLocator.datalim_to_dt"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.AutoDateMinorLocator.datalim_to_dt">[docs]</a>    <span class="k">def</span> <span class="nf">datalim_to_dt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_view_interval</span><span class="p">()</span></div></div>


<span class="c1">############################################################</span>
<span class="c1">## Formatters</span>
<span class="c1">############################################################</span>

<div class="viewcode-block" id="AutoDateFormatter2"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.AutoDateFormatter2">[docs]</a><span class="k">class</span> <span class="nc">AutoDateFormatter2</span><span class="p">(</span><span class="n">AutoDateFormatter</span><span class="p">):</span>
    <span class="n">scaled</span> <span class="o">=</span> <span class="p">{</span>
           <span class="mf">365.0</span>  <span class="p">:</span> <span class="s1">&#39;%Y&#39;</span><span class="p">,</span>
           <span class="mf">30.</span>    <span class="p">:</span> <span class="s1">&#39;%b %Y&#39;</span><span class="p">,</span>
           <span class="mf">1.0</span>    <span class="p">:</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> %b&#39;</span><span class="p">,</span>
           <span class="mf">1.</span><span class="o">/</span><span class="mf">24.</span> <span class="p">:</span> <span class="s1">&#39;%Hh&#39;</span><span class="p">,</span>
           <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mf">24.</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;%Hh%M&#39;</span><span class="p">,</span>
           <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mf">24.</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span> <span class="p">:</span> <span class="s2">&quot;%M&#39;%Ss&#39;&#39;&quot;</span><span class="p">,</span>
           <span class="p">}</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">AutoDateFormatter</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span> <span class="o">=</span> <span class="n">AutoDateFormatter2</span><span class="o">.</span><span class="n">scaled</span></div>

<div class="viewcode-block" id="DualDateFormatter"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.DualDateFormatter">[docs]</a><span class="k">class</span> <span class="nc">DualDateFormatter</span><span class="p">(</span><span class="n">DateFormatter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Special formatter for dates</span>

<span class="sd">    Example: [&#39;00h 01/10/2000&#39; &#39;02h&#39; .... &#39;23h&#39;  &#39;00h 01/10/2000&#39;] to mark days and keep hours.</span>
<span class="sd">    Here the &#39;phase&#39; is 0 (00h) and the level is 3 (=&#39;day&#39;).</span>

<span class="sd">    .. todo:: DualDateFormatter: verify if dual_fmt is really used</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">locator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Which level?</span>
        <span class="n">slevels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;week&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;hour&#39;</span><span class="p">,</span> <span class="s1">&#39;minute&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isNumberType</span><span class="p">(</span><span class="n">level</span><span class="p">):</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">level</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">):</span>
                <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">slevels</span><span class="p">:</span>
                <span class="n">level</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">level</span> <span class="o">=</span> <span class="n">slevels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">locator</span>

        <span class="c1"># Autoformat</span>
        <span class="n">best_phases</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># Year</span>
            <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;%b&#39;</span>
            <span class="k">if</span> <span class="n">dual_fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dual_fmt</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">+</span><span class="s1">&#39;%n%Y&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># Month</span>
            <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%e</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="n">dual_fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dual_fmt</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">+</span><span class="s1">&#39;%n%b %Y&#39;</span>
            <span class="n">bast_phases</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">15</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="c1"># Week</span>
            <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%a</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="n">dual_fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dual_fmt</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">+</span><span class="s1">&#39;%n</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span>
            <span class="c1"># BAD PHASE FOR WEEKS! should be monday</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># Day</span>
            <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;%Hh&#39;</span>
            <span class="k">if</span> <span class="n">dual_fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dual_fmt</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">+</span><span class="s1">&#39;%n</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">-=</span><span class="mi">1</span>
            <span class="n">best_phases</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span> <span class="c1"># Hour</span>
            <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;%M&#39;&quot;</span>
            <span class="k">if</span> <span class="n">dual_fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dual_fmt</span> <span class="o">=</span> <span class="s1">&#39;%Hh&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">best_phases</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span> <span class="c1"># Minute</span>
            <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;%S&#39;&#39;&quot;</span>
            <span class="k">if</span> <span class="n">dual_fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dual_fmt</span> <span class="o">=</span> <span class="s2">&quot;%M&#39;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">best_phases</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;%Y&#39;</span>
                <span class="k">if</span> <span class="n">dual_fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dual_fmt</span> <span class="o">=</span> <span class="n">fmt</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;%M&#39;%Ss&#39;&#39;&quot;</span>
                <span class="k">if</span> <span class="n">dual_fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dual_fmt</span> <span class="o">=</span> <span class="n">fmt</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;%Y-</span><span class="si">%d</span><span class="s1">-%m %H:%M&#39;</span>
                <span class="k">if</span> <span class="n">dual_fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">dual_fmt</span> <span class="o">=</span> <span class="n">fmt</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">DateFormatter</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmt</span> <span class="o">=</span> <span class="n">fmt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dual_fmt</span> <span class="o">=</span> <span class="n">dual_fmt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reqphase</span> <span class="o">=</span> <span class="n">phase</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">phase</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span> <span class="n">phase</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">np</span> <span class="o">=</span> <span class="mi">5</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">phases</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># m,d,H,M,S</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">phases</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">phase</span>
            <span class="n">phases</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">phases</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="o">&lt;</span><span class="n">np</span><span class="p">:</span> <span class="c1"># tail is missing</span>
                    <span class="n">phase</span> <span class="o">+=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">phases</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">phase</span><span class="p">):])</span>
                <span class="k">else</span><span class="p">:</span> <span class="c1"># too much head</span>
                    <span class="n">phase</span> <span class="o">=</span> <span class="n">phase</span><span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">phase</span> <span class="o">=</span> <span class="n">phases</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span> <span class="n">phase</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_check_</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">dt</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">dt</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">second</span><span class="p">)),</span> <span class="p">)</span> <span class="o">==</span>
                    <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">locator</span><span class="p">:</span> <span class="c1"># check real case using locator</span>
                <span class="n">dates</span> <span class="o">=</span> <span class="n">num2date</span><span class="p">(</span><span class="n">locator</span><span class="p">())</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_check_</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">]):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">bp</span> <span class="ow">in</span> <span class="n">best_phases</span> <span class="ow">or</span> <span class="p">[]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_phase</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">bp</span>
                        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_phase_check_</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">]):</span>
                            <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span> <span class="c1"># fall back to the first date phase</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span> <span class="p">(</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span>
                            <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">second</span><span class="p">)),</span> <span class="p">))</span>



    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">num2date</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">)</span>

        <span class="c1"># Main label</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_check_</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_fmt</span><span class="p">)</span>

        <span class="c1"># Intermediate label</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmt</span><span class="p">)</span>

<div class="viewcode-block" id="DualDateFormatter.factory"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.DualDateFormatter.factory">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">factory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper to setup an appropriate formatter associated to a specified locator&quot;&quot;&quot;</span>
        <span class="c1"># Get best arguments for initializing and return instance</span>
        <span class="k">if</span> <span class="s1">&#39;level&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">AutoDateFormatter2</span><span class="o">.</span><span class="n">scaled</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">get_view_interval</span><span class="p">()</span>
            <span class="n">dtmin</span><span class="p">,</span> <span class="n">dtmax</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">viewlim_to_dt</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="s1">&#39;get_locator&#39;</span><span class="p">):</span>
                <span class="n">locator</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">get_locator</span><span class="p">(</span><span class="n">dtmin</span><span class="p">,</span> <span class="n">dtmax</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="s1">&#39;_freq&#39;</span><span class="p">):</span>
                <span class="n">freq</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">_freq</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">freq</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">rule</span><span class="o">.</span><span class="n">_freq</span>
            <span class="n">trange</span> <span class="o">=</span> <span class="n">tmax</span><span class="o">-</span><span class="n">tmin</span>
            <span class="k">if</span> <span class="n">freq</span> <span class="o">==</span> <span class="n">YEARLY</span> <span class="p">:</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;fmt&#39;</span><span class="p">,</span> <span class="n">AutoDateFormatter2</span><span class="o">.</span><span class="n">scaled</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                <span class="n">level</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
            <span class="k">elif</span> <span class="n">freq</span> <span class="o">==</span> <span class="n">MONTHLY</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">trange</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="o">*</span><span class="mi">365</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;fmt&#39;</span><span class="p">,</span> <span class="n">AutoDateFormatter2</span><span class="o">.</span><span class="n">scaled</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="s1">&#39;year&#39;</span>
            <span class="k">elif</span> <span class="n">freq</span> <span class="o">==</span> <span class="n">WEEKLY</span><span class="p">:</span>
                <span class="n">level</span> <span class="o">=</span> <span class="s1">&#39;month&#39;</span>
            <span class="k">elif</span> <span class="n">freq</span> <span class="o">==</span> <span class="n">DAILY</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">dtmax</span><span class="o">.</span><span class="n">month</span> <span class="o">!=</span> <span class="n">dtmin</span><span class="o">.</span><span class="n">month</span><span class="p">:</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="s1">&#39;month&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="s1">&#39;week&#39;</span>
            <span class="k">elif</span> <span class="n">freq</span> <span class="o">==</span> <span class="n">HOURLY</span><span class="p">:</span>
                <span class="n">level</span> <span class="o">=</span> <span class="s1">&#39;day&#39;</span>
            <span class="k">elif</span> <span class="n">freq</span> <span class="o">==</span> <span class="n">MINUTELY</span><span class="p">:</span>
                <span class="n">level</span> <span class="o">=</span> <span class="s1">&#39;hour&#39;</span>
            <span class="k">elif</span> <span class="n">freq</span> <span class="o">==</span> <span class="n">SECONDLY</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">trange</span><span class="o">&lt;</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">24.</span><span class="o">*</span><span class="mi">60</span><span class="p">):</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="s1">&#39;minute&#39;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;locator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">locator</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AutoDualDateFormatter"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.AutoDualDateFormatter">[docs]</a><span class="k">class</span> <span class="nc">AutoDualDateFormatter</span><span class="p">(</span><span class="n">Formatter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Automatic formatter that searches for the best :class:`DualDateFormatter`&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_locator</span> <span class="o">=</span> <span class="n">locator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_formatter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_formatter</span><span class="p">()</span>

<div class="viewcode-block" id="AutoDualDateFormatter.get_formatter"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.AutoDualDateFormatter.get_formatter">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DualDateFormatter</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_locator</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_formatter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_formatter</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span></div>

<span class="k">def</span> <span class="nf">_get_split_locator_</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ls</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
    <span class="n">lb</span> <span class="o">=</span> <span class="n">locator</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">ls</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;interval&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">locator</span> <span class="o">=</span> <span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">locator</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;by&#39;</span><span class="o">+</span><span class="n">locator</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">by</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">locator</span>


<span class="k">def</span> <span class="nf">setup_time_axis</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">locator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minor_locator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">minor_formatter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nominor</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">maxticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval_multiples</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Setup tick positions and labels of an time axis</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **axis**: :class:`~matplotlib.axis.Axis` instance (like ``P.gca().xaxis``)</span>
<span class="sd">        - **tz**, optional: Time zone.</span>
<span class="sd">        - **auto**, optional: Auto Scaling [default: True]</span>
<span class="sd">        - **rotation**, optional: Rotation angle of tick labels.</span>
<span class="sd">          If None, automatic [default: None]</span>
<span class="sd">        - **formatter**, optional: Date format:</span>

<span class="sd">            - &#39;mpl&#39; or 0 : use the internal Matplotlib auto date locator.</span>
<span class="sd">            - &quot;simple&quot; or 1 or &quot;auto&quot;: :class:`AutoDateFormatter2`</span>
<span class="sd">            - &quot;dual&quot;, 2, None, tuple or dict: :class:`AutoDualDateFormatter`</span>
<span class="sd">              (default)</span>
<span class="sd">            - String: :class:`DateFormatter`</span>
<span class="sd">            - else a :class:`matplotlib.ticker.Formatter` instance.</span>

<span class="sd">        - **locator**, optional: Major locator. Can be within</span>
<span class="sd">          [&#39;year&#39;,&#39;month&#39;,&#39;Weekday&#39;,&#39;day&#39;,&#39;hour&#39;,&#39;minute&#39;,&#39;second&#39;],</span>
<span class="sd">          be like :class:`matplotlib.dates.MonthLocator`.</span>
<span class="sd">          or have a special value:</span>

<span class="sd">            - None or &#39;auto&#39; or &#39;vacumm&#39;: use the :class:`AutoDateLocator`</span>
<span class="sd">              (default)</span>
<span class="sd">            - &#39;mpl&#39;: use the internal Matplotlib auto date locator.</span>

<span class="sd">        - **minor_locator**, optional: Minor locator.</span>
<span class="sd">        - **nominor**, optional: Do not try to add minor ticks [default: False]</span>
<span class="sd">        - **locator_&lt;keyword&gt;**, optional: &lt;keyword&gt; is passed to locator if</span>
<span class="sd">          locator is a string. If locator = &#39;month&#39;,</span>
<span class="sd">          locator = MonthLocator(locator_&lt;keyword&gt;=&lt;value&gt;).</span>
<span class="sd">        - **minor_locator_&lt;keyword&gt;**, optional: Same with minor_locator.</span>
<span class="sd">        - **maxticks**, optional: Maximal number of major ticks when</span>
<span class="sd">          default auto locator is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;xy&#39;</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">xy</span><span class="o">+</span><span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">axes</span>
    <span class="n">iaxis</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span> <span class="ow">is</span> <span class="n">axis</span><span class="p">)</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="s1">&#39;xy&#39;</span><span class="p">[</span><span class="n">iaxis</span><span class="p">]</span>
    <span class="n">yx</span> <span class="o">=</span> <span class="s1">&#39;yx&#39;</span><span class="p">[</span><span class="n">iaxis</span><span class="p">]</span>

    <span class="c1"># Base</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">axis_date</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">datetime</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">update_units</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Scale axes</span>
    <span class="k">if</span> <span class="n">auto</span><span class="p">:</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">autoscale_view</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;scale&#39;</span><span class="o">+</span><span class="n">xy</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;scale&#39;</span><span class="o">+</span><span class="n">yx</span><span class="p">:</span><span class="kc">False</span><span class="p">})</span>

    <span class="c1"># Guess locators</span>
    <span class="n">major_locator</span> <span class="o">=</span> <span class="n">locator</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;major_locator&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nominor</span><span class="p">:</span> <span class="n">minor_locator</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">locs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="s1">&#39;weekday&#39;</span><span class="p">,</span><span class="s1">&#39;day&#39;</span><span class="p">,</span><span class="s1">&#39;hour&#39;</span><span class="p">,</span><span class="s1">&#39;minute&#39;</span><span class="p">,</span><span class="s1">&#39;second&#39;</span><span class="p">]</span>
    <span class="n">locs</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="n">loc</span><span class="o">+</span><span class="s1">&#39;s&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">locs</span><span class="p">])</span>
    <span class="n">kwmjl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;major_locator&#39;</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;locator&#39;</span><span class="p">))</span>
    <span class="n">kwmnl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;minor_locator&#39;</span><span class="p">)</span>
    <span class="c1"># - major</span>
    <span class="k">if</span> <span class="n">major_locator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">major_locator</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">major_locator</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">major_locator</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;mpl&#39;</span><span class="p">:</span>
            <span class="n">major_locator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">major_locator</span> <span class="o">=</span> <span class="n">_get_split_locator_</span><span class="p">(</span><span class="n">major_locator</span><span class="p">,</span> <span class="n">kwmjl</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">major_locator</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="n">major_locator</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;vacumm&#39;</span><span class="p">):</span>
                <span class="n">maxticks</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nmax_ticks&#39;</span><span class="p">,</span> <span class="n">maxticks</span><span class="p">)</span> <span class="c1"># compat</span>
                <span class="n">kwmjl</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;maxticks&#39;</span><span class="p">,</span> <span class="n">maxticks</span><span class="p">)</span>
                <span class="n">major_locator</span> <span class="o">=</span> <span class="n">AutoDateLocator2</span><span class="p">(</span><span class="o">**</span><span class="n">kwmjl</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">major_locator</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">locs</span><span class="p">:</span>
                <span class="n">major_locator</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">major_locator</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;Locator(**kwmjl)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">major_locator</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">major_locator</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">major_locator</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">get_major_locator</span><span class="p">()</span>
    <span class="n">major_locator</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">major_locator</span><span class="p">,</span> <span class="s1">&#39;interval_multiples&#39;</span><span class="p">):</span>
        <span class="n">major_locator</span><span class="o">.</span><span class="n">interval_multiples</span> <span class="o">=</span> <span class="n">interval_multiples</span>
    <span class="c1"># - minor</span>
    <span class="k">if</span> <span class="n">minor_locator</span> <span class="ow">is</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">minor_locator</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">minor_locator</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">minor_locator</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">minor_locator</span> <span class="o">=</span> <span class="n">_get_split_locator_</span><span class="p">(</span><span class="n">minor_locator</span><span class="p">,</span> <span class="n">kwmnl</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minor_locator</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">locs</span><span class="p">:</span>
            <span class="n">minor_locator</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">minor_locator</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;Locator(**kwmnl)&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">minor_locator</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">):</span>
            <span class="n">minor_locator</span> <span class="o">=</span> <span class="n">AutoDateMinorLocator</span><span class="p">(</span><span class="o">**</span><span class="n">kwmnl</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">minor_locator</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">minor_locator</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">minor_locator</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">minor_locator</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">get_minor_locator</span><span class="p">()</span>
    <span class="n">minor_locator</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">minor_locator</span><span class="p">,</span> <span class="s1">&#39;interval_multiples&#39;</span><span class="p">):</span>
        <span class="n">minor_locator</span><span class="o">.</span><span class="n">interval_multiples</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1">#print &#39;minor_locator&#39;, minor_locator</span>
    <span class="c1">#print &#39;major_locator&#39;, major_locator</span>

    <span class="c1"># Tick format</span>
    <span class="c1"># - major</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="n">formatter</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fmt&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;major_formatter&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;dual&#39;</span> <span class="c1"># default</span>
    <span class="k">if</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;mpl&#39;</span> <span class="ow">or</span> <span class="n">fmt</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="c1"># matplotlib</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;simple&#39;</span> <span class="ow">or</span> <span class="n">fmt</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">fmt</span><span class="o">==</span><span class="s2">&quot;auto&quot;</span><span class="p">:</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">AutoDateFormatter2</span><span class="p">(</span><span class="n">major_locator</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span> <span class="ow">or</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">fmt</span>  <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">AutoDualDateFormatter</span><span class="p">(</span><span class="n">major_locator</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">DateFormatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">AutoDualDateFormatter</span><span class="p">(</span><span class="n">major_locator</span><span class="p">,</span> <span class="o">*</span><span class="n">fmt</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">AutoDualDateFormatter</span><span class="p">(</span><span class="n">major_locator</span><span class="p">,</span> <span class="o">**</span><span class="n">fmt</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">+=</span> <span class="p">({},</span> <span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="p">(</span><span class="n">fmt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">{})</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">DualDateFormatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">fmt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">fmt</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rotation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rotation</span><span class="o">!=</span><span class="mi">0</span> \
        <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="p">(</span><span class="n">DualDateFormatter</span><span class="p">,</span> <span class="n">AutoDualDateFormatter</span><span class="p">)):</span>
        <span class="n">P</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">get_majorticklabels</span><span class="p">(),</span> <span class="s2">&quot;rotation&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="p">)</span>
    <span class="c1"># - minor</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">nominor</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">minor_locator</span><span class="p">,</span> <span class="n">NullLocator</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">minor_formatter</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">minor_formatter</span> <span class="o">=</span> <span class="n">AutoDateFormatter2</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">minor_formatter</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="n">minor_formatter</span> <span class="o">=</span> <span class="n">DateFormatter</span><span class="p">(</span><span class="n">minor_formatter</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minor_formatter</span><span class="p">:</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">minor_formatter</span><span class="p">)</span>



<div class="viewcode-block" id="add_agg_filter"><a class="viewcode-back" href="../../../library/misc.plot.html#vacumm.misc.core_plot.add_agg_filter">[docs]</a><span class="k">def</span> <span class="nf">add_agg_filter</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a filtered version of objects to plot</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **objs**: :class:`matplotlib.artist.Artist` instances.</span>
<span class="sd">        - **filter**: :class:`vacumm.misc._ext_plot.BaseFilter` instance.</span>
<span class="sd">        - **zorder**, optional: zorder (else guess from ``objs``).</span>
<span class="sd">        - **ax**, optional: class:`matplotlib.axes.Axes` instance.</span>

<span class="sd">    Inspired from http://matplotlib.sourceforge.net/examples/pylab_examples/demo_agg_filter.html .</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Input</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">objs</span> <span class="o">=</span> <span class="p">[</span><span class="n">objs</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># Filter</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">shadows</span> <span class="o">=</span> <span class="n">FilteredArtistList</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="nb">filter</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="s1">&#39;add_artist&#39;</span><span class="p">):</span>
        <span class="n">add</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">shadows</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">add</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">shadows</span><span class="p">)</span>

    <span class="c1"># Text</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Text</span><span class="p">):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">set_path_effects</span><span class="p">([</span><span class="n">Normal</span><span class="p">()])</span>

    <span class="c1"># Adjust zorder</span>
    <span class="k">if</span> <span class="n">zorder</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">zorder</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">same</span> <span class="o">=</span> <span class="n">zorder</span> <span class="ow">is</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="s1">&#39;get_zorder&#39;</span><span class="p">):</span>
            <span class="n">zorder</span> <span class="o">=</span> <span class="n">objs</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zorder</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">same</span><span class="p">:</span>
            <span class="n">zorder</span> <span class="o">-=</span> <span class="mf">0.1</span>
    <span class="k">if</span> <span class="n">zorder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">shadows</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="n">zorder</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">shadows</span></div>

<div class="viewcode-block" id="add_shadow"><a class="viewcode-back" href="../../../library/misc.plot.html#vacumm.misc.core_plot.add_shadow">[docs]</a><span class="k">def</span> <span class="nf">add_shadow</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">xoffset</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">yoffset</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
        <span class="n">zorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a drop-shadow to objects</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **objs**: :class:`matplotlib.artist.Artist` instances.</span>
<span class="sd">        - **width**, optional: Width of the gaussian filter in points.</span>
<span class="sd">        - **xoffset**, optional: Shadow offset along X in points.</span>
<span class="sd">        - **yoffset**, optional: Shadow offset along Y in points.</span>
<span class="sd">        - **color**, optional: Color of the shadow.</span>
<span class="sd">        - **zorder**, optional: zorder (else guess from ``objs``).</span>
<span class="sd">        - **ax**, optional: class:`matplotlib.axes.Axes` instance.</span>

<span class="sd">    Inspired from http://matplotlib.sourceforge.net/examples/pylab_examples/demo_agg_filter.html .</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">color</span> <span class="o">=</span> <span class="n">RGB</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">gauss</span> <span class="o">=</span> <span class="n">DropShadowFilter</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="p">(</span><span class="n">xoffset</span><span class="p">,</span> <span class="n">yoffset</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">add_agg_filter</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">gauss</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="n">add</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Cannot plot shadows using agg filters&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="add_glow"><a class="viewcode-back" href="../../../library/misc.plot.html#vacumm.misc.core_plot.add_glow">[docs]</a><span class="k">def</span> <span class="nf">add_glow</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a glow effect to text</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **objs**: Plotted objects.</span>
<span class="sd">        - **width**, optional: Width of the gaussian filter in points.</span>
<span class="sd">        - **color**, optional: Color of the shadow.</span>
<span class="sd">        - **zorder**, optional: zorder (else guess from ``objs``).</span>
<span class="sd">        - **ax**, optional: class:`matplotlib.axes.Axes` instance.</span>

<span class="sd">    Inspired from http://matplotlib.sourceforge.net/examples/pylab_examples/demo_agg_filter.html .</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">color</span> <span class="o">=</span> <span class="n">RGB</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">white_glows</span> <span class="o">=</span> <span class="n">GrowFilter</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">add_agg_filter</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">white_glows</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="n">add</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
         <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Cannot add glow effect using agg filters&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="add_lightshading"><a class="viewcode-back" href="../../../library/misc.plot.html#vacumm.misc.core_plot.add_lightshading">[docs]</a><span class="k">def</span> <span class="nf">add_lightshading</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a light shading effect to objects</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **objs**: Plotted objects.</span>
<span class="sd">        - **width**, optional: Width of the gaussian filter in points.</span>
<span class="sd">        - **fraction**, optional: Unknown.</span>
<span class="sd">        - **zorder**, optional: zorder (else guess from ``objs``).</span>
<span class="sd">        - **ax**, optional: class:`matplotlib.axes.Axes` instance.</span>
<span class="sd">        - Extra keywords are passed to :class:`matplotlib.colors.LightSource`</span>

<span class="sd">    Inspired from http://matplotlib.sourceforge.net/examples/pylab_examples/demo_agg_filter.html .</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">zorder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">zorder</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">lf</span> <span class="o">=</span> <span class="n">LightFilter</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="n">fraction</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">add_agg_filter</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">lf</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="n">add</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
         <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Cannot add light shading effect using agg filters&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="MinuteLabel"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.MinuteLabel">[docs]</a><span class="k">class</span> <span class="nc">MinuteLabel</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">zonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">bfdeg</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bfdeg&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Basemap</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">bfdeg</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">bfdeg</span><span class="o">==</span><span class="s1">&#39;auto&#39;</span><span class="p">):</span>
            <span class="n">bfdeg</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">N</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">%</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ptp</span><span class="p">()</span><span class="o">!=</span><span class="mi">0</span>
        <span class="k">if</span> <span class="n">zonal</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Basemap</span><span class="p">):</span>
                <span class="n">auto_minutes</span> <span class="o">=</span>  <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">urcrnrlon</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">llcrnrlon</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">auto_minutes</span> <span class="o">=</span>  <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">lonlab</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Basemap</span><span class="p">):</span>
                <span class="n">auto_minutes</span> <span class="o">=</span>  <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">urcrnrlat</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">llcrnrlat</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">auto_minutes</span> <span class="o">=</span>  <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">latlab</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;bfdeg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bfdeg</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;decimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;no_zeros&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;auto_minutes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">auto_minutes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deg</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">deg</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutoDegreesMinutesLocator"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.AutoDegreesMinutesLocator">[docs]</a><span class="k">class</span> <span class="nc">AutoDegreesMinutesLocator</span><span class="p">(</span><span class="n">AutoLocator</span><span class="p">):</span>
<div class="viewcode-block" id="AutoDegreesMinutesLocator.bin_boundaries"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.AutoDegreesMinutesLocator.bin_boundaries">[docs]</a>    <span class="k">def</span> <span class="nf">bin_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">):</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">mn</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">60.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">vmax</span><span class="o">-</span><span class="n">vmin</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">50.</span><span class="p">:</span>
            <span class="n">steps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">vmax</span><span class="o">-</span><span class="n">vmin</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">3.</span><span class="p">:</span>
            <span class="n">steps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">vmax</span><span class="o">//</span><span class="n">mn</span> <span class="o">!=</span> <span class="n">vmin</span><span class="o">//</span><span class="n">mn</span><span class="p">:</span>
            <span class="n">nmn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">vmax</span><span class="o">-</span><span class="n">vmin</span><span class="p">)</span><span class="o">*</span><span class="mf">60.</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">nmax</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="k">if</span> <span class="n">nmn</span> <span class="o">&gt;</span> <span class="n">nmax</span><span class="p">:</span>
                <span class="n">steps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mi">15</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mi">20</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mi">30</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">AutoLocator</span><span class="o">.</span><span class="n">bin_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="AutoDegreesMinutesFormatter"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.AutoDegreesMinutesFormatter">[docs]</a><span class="k">class</span> <span class="nc">AutoDegreesMinutesFormatter</span><span class="p">(</span><span class="n">Formatter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Phase formatter with degrees and minutes</span>

<span class="sd">    :Example:</span>

<span class="sd">        &gt;&gt;&gt; locator = xaxis.get_major_locator()</span>
<span class="sd">        &gt;&gt;&gt; xaxis.set_formatter(AutoDegreesMinutesFormatter(locator, label=&#39;lon&#39;))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="n">Locator</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">locator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;decimal&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locator</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locator</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locator</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">get_view_interval</span><span class="p">()</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;auto_minutes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmax</span><span class="o">//</span><span class="mi">1</span> <span class="o">!=</span> <span class="n">vmax</span><span class="o">//</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">phaselab</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>



<div class="viewcode-block" id="DepthFormatter"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.DepthFormatter">[docs]</a><span class="k">class</span> <span class="nc">DepthFormatter</span><span class="p">(</span><span class="n">Formatter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:g}</span><span class="s2">m&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>

<div class="viewcode-block" id="twinxy"><a class="viewcode-back" href="../../../library/misc.core_plot.html#vacumm.misc.core_plot.twinxy">[docs]</a><span class="k">def</span> <span class="nf">twinxy</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create an :func:`~matplotlib.axes.Axes` instance based on existing one(s)*</span>

<span class="sd">    This is an fusion and extension of :func:`matplotlib.pyplot.twinx` and</span>
<span class="sd">    :func:`matplotlib.pyplot.twiny`</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **xy**: A string containing ``&quot;x&quot;`` and/or ``&quot;y&quot;``</span>
<span class="sd">        - **ax**, optional: Consider this axes instance instead of the current one.</span>
<span class="sd">        - **fig**, optional: Consider this figure instead of the current one.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> <span class="k">return</span> <span class="n">ax</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">figure</span>
    <span class="n">twinx</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span> <span class="ow">in</span> <span class="n">xy</span>
    <span class="n">twiny</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span> <span class="ow">in</span> <span class="n">xy</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">twinx</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">twiny</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span>
    <span class="n">kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">twinx</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">twiny</span><span class="p">:</span>
        <span class="n">kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sharex</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">twiny</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">twinx</span><span class="p">:</span>
        <span class="n">kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sharey</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">nax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">twinx</span><span class="p">:</span>
        <span class="n">nax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
        <span class="n">nax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">twiny</span><span class="p">:</span> <span class="n">nax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">twiny</span><span class="p">:</span>
        <span class="n">nax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>
        <span class="n">nax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">twinx</span><span class="p">:</span> <span class="n">nax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nax</span></div>


<span class="k">def</span> <span class="nf">_add_label_</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ay0</span><span class="p">,</span> <span class="n">ay1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="n">ha</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">shadow</span><span class="p">,</span> <span class="n">glow</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">figure</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">*</span><span class="n">b</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">ax1</span><span class="o">*</span><span class="n">b</span><span class="o">.</span><span class="n">x1</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">ay0</span><span class="o">*</span><span class="n">b</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">ay1</span><span class="o">*</span><span class="n">b</span><span class="o">.</span><span class="n">y1</span>
    <span class="n">kwsh</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;shadow&#39;</span><span class="p">)</span>
    <span class="n">kwgl</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;glow&#39;</span><span class="p">)</span>
    <span class="n">o</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="n">va</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="n">ha</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span>
        <span class="n">add_shadow</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwsh</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">glow</span><span class="p">:</span>
        <span class="n">add_glow</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwgl</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">o</span>

<div class="viewcode-block" id="add_left_label"><a class="viewcode-back" href="../../../library/misc.plot.html#vacumm.misc.core_plot.add_left_label">[docs]</a><span class="k">def</span> <span class="nf">add_left_label</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">pos</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="mf">90.</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a text label to the left of a plot&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_add_label_</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">pos</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="n">ha</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">shadow</span><span class="p">,</span> <span class="n">glow</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="add_right_label"><a class="viewcode-back" href="../../../library/misc.plot.html#vacumm.misc.core_plot.add_right_label">[docs]</a><span class="k">def</span> <span class="nf">add_right_label</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">pos</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=-</span><span class="mf">90.</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a text label to the left of a plot&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_add_label_</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">pos</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="n">ha</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">shadow</span><span class="p">,</span> <span class="n">glow</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="add_top_label"><a class="viewcode-back" href="../../../library/misc.plot.html#vacumm.misc.core_plot.add_top_label">[docs]</a><span class="k">def</span> <span class="nf">add_top_label</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">pos</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a text label to the left of a plot&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_add_label_</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="n">ha</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">shadow</span><span class="p">,</span> <span class="n">glow</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="add_bottom_label"><a class="viewcode-back" href="../../../library/misc.plot.html#vacumm.misc.core_plot.add_bottom_label">[docs]</a><span class="k">def</span> <span class="nf">add_bottom_label</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">pos</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">glow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a text label to the left of a plot&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_add_label_</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">pos</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="n">ha</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">shadow</span><span class="p">,</span> <span class="n">glow</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<span class="n">_locations</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span>
         <span class="s1">&#39;upper left&#39;</span><span class="p">,</span>
         <span class="s1">&#39;lower left&#39;</span><span class="p">,</span>
         <span class="s1">&#39;lower right&#39;</span><span class="p">,</span>
         <span class="s1">&#39;center left&#39;</span><span class="p">,</span>
         <span class="s1">&#39;center right&#39;</span><span class="p">,</span>
         <span class="s1">&#39;lower center&#39;</span><span class="p">,</span>
         <span class="s1">&#39;upper center&#39;</span><span class="p">,</span>
         <span class="s1">&#39;center center&#39;</span><span class="p">,</span>
         <span class="s1">&#39;center&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">loc2tuple</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">xpad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Location as tuple of (x,y) in relative coordinates&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span> <span class="k">return</span> <span class="n">loc</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">loc</span>
    <span class="k">assert</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">_locations</span><span class="p">,</span> <span class="s1">&#39;loc must be a tuple or a string (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span> <span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_locations</span><span class="p">))</span>
    <span class="n">sy</span><span class="p">,</span> <span class="n">sx</span> <span class="o">=</span> <span class="n">loc</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">xpad</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xpad</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xpad</span><span class="o">&gt;.</span><span class="mi">5</span><span class="p">:</span> <span class="n">xpad</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">xpad</span>
    <span class="n">ypad</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ypad</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ypad</span><span class="o">&gt;.</span><span class="mi">5</span><span class="p">:</span> <span class="n">ypad</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">ypad</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;left&quot;</span><span class="p">:</span><span class="n">xpad</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span><span class="mi">1</span><span class="o">-</span><span class="n">ypad</span><span class="p">}[</span><span class="n">sx</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lower&quot;</span><span class="p">:</span><span class="n">xpad</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span><span class="mi">1</span><span class="o">-</span><span class="n">ypad</span><span class="p">}[</span><span class="n">sy</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">loc2align</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">3.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;From location to dict of ha and va</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **loc**: (x,y) or string like &quot;upper right.</span>
<span class="sd">        - **ha/va**, optional: alignments.</span>

<span class="sd">    :Return: dict(ha=ha, va=va)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">loc2tuple</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">xpad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ha</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">margin</span><span class="p">:</span>
            <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>
        <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">margin</span><span class="p">):</span>
            <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
    <span class="k">if</span> <span class="n">va</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">margin</span><span class="p">:</span>
            <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span>
        <span class="k">elif</span> <span class="n">y</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">margin</span><span class="p">):</span>
            <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ha</span><span class="o">=</span><span class="n">ha</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="n">va</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">loc2offset</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">xpad</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">3.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;From location to (xoffset, ypoffset) where x/yoffset = +/- x/ypad</span>

<span class="sd">    :Return: (xoffset,yoffset)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">align</span> <span class="o">=</span> <span class="n">loc2align</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">)</span>
    <span class="n">xoffset</span> <span class="o">=</span> <span class="n">yoffset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">ypad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ypad</span> <span class="o">=</span> <span class="n">xpad</span>
    <span class="k">if</span> <span class="n">align</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
        <span class="n">xoffset</span> <span class="o">=</span> <span class="n">xpad</span>
    <span class="k">elif</span> <span class="n">align</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
        <span class="n">xoffset</span> <span class="o">=</span> <span class="o">-</span><span class="n">xpad</span>
    <span class="k">if</span> <span class="n">align</span><span class="p">[</span><span class="s1">&#39;va&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span><span class="p">:</span>
        <span class="n">yoffset</span> <span class="o">=</span> <span class="o">-</span><span class="n">ypad</span>
    <span class="k">elif</span> <span class="n">align</span><span class="p">[</span><span class="s1">&#39;va&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bottom&#39;</span><span class="p">:</span>
        <span class="n">yoffset</span> <span class="o">=</span> <span class="n">ypad</span>
    <span class="k">return</span> <span class="n">xoffset</span><span class="p">,</span> <span class="n">yoffset</span>


<span class="k">def</span> <span class="nf">best_loc_map</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">onland</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="n">_locations</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find the best location on a plot map according to the land/ocean repartition&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Map</span><span class="p">):</span> <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">map</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;coastpolygons&#39;</span><span class="p">):</span>
        <span class="n">sloc</span> <span class="o">=</span> <span class="n">allowed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">grid.masking</span> <span class="k">import</span> <span class="n">polygons</span>
        <span class="kn">from</span> <span class="nn">grid</span> <span class="k">import</span> <span class="n">bounds2d</span>
        <span class="kn">from</span> <span class="nn">_geoslib</span> <span class="k">import</span> <span class="n">Polygon</span>
        <span class="n">fractions</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">polys</span> <span class="o">=</span> <span class="n">polygons</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">xmin</span> <span class="o">+</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">xmax</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">xmin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="o">+</span><span class="n">N</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mf">3.</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">ymin</span> <span class="o">+</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">ymax</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">ymin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="o">+</span><span class="n">N</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mf">3.</span>
        <span class="n">xxb</span><span class="p">,</span> <span class="n">yyb</span> <span class="o">=</span> <span class="n">bounds2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">pcell</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xxb</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">yyb</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">pcoast</span> <span class="ow">in</span> <span class="n">polys</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">pcell</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="n">pcoast</span><span class="p">):</span>
                        <span class="n">fractions</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
                        <span class="k">break</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">pcell</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">pcoast</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pcell</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">pcoast</span><span class="p">):</span>
                        <span class="n">fractions</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">p</span><span class="o">.</span><span class="n">area</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">onland</span><span class="p">:</span>
            <span class="n">fractions</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">fractions</span>
        <span class="n">jmax</span><span class="p">,</span> <span class="n">imax</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">fractions</span><span class="o">.</span><span class="n">argmax</span><span class="p">())</span>
        <span class="n">sloc</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">([</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">][</span><span class="n">imax</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">][</span><span class="n">jmax</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">_loc2tuple_</span><span class="p">(</span><span class="n">sloc</span><span class="p">)</span>




<div class="viewcode-block" id="add_param_label"><a class="viewcode-back" href="../../../library/misc.plot.html#vacumm.misc.core_plot.add_param_label">[docs]</a><span class="k">def</span> <span class="nf">add_param_label</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.4&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;monospace&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add parameters description to the bottom/left of the figure</span>

<span class="sd">    :Example:</span>

<span class="sd">        &gt;&gt;&gt; c = curve2(sst, show=False)</span>
<span class="sd">        &gt;&gt;&gt; c.add_param_label(dict(max=.23, kz=0.25))</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **text**: Either a string or a dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert dict to text</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">clsname</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">tt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">=</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">item</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">loc2tuple</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">xpad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">family</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>



<span class="k">class</span> <span class="nc">Animator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Animate objects on a figure</span>

<span class="sd">    :Example:</span>

<span class="sd">        &gt;&gt;&gt; anim = Animator()</span>
<span class="sd">        &gt;&gt;&gt; anim.append(P.plot([5,6])</span>
<span class="sd">        &gt;&gt;&gt; anim.append(P.plot([4,8])</span>
<span class="sd">        &gt;&gt;&gt; anim.make_animation()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">fig</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Set frame index</span>
        <span class="n">nobjs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">frame</span> <span class="o">==</span> <span class="s1">&#39;last&#39;</span><span class="p">:</span>
            <span class="n">frame</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">frame</span><span class="o">==</span><span class="s1">&#39;new&#39;</span><span class="p">:</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">nobjs</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">frame</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">frame</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nobjs</span><span class="o">-</span><span class="n">frame</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">frame</span><span class="o">&gt;</span><span class="n">nobjs</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">frame</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">frame</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">nobjs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>

        <span class="c1"># Get layer</span>
        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># New layer</span>
            <span class="n">frameobjs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frameobjs</span><span class="p">)</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># Old layer</span>
            <span class="n">frameobjs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objs</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span>

        <span class="c1"># Append data</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;get_figure&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">obj</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">==</span> <span class="n">obj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
            <span class="n">frameobjs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;get_figure&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">==</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
            <span class="n">frameobjs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">frame</span>

    <span class="k">def</span> <span class="nf">make_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create the animation object&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">objs</span><span class="p">:</span> <span class="k">return</span>
        <span class="kn">from</span> <span class="nn">matplotlib.animation</span> <span class="k">import</span> <span class="n">ArtistAnimation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="n">ArtistAnimation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span>


<div class="viewcode-block" id="hlitvs"><a class="viewcode-back" href="../../../library/misc.plot.html#vacumm.misc.core_plot.hlitvs">[docs]</a><span class="k">def</span> <span class="nf">hlitvs</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;.95&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxticks</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Highlight intervals between ticks</span>

<span class="sd">    :Params:</span>

<span class="sd">        - *color*: Background color.</span>
<span class="sd">        - *axis*: Matplotlib axis or &#39;x&#39;/&#39;y&#39;.</span>
<span class="sd">        - **units**, optional: Interval types</span>

<span class="sd">            - `&quot;ticks&quot;`: Use axis ticks.</span>
<span class="sd">            - A list or array: use it as ticks.</span>
<span class="sd">            - `&quot;auto&quot;`: Estimate ticks using :class:`~matplotlib.ticker.AutoLocator`.</span>
<span class="sd">            - `&quot;date&quot;` or `&quot;time&quot;`: Same but using :class:`AutoDateLocator2`.</span>
<span class="sd">            - A time string like `&quot;day&quot;` for using :class:`~matplotlib.dates.DayLocator`.</span>
<span class="sd">            - A locator.</span>

<span class="sd">        - Other keyparam are passed to :func:`~matplotlib.pyplot.axhspan`</span>
<span class="sd">          or :func:`~matplotlib.pyplot.axvspan`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get axis</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">Axes</span><span class="p">):</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">axis</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">units</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">):</span> <span class="n">units</span> <span class="o">=</span> <span class="n">units</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">axis</span><span class="o">+</span><span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="s1">&#39;xy&#39;</span><span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">YAxis</span><span class="p">)]</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">axes</span>

    <span class="c1"># Locators and ticks</span>
    <span class="n">kwloc</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;locator_&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">units</span><span class="o">==</span><span class="s1">&#39;ticks&#39;</span><span class="p">:</span>
        <span class="n">ticks</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">get_ticklocs</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="n">ticks</span> <span class="o">=</span> <span class="n">units</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># locator</span>
        <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">AutoLocator</span><span class="p">(</span><span class="o">**</span><span class="n">kwloc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">units</span><span class="o">==</span><span class="s1">&#39;date&#39;</span> <span class="ow">or</span> <span class="n">units</span><span class="o">==</span><span class="s1">&#39;time&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">AutoDateLocator2</span><span class="p">(</span><span class="o">**</span><span class="n">kwloc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">dates</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;Locator&#39;</span><span class="p">)(</span><span class="o">**</span><span class="n">kwloc</span><span class="p">)</span>
        <span class="n">locator</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">ticks</span> <span class="o">=</span> <span class="n">locator</span><span class="p">()</span>
    <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">get_view_interval</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">ticks</span> <span class="o">=</span> <span class="n">ticks</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ticks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tmin</span><span class="o">!=</span><span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">ticks</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmin</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tmax</span><span class="o">!=</span><span class="n">ticks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="n">ticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmax</span><span class="p">)</span>

    <span class="c1"># Patch</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">RGBA</span><span class="p">(</span><span class="n">color</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;_nolegend_&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="n">objs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">axspan</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="s1">&#39;ax</span><span class="si">%s</span><span class="s1">span&#39;</span><span class="o">%</span><span class="s1">&#39;vh&#39;</span><span class="p">[</span><span class="n">xy</span><span class="o">==</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">axspan</span><span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ticks</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
<span class="c1">#        objs[-1].set_zorder(0)</span>
    <span class="k">return</span> <span class="n">objs</span></div>


<span class="k">class</span> <span class="nc">_PPatch</span><span class="p">(</span><span class="n">Patch</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for patches with size in pixels.</span>

<span class="sd">    You must define your coordinates in  attribute _path_coords</span>
<span class="sd">    between -5 and 5.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Compass(</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">;</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">anglemode</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span> <span class="n">posref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *xy*</span>
<span class="sd">          center of compass</span>

<span class="sd">        *size*</span>
<span class="sd">          size of compass</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Patch</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">anglemode</span> <span class="o">=</span> <span class="n">anglemode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">posref</span> <span class="o">=</span> <span class="n">posref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>

        <span class="n">path_coords</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path_coords</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
        <span class="n">path_coords</span> <span class="o">*=</span> <span class="mf">0.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path_coords</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_patch_transform</span> <span class="o">=</span> <span class="n">mtransforms</span><span class="o">.</span><span class="n">IdentityTransform</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">_update_transform_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_patch_transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pixrot_transform_</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_pixrot_transform_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="n">Artist</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_transform_set</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">_transform_pixrot_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">anglemode</span><span class="p">,</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">posref</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">posref</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_patch_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_transform_</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patch_transform</span>

    <span class="k">def</span> <span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span>

    <span class="k">def</span> <span class="nf">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">Patch</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">+</span><span class="n">mtransforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_transform_</span><span class="p">()</span>
        <span class="n">Patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">QuarterRightCompass</span><span class="p">(</span><span class="n">_PPatch</span><span class="p">):</span>
    <span class="n">_path_coords</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="c1">#    _path_coords = [[0, 0], [1, 0], [1, 1], [0, 1]]</span>
<span class="k">class</span> <span class="nc">QuarterLeftCompass</span><span class="p">(</span><span class="n">_PPatch</span><span class="p">):</span>
    <span class="n">_path_coords</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>

<span class="k">class</span> <span class="nc">ArrowCompass</span><span class="p">(</span><span class="n">_PPatch</span><span class="p">):</span>
    <span class="n">_path_coords</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-.</span><span class="mi">75</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="o">-.</span><span class="mi">25</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">],</span>
        <span class="p">[</span><span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]]</span>

<span class="k">class</span> <span class="nc">PPText</span><span class="p">(</span><span class="n">Text</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vc_offset</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vc_ppatch</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ppatch&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">Text</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vc_ppatch</span><span class="o">.</span><span class="n">_get_pixrot_transform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vc_ppatch</span><span class="o">.</span><span class="n">size</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_vc_offset</span><span class="p">)</span><span class="o">+</span> \
            <span class="n">Artist</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vc_ppatch</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vc_ppatch</span><span class="o">.</span><span class="n">offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">mtransforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_vc_ppatch</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span>

<span class="k">def</span> <span class="nf">_transform_</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span>
    <span class="k">if</span> <span class="n">transform</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">default</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">transform</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;figure&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span> <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ax</span><span class="o">.</span><span class="n">fig</span>
            <span class="k">return</span> <span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;trans&#39;</span><span class="o">+</span><span class="n">transform</span><span class="o">.</span><span class="n">title</span><span class="p">()):</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;trans&#39;</span><span class="o">+</span><span class="n">transform</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">transform</span>


<span class="k">def</span> <span class="nf">_transform_pixrot_</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">anglemode</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">posref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Special transform: size in pixel, rotation, translation in data</span>

<span class="sd">        :Params:</span>

<span class="sd">            - **trandform**: Transform for the center location.</span>
<span class="sd">            - **posref**: Reference point for the angle if anglemode == &#39;data&#39;.</span>
<span class="sd">              It default to the center. Values must be in data coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="n">_transform_</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

        <span class="c1"># center</span>
        <span class="n">xp0</span><span class="p">,</span> <span class="n">yp0</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>

        <span class="c1"># scales</span>
        <span class="n">xp1</span><span class="p">,</span> <span class="n">yp1</span> <span class="o">=</span> <span class="n">xp0</span> <span class="o">+</span> <span class="n">size</span><span class="p">,</span>  <span class="n">yp0</span> <span class="o">+</span> <span class="n">size</span>
        <span class="n">xcorner</span><span class="p">,</span> <span class="n">ycorner</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">xp1</span><span class="p">,</span> <span class="n">yp1</span><span class="p">))</span>
        <span class="n">xscale</span> <span class="o">=</span> <span class="n">xcorner</span><span class="o">-</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yscale</span> <span class="o">=</span> <span class="n">ycorner</span><span class="o">-</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># angle</span>
        <span class="n">anglemode</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">anglemode</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">anglemode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">anglemode</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;dot&#39;</span><span class="p">):</span> <span class="n">anglemode</span> <span class="o">=</span> <span class="s1">&#39;pixels&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">anglemode</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;pix&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">anglemode</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;dat&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Unkown anglemode: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">anglemode</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">anglemode</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;dat&#39;</span><span class="p">):</span> <span class="c1"># from data to pixels</span>

            <span class="n">ar</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">posref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">posref</span> <span class="o">=</span> <span class="n">center</span>
                <span class="k">if</span> <span class="n">transform</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="p">:</span>
                    <span class="n">posref</span> <span class="o">=</span> <span class="p">(</span><span class="n">transform</span><span class="o">-</span><span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="p">)</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="n">posref</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">posref</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">1.e20</span> <span class="ow">or</span> <span class="n">posref</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">1e20</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Coordinates of reference seems wrong: </span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="nb">tuple</span><span class="p">(</span><span class="n">posref</span><span class="p">))</span>
            <span class="n">xlen</span> <span class="o">=</span> <span class="n">ylen</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">posref</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span>
            <span class="n">xr0</span><span class="p">,</span> <span class="n">yr0</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="n">posref</span><span class="p">)</span>
            <span class="n">xr1</span><span class="p">,</span> <span class="n">yr1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">posref</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">xlen</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ar</span><span class="p">),</span>
                <span class="n">posref</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">ylen</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ar</span><span class="p">)))</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">yr1</span><span class="o">-</span><span class="n">yr0</span><span class="p">,</span> <span class="n">xr1</span><span class="o">-</span><span class="n">xr0</span><span class="p">))</span>

        <span class="c1"># Transform</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">mtransforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span> \
            <span class="o">.</span><span class="n">rotate_deg</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> \
            <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span><span class="p">)</span> \
            <span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">*</span><span class="n">center</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span>

<span class="k">def</span> <span class="nf">_add_text_</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwtext</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">_set_artist_props</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwtext</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>

<div class="viewcode-block" id="add_compass"><a class="viewcode-back" href="../../../library/misc.plot.html#vacumm.misc.core_plot.add_compass">[docs]</a><span class="k">def</span> <span class="nf">add_compass</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">facecolor1</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">facecolor2</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
    <span class="n">text_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">text_size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">text_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s1">&#39;simple&#39;</span><span class="p">,</span>
    <span class="n">angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">anglemode</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwpatch</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a compass to the current plot</span>

<span class="sd">    :Params:</span>

<span class="sd">        - **x/y**: Position in data coordinates.</span>
<span class="sd">        - **size**, optional: size in opixels.</span>
<span class="sd">        - **style**, optional: &quot;simple&quot;, &quot;fancy&quot;.</span>
<span class="sd">        - **angle**, optional: Angle of the north (trigo).</span>
<span class="sd">        - **anglemode**, optional: &quot;pixels&quot; or &quot;data&quot;.</span>
<span class="sd">        - **facecolor1**, optional: Dark face color.</span>
<span class="sd">        - **facecolor2**, optional: Light face color.</span>
<span class="sd">        - **edgecolor**, optional: Edges color.</span>
<span class="sd">        - **text_color**, optional: Text labels color.</span>
<span class="sd">        - **text_size**, optional: Text labels size.</span>
<span class="sd">        - **text_&lt;param&gt;**, optional: ``&lt;param&gt;`` is passed to</span>
<span class="sd">          :class:`~matplotlib.text.Text` when adding labels.</span>
<span class="sd">        - **fontsize/color**, optional: Same as ``text_size/color``.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">kwtext</span> <span class="o">=</span> <span class="n">kwfilter</span><span class="p">(</span><span class="n">kwpatch</span><span class="p">,</span> <span class="s1">&#39;text_&#39;</span><span class="p">)</span>
    <span class="n">kwtext</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">text_color</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">text_size</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">ax</span> <span class="ow">or</span> <span class="n">m</span><span class="o">.</span><span class="n">_check_ax</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;arrow&#39;</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">style</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>



    <span class="c1"># Loop on quarters</span>
    <span class="n">dict_check_defaults</span><span class="p">(</span><span class="n">kwpatch</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">)</span>
    <span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">style</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">style</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">):</span>

        <span class="c1"># Patch</span>
        <span class="n">kwp</span> <span class="o">=</span> <span class="n">kwpatch</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">kwp</span><span class="p">[</span><span class="s1">&#39;facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">facecolor1</span>
        <span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">ArrowCompass</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">size</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">anglemode</span><span class="o">=</span><span class="n">anglemode</span><span class="p">,</span> <span class="o">**</span><span class="n">kwp</span><span class="p">)))</span>

        <span class="c1"># Label (north only)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">PPText</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">text_pad</span><span class="p">,</span> <span class="n">ppatch</span><span class="o">=</span><span class="n">patches</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_add_text_</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwtext</span><span class="p">))</span>

    <span class="k">elif</span> <span class="n">style</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">iq</span><span class="p">,</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">ha</span><span class="p">,</span> <span class="n">va</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span>
            <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">)]):</span>

            <span class="n">aa</span> <span class="o">=</span> <span class="n">iq</span><span class="o">*</span><span class="mf">90.</span>

            <span class="c1"># Loop on back/white patches</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">fc</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="p">(</span><span class="n">QuarterRightCompass</span><span class="p">,</span> <span class="n">facecolor1</span><span class="p">),</span>
                <span class="p">(</span><span class="n">QuarterLeftCompass</span><span class="p">,</span> <span class="n">facecolor2</span><span class="p">),</span>
                <span class="p">][:]:</span>
                <span class="n">kwp</span> <span class="o">=</span> <span class="n">kwpatch</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">kwp</span><span class="p">[</span><span class="s1">&#39;facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fc</span>
                <span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">C</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">size</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">aa</span><span class="o">+</span><span class="n">angle</span><span class="p">,</span>
                    <span class="n">anglemode</span><span class="o">=</span><span class="n">anglemode</span><span class="p">,</span> <span class="o">**</span><span class="n">kwp</span><span class="p">)))</span>


            <span class="c1"># Add text labels</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">PPText</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">text_pad</span><span class="p">,</span> <span class="n">ppatch</span><span class="o">=</span><span class="n">patches</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ha</span><span class="o">=</span><span class="n">ha</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="n">va</span><span class="p">)</span>
            <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_add_text_</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="k">raise</span> <span class="n">PlotError</span><span class="p">(</span><span class="s1">&#39;Unknown compass style. Please use one of : &#39;</span><span class="o">+</span>
            <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;simple&#39;</span><span class="p">,</span> <span class="s1">&#39;fancy&#39;</span><span class="p">]))</span>


    <span class="k">return</span> <span class="n">patches</span><span class="p">,</span> <span class="n">texts</span></div>

<span class="k">def</span> <span class="nf">_asnum_</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">atleast_1d</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get xy as a number</span>

<span class="sd">    If it is a number or a numpy array, it not converted,</span>
<span class="sd">    else it is converted with :func:`numtime`.</span>

<span class="sd">    xy can also be a list, a list of lists, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">xy</span>
    <span class="n">single</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="n">xys</span> <span class="o">=</span> <span class="n">xy</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">single</span> <span class="k">else</span> <span class="p">[</span><span class="n">xy</span><span class="p">]</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">xys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_numtime</span><span class="p">(</span><span class="n">xy</span><span class="p">):</span>
            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">out</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="n">numtime</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">atleast_1d</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">N</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">single</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">out</span>


<span class="n">docfiller</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">Plot</span><span class="p">,</span> <span class="n">Plot</span><span class="o">.</span><span class="n">format_axes</span><span class="p">,</span> <span class="n">Plot</span><span class="o">.</span><span class="n">load_data</span><span class="p">,</span> <span class="n">Plot</span><span class="o">.</span><span class="n">_check_order_</span><span class="p">,</span>
    <span class="n">Plot</span><span class="o">.</span><span class="n">pre_plot</span><span class="p">,</span> <span class="n">Plot</span><span class="o">.</span><span class="n">post_plot</span><span class="p">,</span>
    <span class="n">Plot1D</span><span class="o">.</span><span class="n">_set_axes_</span><span class="p">,</span> <span class="n">Plot1D</span><span class="o">.</span><span class="n">_check_order_</span><span class="p">,</span>
    <span class="n">Curve</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span> <span class="n">Curve</span><span class="o">.</span><span class="n">load_data</span><span class="p">,</span>
    <span class="n">Bar</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span>
    <span class="n">Stick</span><span class="o">.</span><span class="n">load_data</span><span class="p">,</span> <span class="n">Stick</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span>
    <span class="n">ScalarMappable</span><span class="p">,</span> <span class="n">ScalarMappable</span><span class="o">.</span><span class="n">colorbar</span><span class="p">,</span> <span class="n">ScalarMappable</span><span class="o">.</span><span class="n">post_plot</span><span class="p">,</span>
    <span class="n">ScalarMappable</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">,</span> <span class="n">ScalarMappable</span><span class="o">.</span><span class="n">get_levels</span><span class="p">,</span>
    <span class="n">Plot2D</span><span class="o">.</span><span class="n">load_data</span><span class="p">,</span>
    <span class="n">Plot2D</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span> <span class="n">Plot2D</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">,</span> <span class="n">Plot2D</span><span class="o">.</span><span class="n">plot_fill</span><span class="p">,</span>
    <span class="n">Plot2D</span><span class="o">.</span><span class="n">plot_quiver</span><span class="p">,</span> <span class="n">Plot2D</span><span class="o">.</span><span class="n">_set_axes_</span><span class="p">,</span>
    <span class="n">Map</span><span class="o">.</span><span class="n">load_data</span><span class="p">,</span> <span class="n">Map</span><span class="o">.</span><span class="n">pre_plot</span><span class="p">,</span> <span class="n">Map</span><span class="o">.</span><span class="n">post_plot</span><span class="p">,</span>
    <span class="n">quiverkey_</span><span class="o">=</span><span class="n">QuiverKey</span><span class="o">.</span><span class="n">quiverkey</span><span class="p">,</span>
    <span class="n">savefig_</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">savefig</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">Home</a>|&nbsp;</li>
        <li><a href="../../../contents.html">Docs</a>|&nbsp;</li>
        <li><a href="../../../user.faq.html">FAQ</a>|&nbsp;</li>
<!--         <li><a href="../../../search.html">chercher</a>|&nbsp;</li> -->
        <li><a href="../../../gallery.html">Gallery</a>|&nbsp;</li>
        <li><a href="https://forge.ifremer.fr/projects/vacumm">Forge</a>&nbsp; &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../vacumm.html" >vacumm</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-2015, Actimar/IFREMER.
      Last updated on 21 Jan 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.
    </div>
  </body>
</html>